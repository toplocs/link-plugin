import{importShared as R,__tla as le}from"./__federation_fn_import-Cl8bnd4D.js";import{c as Zt,b as pe,a as ft}from"./_commonjs-dynamic-modules-D9Q0Knnx.js";let lt,te,pt,F,ee,ht,he=Promise.all([(()=>{try{return le}catch{}})()]).then(async()=>{let dt,yt,gt,vt,bt,mt,wt,tt,et,ne,kt,St,_t,xt,At,jt,Et,Tt,Dt,$t,Bt,Ot,nt,Ct,Nt,rt,ot,Ut,it,Gt,Pt,Jt,Mt,It,Ht,Kt;({defineComponent:dt}=await R("vue")),{renderSlot:yt,normalizeClass:gt,openBlock:vt,createElementBlock:bt}=await R("vue"),lt=dt({__name:"Title",props:{float:{type:String,default:"left",required:!1}},setup(J){return(m,G)=>(vt(),bt("h3",{class:gt(`my-auto text-${J.float} text-lg text-gray-800 dark:text-gray-100 font-semibold`)},[yt(m.$slots,"default")],2))}}),{createTextVNode:mt,Fragment:wt,openBlock:tt,createElementBlock:et,createCommentVNode:ne,renderSlot:kt,normalizeClass:St}=await R("vue"),_t=["disabled"],{ref:xt,computed:At,watch:jt}=await R("vue"),pt={__name:"SubmitButton",props:{className:{type:String,default:""}},setup(J){const m=J,G=xt(!1),x=()=>{G.value=!0,setTimeout(()=>{G.value=!1},2e3)};jt(G,i=>{i&&x()});const t=At(()=>`inline-flex justify-center px-4 py-2 text-sm font-medium border border-blue-600 dark:border-blue-400 text-blue-600 dark:text-blue-400 bg-transparent rounded-lg shadow-sm hover:bg-blue-50 dark:hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 ${m.className}
`);return(i,c)=>(tt(),et("button",{type:"submit",disabled:G.value,class:St(t.value)},[G.value?(tt(),et(wt,{key:0},[mt(" Sending ... ")],64)):kt(i.$slots,"default",{key:1})],10,_t))}},{defineComponent:Et}=await R("vue"),{createElementVNode:Tt,openBlock:Dt,createElementBlock:$t}=await R("vue"),Bt={class:"relative w-full flex items-center min-w-[100px] outline-none rounded-md transition duration-100 border bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-white border-gray-300 dark:border-gray-600"},Ot=["id","type","name","placeholder","disabled","value"],nt=Et({__name:"TextInput",props:{id:{type:String,required:!1},type:{type:String,default:"text"},name:{type:String,required:!1},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(J,{emit:m}){return(G,x)=>(Dt(),$t("div",Bt,[Tt("input",{id:J.id,type:J.type,name:J.name,placeholder:J.placeholder,disabled:J.disabled,value:J.modelValue,onInput:x[0]||(x[0]=t=>G.$emit("update:modelValue",t.target.value)),class:"w-full bg-transparent focus:outline-none focus:ring-0 border-none text-sm rounded-lg transition duration-100 py-2 text-gray-900 dark:text-white pr-3 pl-3 placeholder-gray-400 dark:placeholder-gray-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"},null,40,Ot)]))}}),{defineComponent:Ct}=await R("vue"),{toDisplayString:Nt,openBlock:rt,createElementBlock:ot,createCommentVNode:Ut,createElementVNode:it,renderSlot:Gt,normalizeClass:Pt}=await R("vue"),Jt={class:"flex items-start"},Mt={key:0,class:"font-semibold"},It={class:"overflow-y-auto text-xs"},{computed:Ht}=await R("vue"),Kt=Ct({__name:"Callout",props:{title:{type:String,required:!1},color:{type:String,default:"red",validator:J=>["red","green"].includes(J)}},setup(J){const m=J,G=Ht(()=>{const x="flex flex-col overflow-hidden rounded-lg border-l-4 p-4 mb-2 opacity-75",t=m.color==="red"?"bg-red-100 border-red-500 text-red-700":"bg-green-100 border-green-500 text-green-700";return`${x} ${t}`});return(x,t)=>(rt(),ot("div",{class:Pt(G.value)},[it("div",Jt,[J.title?(rt(),ot("h4",Mt,Nt(J.title),1)):Ut("",!0)]),it("p",It,[Gt(x.$slots,"default")])],2))}});var at={exports:{}};at.exports,function(J){(function(){function m(x,t){return t?Zt(x):x.slice?m[i(x)]:function(c,d){x(c={exports:{}}),m[i(d)]=c.exports};function i(c){return c.split("/").slice(-1).toString().replace(".js","")}}var G=J;m(function(x){String.random=function(i,c){var d="";for(i=i||24,c=c||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";i-- >0;)d+=c.charAt(Math.floor(Math.random()*c.length));return d},String.match=function(i,c){var d,h;return typeof i!="string"?!1:(typeof c=="string"&&(c={"=":c}),c=c||{},d=c["="]||c["*"]||c[">"]||c["<"],i===d?!0:h!==c["="]?!1:(d=c["*"]||c[">"],i.slice(0,(d||"").length)===d?!0:h!==c["*"]?!1:h!==c[">"]&&h!==c["<"]?i>=c[">"]&&i<=c["<"]:h!==c[">"]&&i>=c[">"]||h!==c["<"]&&i<=c["<"]))},String.hash=function(i,c){if(typeof i=="string"){if(c=c||0,!i.length)return c;for(var d=0,h=i.length,r;d<h;++d)r=i.charCodeAt(d),c=(c<<5)-c+r,c|=0;return c}};var t=Object.prototype.hasOwnProperty;Object.plain=function(i){return i?i instanceof Object&&i.constructor===Object||Object.prototype.toString.call(i).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(i,c){for(var d in i)if(t.call(i,d)&&(!c||c.indexOf(d)==-1))return!1;return!0},Object.keys=Object.keys||function(i){var c=[];for(var d in i)t.call(i,d)&&c.push(d);return c},function(){var i,c=setTimeout,d=0,h=0,r=typeof setImmediate!=""+i&&setImmediate||function(s,y){return typeof MessageChannel==""+i?c:((s=new MessageChannel).port1.onmessage=function(w){w.data==""&&y()},function(w){y=w,s.port2.postMessage("")})}(),u=c.check=c.check||typeof performance!=""+i&&performance||{now:function(){return+new Date}};c.hold=c.hold||9,c.poll=c.poll||function(s){if(c.hold>=u.now()-d&&h++<3333){s();return}r(function(){d=u.now(),s()},h=0)}}(),function(){var i=setTimeout,c=i.turn=i.turn||function(y){d.push(y)==1&&h(s)},d=c.s=[],h=i.poll,r=0,u,s=function(){(u=d[r++])&&u(),(r==d.length||r==99)&&(d=c.s=d.slice(r),r=0),d.length&&h(s)}}(),function(){var i,c=setTimeout,d=c.turn;(c.each=c.each||function(h,r,u,s){s=s||9,function y(w,e,p){if(e=(w=(h||[]).splice(0,s)).length){for(var v=0;v<e&&i===(p=r(w[v]));v++);if(i===p){d(y);return}}u&&u(p)}()})()}()})(m,"./shim"),m(function(x){x.exports=function t(u,c,d){if(!u)return{to:t};var h,r=typeof c=="function",u=(this.tag||(this.tag={}))[u]||r&&(this.tag[u]={tag:u,to:t._={next:function(y){var w;(w=this.to)&&w.next(y)}}});if(r){var s={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:c,the:u,on:this,as:d};return(s.back=u.last||u).to=s,u.last=s}return(u=u.to)&&h!==c&&u.next(c),u}})(m,"./onto"),m(function(x){x.exports=function(t){return t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"&&t!=1/0&&t!=-1/0&&t===t||!!t&&typeof t["#"]=="string"&&Object.keys(t).length===1&&t["#"]}})(m,"./valid"),m(function(x){m("./shim");function t(){var u=+new Date;return h<u?(c=0,h=u+t.drift):h=u+(c+=1)/d+t.drift}t.drift=0;var i=-1/0,c=0,d=999,h=i,r;t.is=function(u,s,y){var w=s&&u&&u._&&u._[">"]||y;if(w)return typeof(w=w[s])=="number"?w:i},t.ify=function(u,s,y,w,e){(u=u||{})._=u._||{},e&&(u._["#"]=e);var p=u._[">"]||(u._[">"]={});return r!==s&&s!=="_"&&(typeof y=="number"&&(p[s]=y),r!==w&&(u[s]=w)),u},x.exports=t})(m,"./state"),m(function(x){m("./shim");function t(i){var c={s:{}},d=c.s;i=i||{max:999,age:1e3*9},c.check=function(r){return d[r]?h(r):!1};var h=c.track=function(r){var u=d[r]||(d[r]={});return u.was=c.now=+new Date,c.to||(c.to=setTimeout(c.drop,i.age+9)),h.ed&&h.ed(r),u};return c.drop=function(r){c.to=null,c.now=+new Date;var u=Object.keys(d);console.STAT&&console.STAT(c.now,+new Date-c.now,"dup drop keys"),setTimeout.each(u,function(s){var y=d[s];y&&(r||i.age)>c.now-y.was||delete d[s]},0,99)},c}x.exports=t})(m,"./dup"),m(function(x){m("./onto"),x.exports=function(i,c){if(this.on){var d=(this.opt||{}).lack||9e3;if(typeof i!="function"){if(!i)return;var r=i["#"]||i,h=(this.tag||"")[r];return h?(c&&(h=this.on(r,c),clearTimeout(h.err),h.err=setTimeout(function(){h.off()},d)),!0):void 0}var r=c&&c["#"]||t(9);if(!i)return r;var u=this.on(r,i,c);return u.err=u.err||setTimeout(function(){u.off(),u.next({err:"Error: No ACK yet.",lack:!0})},d),r}};var t=String.random||function(){return Math.random().toString(36).slice(2)}})(m,"./ask"),m(function(x){function t(e){return e instanceof t?(this._={$:this}).$:this instanceof t?t.create(this._={$:this,opt:e}):new t(e)}t.is=function(e){return e instanceof t||e&&e._&&e===e._.$||!1},t.version=.202,t.chain=t.prototype,t.chain.toJSON=function(){},m("./shim"),t.valid=m("./valid"),t.state=m("./state"),t.on=m("./onto"),t.dup=m("./dup"),t.ask=m("./ask"),function(){t.create=function(o){o.root=o.root||o,o.graph=o.graph||{},o.on=o.on||t.on,o.ask=o.ask||t.ask,o.dup=o.dup||t.dup();var b=o.$.opt(o.opt);return o.once||(o.on("in",e,o),o.on("out",e,o),o.on("put",k,o),t.on("create",o),o.on("create",o)),o.once=1,b};function e(o){if(o){if(o.out===e){this.to.next(o);return}var b=this,S=b.as,A=S.at||S,$=A.$,D=A.dup,T,C=o.DBG;if((T=o["#"])||(T=o["#"]=c(9)),!D.check(T)){if(D.track(T),T=o._,o._=typeof T=="function"?T:function(){},o.$&&o.$===(o.$._||"").$||(o.$=$),o["@"]&&!o.put&&n(o),!A.ask(o["@"],o))if(C&&(C.u=+new Date),o.put){p(o);return}else o.get&&t.on.get(o,$);C&&(C.uc=+new Date),b.to.next(o),C&&(C.ua=+new Date),!(o.nts||o.NTS)&&(o.out=e,A.on("out",o),C&&(C.ue=+new Date))}}}function p(o){if(o){var b=o._||"",S=b.root=((b.$=o.$||"")._||"").root;if(o["@"]&&b.faith&&!b.miss){o.out=e,S.on("out",o);return}b.latch=S.hatch,b.match=S.hatch=[];var A=o.put,$=b.DBG=o.DBG,D=+new Date;if(O=O||D,!(A["#"]&&A["."])){$&&($.p=D),b["#"]=o["#"],b.msg=o,b.all=0,b.stun=1;var T=Object.keys(A);console.STAT&&console.STAT(D,(($||b).pk=+new Date)-D,"put sort");var C=0,U,P,M,I,H,K,z;(function W(X){if(U!=C){if(U=C,!(M=T[C])){console.STAT&&console.STAT(D,(($||b).pd=+new Date)-D,"put"),a(b);return}(I=A[M])?(z=I._)?M!==z["#"]?K=l+_(M)+"soul not same.":(H=z[">"])||(K=l+_(M)+"no state."):K=l+_(M)+"no meta.":K=l+_(M)+"no node.",P=Object.keys(I||{})}if(K){o.err=b.err=K,a(b);return}var Qt=0,q;for(X=X||0;X++<9&&(q=P[Qt++]);)if(q!=="_"){var Z=I[q],Xt=H[q];if(s===Xt){K=l+_(q)+"on"+_(M)+"no state.";break}if(!h(Z)){K=l+_(q)+"on"+_(M)+"bad "+typeof Z+_(Z);break}v(Z,q,M,Xt,o),++N}if((P=P.slice(Qt)).length){d(W);return}++C,P=null,W(X)})()}}}t.on.put=p;function v(o,b,S,A,$){var D=$._||"",T=D.root,C=T.graph,U,P=C[S]||y,M=r(P,b,1),I=P[b],H=D.DBG;(U=console.STAT)&&(!C[S]||!I)&&(U.has=(U.has||0)+1);var K=E();if(A>K){setTimeout(function(){v(o,b,S,A,$)},(U=A-K)>j?j:U),console.STAT&&console.STAT((H||D).Hf=+new Date,U,"future");return}if(!(A<M)&&!(!D.faith&&A===M&&(o===I||g(o)<=g(I))&&!D.miss)){D.stun++;var z=$["#"]+D.all++,W={toString:function(){return z},_:D};W.toJSON=W.toString,T.dup.track(W)["#"]=$["#"],H&&(H.ph=H.ph||+new Date),T.on("put",{"#":W,"@":$["@"],put:{"#":S,".":b,":":o,">":A},ok:$.ok,_:D})}}function k(o){var b;(b=(o._||"").DBG)&&(b.pa=+new Date,b.pm=b.pm||+new Date);var S=this,A=S.as,$=A.graph,D=o._,T=o.put,C=T["#"],U=T["."],P=T[":"],M=T[">"];o["#"];var I;(I=D.msg)&&(I=I.put)&&(I=I[C])&&u(I,U,M,P,C),$[C]=u($[C],U,M,P,C),(I=(A.next||"")[C])&&I.on("in",o),a(D),S.to.next(o)}function a(o,b){var S;if(!o.stop&&!(!o.err&&0<--o.stun)&&(o.stop=1,!!(S=o.root))){var A=o.match;A.end=1,A===S.hatch&&(!(A=o.latch)||A.end?delete S.hatch:S.hatch=A),o.hatch&&o.hatch(),setTimeout.each(o.match,function($){$&&$()}),!(!(b=o.msg)||o.err||b.err)&&(b.out=e,o.root.on("out",b),B())}}function n(o){var b=o["@"]||"",S;if(!(S=b._)){var A=(A=o.$)&&(A=A._)&&(A=A.root)&&(A=A.dup);if(!(A=A.check(b)))return;o["@"]=A["#"]||o["@"];return}S.acks=(S.acks||0)+1,(S.err=o.err)&&(o["@"]=S["#"],a(S)),S.ok=o.ok||S.ok,!S.stop&&!S.crack&&(S.crack=S.match&&S.match.push(function(){f(S)})),f(S)}function f(o){!o||!o.root||o.stun||o.acks!==o.all||o.root.on("in",{"@":o["#"],err:o.err,ok:o.err?s:o.ok||{"":1}})}var l="Error: Invalid graph!",_=function(o){return" '"+(""+o).slice(0,9)+"...' "},g=JSON.stringify,j=2147483647,E=t.state,N=0,O,B=function(){N>999&&N/-(O-(O=+new Date))>1&&(t.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),B=function(){N=0})}}(),function(){t.on.get=function(p,v){var k=v._,a=p.get,n=a["#"],f=k.graph[n],l=a["."],_=k.next||(k.next={}),g=_[n],j=p._||{},E=j.DBG=p.DBG;if(E&&(E.g=+new Date),!f)return k.on("get",p);if(l){if((typeof l!="string"||s===f[l])&&!((g||"").next||"")[l]){k.on("get",p);return}f=u({},l,r(f,l),f[l],n)}f&&e(p,f),k.on("get",p)};function e(p,v){var k=+new Date,a=p._||{},n=a.DBG=p.DBG,f=p["#"],l=c(9),_=Object.keys(v||"").sort(),g=((v||"")._||"")["#"];_.length;var j=p.$._.root,E=v===j.graph[g];console.STAT&&console.STAT(k,((n||a).gk=+new Date)-k,"got keys"),v&&function N(){k=+new Date;for(var O=0,B,o={},b;O<9&&(B=_[O++]);)u(o,B,r(v,B),v[B],g);_=_.slice(O),(b={})[g]=o,o=b;var S;E&&(S=function(){},S.ram=S.faith=!0),b=_.length,console.STAT&&console.STAT(k,-(k-(k=+new Date)),"got copied some"),n&&(n.ga=+new Date),j.on("in",{"@":f,"#":l,put:o,"%":b?l=c(9):s,$:j.$,_:S,DBG:n,FOO:1}),console.STAT&&console.STAT(k,+new Date-k,"got in"),b&&setTimeout.turn(N)}(),v||j.on("in",{"@":p["#"]})}t.on.get.ack=e}(),function(){t.chain.opt=function(e){e=e||{};var p=this,v=p._,k=e.peers||e;return Object.plain(e)||(e={}),Object.plain(v.opt)||(v.opt=e),typeof k=="string"&&(k=[k]),Object.plain(v.opt.peers)||(v.opt.peers={}),k instanceof Array&&(e.peers={},k.forEach(function(a){var n={};n.id=n.url=a,e.peers[a]=v.opt.peers[a]=v.opt.peers[a]||n})),i(e,function a(n){var f=this[n];if(this&&this.hasOwnProperty(n)||typeof f=="string"||Object.empty(f)){this[n]=f;return}f&&f.constructor!==Object&&!(f instanceof Array)||i(f,a)}),v.opt.from=e,t.on("opt",v),v.opt.uuid=v.opt.uuid||function(a){return t.state().toString(36).replace(".","")+String.random(a||12)},p}}();var i=function(e,p){Object.keys(e).forEach(p,e)},c=String.random,d=setTimeout.turn,h=t.valid,r=t.state.is,u=t.state.ify,s,y={},w;t.log=function(){return!t.log.off&&w.log.apply(w,arguments),[].slice.call(arguments).join(" ")},t.log.once=function(e,p,v){return(v=t.log.once)[e]=v[e]||0,v[e]++||t.log(p)},typeof window<"u"&&((window.GUN=window.Gun=t).window=window);try{typeof G<"u"&&(G.exports=t)}catch{}x.exports=t,(t.window||{}).console=(t.window||{}).console||{log:function(){}},(w=console).only=function(e,p){return w.only.i&&e===w.only.i&&w.only.i++&&(w.log.apply(w,arguments)||p)},t.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(m,"./root"),m(function(x){var t=m("./root");t.chain.back=function(d,h){var r;if(d=d||1,d===-1||d===1/0)return this._.root.$;if(d===1)return(this._.back||this._).$;var u=this,s=u._;if(typeof d=="string"&&(d=d.split(".")),d instanceof Array){var y=0,w=d.length,r=s;for(y;y<w;y++)r=(r||i)[d[y]];return c!==r?h?u:r:(r=s.back)?r.$.back(d,h):void 0}if(typeof d=="function"){for(var e,r={back:s};(r=r.back)&&c===(e=d(r,h)););return e}return typeof d=="number"?(s.back||s).$.back(d-1):this};var i={},c})(m,"./back"),m(function(x){var t=m("./root");t.chain.chain=function(a){var n=this,f=n._,l=new(a||n).constructor(n),_=l._,g;return _.root=g=f.root,_.id=++g.once,_.back=n._,_.on=t.on,_.on("in",t.on.in,_),_.on("out",t.on.out,_),l};function i(a){var n,f=this.as,l=f.back,_=f.root,g;if(a.$||(a.$=f.$),this.to.next(a),f.err){f.on("in",{put:f.put=s,$:f.$});return}if(n=a.get){if(_.pass&&(_.pass[f.id]=f),f.lex&&Object.keys(f.lex).forEach(function(j){g[j]=f.lex[j]},g=a.get=a.get||{}),n["#"]||f.soul){if(n["#"]=n["#"]||f.soul,a["#"]||(a["#"]=y(9)),l=_.$.get(n["#"])._,n=n["."]){if(e(l.put,n)&&(g=l.ask&&l.ask[n],(l.ask||(l.ask={}))[n]=l.$.get(n)._,l.on("in",{get:n,put:{"#":l.soul,".":n,":":l.put[n],">":v(_.graph[l.soul],n)}}),g))return}else{if(g=l.ask&&l.ask[""],(l.ask||(l.ask={}))[""]=l,s!==l.put&&(l.on("in",l),g))return;a.$=l.$}return _.ask(r,a),_.on("in",a)}if(n["."])return f.get?(a={get:{".":f.get},$:f.$},(l.ask||(l.ask={}))[f.get]=a.$._,l.on("out",a)):(a={get:f.lex?a.get:{},$:f.$},l.on("out",a));if((f.ask||(f.ask={}))[""]=f,f.get)return n["."]=f.get,(l.ask||(l.ask={}))[f.get]=a.$._,l.on("out",a)}return l.on("out",a)}t.on.out=i;function c(a,n){n=n||this.as;var f=n.root,l=a.$||(a.$=n.$),_=(l||"")._||u,g=a.put||"",j=g["#"],E=g["."],N=s!==g["="]?g["="]:g[":"],O=g[">"]||-1/0,B;if(s!==a.put&&(s===g["#"]||s===g["."]||s===g[":"]&&s===g["="]||s===g[">"])){if(!w(g)){if(!(j=((g||"")._||"")["#"])){console.log("chain not yet supported for",g,"...",a,n);return}return l=n.root.$.get(j),setTimeout.each(Object.keys(g).sort(),function(o){o=="_"||s===(O=v(g,o))||n.on("in",{$:l,put:{"#":j,".":o,"=":g[o],">":O},VIA:a})})}n.on("in",{$:_.back.$,put:{"#":j=_.back.soul,".":E=_.has||_.get,"=":g,">":v(_.back.put,E)},via:a});return}(a.seen||"")[n.id]||((a.seen||(a.seen=function(){}))[n.id]=n,n!==_&&(Object.keys(a).forEach(function(o){g[o]=a[o]},g={}),g.get=n.get||g.get,!n.soul&&!n.has?g.$$$=g.$$$||n.$:_.soul&&(g.$=n.$,g.$$=g.$$||_.$),a=g),h(a,n),(n.soul||a.$$)&&O>=v(f.graph[j],E)&&((g=f.$.get(j)._).put=k(g.put,E,O,N,j)),!_.soul&&O>=v(f.graph[j],E)&&(B=(f.$.get(j)._.next||"")[E])&&(B.put=N,typeof(g=w(N))=="string"&&(B.put=f.$.get(g)._.put||N)),this.to&&this.to.next(a),n.any&&setTimeout.each(Object.keys(n.any),function(o){(o=n.any[o])&&o(a)},0,99),n.echo&&setTimeout.each(Object.keys(n.echo),function(o){(o=n.echo[o])&&o.on("in",a)},0,99),((a.$$||"")._||_).soul&&(B=n.next)&&(B=B[E])&&(g={},Object.keys(a).forEach(function(o){g[o]=a[o]}),g.$=(a.$$||a.$).get(g.get=E),delete g.$$,delete g.$$$,B.on("in",g)),d(a,n))}t.on.in=c;function d(a,n){if(n=n||this.as||a.$._,!(a.$$&&this!==t.on)&&!(!a.put||n.soul)){var f=a.put||"",l=f["="]||f[":"],_,g=n.root,j=g.$.get(f["#"]).get(f["."])._;if(typeof(l=w(l))!="string"){this===t.on&&((j.echo||(j.echo={}))[n.id]=n);return}if(!((j.echo||(j.echo={}))[n.id]&&!(g.pass||"")[n.id])){if(_=g.pass){if(_[l+n.id])return;_[l+n.id]=1}(j.echo||(j.echo={}))[n.id]=n,n.has&&(n.link=l);var E=g.$.get(j.link=l)._;(E.echo||(E.echo={}))[j.id]=j;var _=n.ask||"";(_[""]||n.lex)&&E.on("out",{get:{"#":l}}),setTimeout.each(Object.keys(_),function(O,B){!O||!(B=_[O])||B.on("out",{get:{"#":l,".":O}})},0,99)}}}t.on.link=d;function h(a,n){var f=a.put||"",l=s!==f["="]?f["="]:f[":"],_=n.root,g,j;if(s===l){if(n.soul&&s!==n.put||(j=(a.$$||a.$||"")._||"",a["@"]&&(s!==j.put||s!==n.put)))return;(g=n.link||a.linked)&&delete(_.$.get(g)._.echo||"")[n.id],n.has&&(n.link=null),n.put=s,setTimeout.each(Object.keys(n.next||""),function(E,N){(N=n.next[E])&&(g&&delete(_.$.get(g).get(E)._.echo||"")[N.id],N.on("in",{get:E,put:s,$:N.$}))},0,99);return}n.soul||a.$$||(g=w(l),j=a.$._||"",!((g===j.link||n.has&&!j.link)&&!((_.pass||"")[n.id]&&typeof g!="string"))&&(delete(j.echo||"")[n.id],h({get:n.get,put:s,$:a.$,linked:a.linked=a.linked||j.link},n)))}t.on.unlink=h;function r(a,n){var f=this.as,l=f.$._;l.root;var _=f.get||"",g=(a.put||"")[_["#"]]||"";if(!a.put||typeof _["."]=="string"&&s===g[_["."]]){if(s!==l.put||!l.soul&&!l.has)return;l.ack=(l.ack||0)+1,l.on("in",{get:l.get,put:l.put=s,$:l.$,"@":a["@"]});return}(a._||{}).miss=1,t.on.put(a)}var u={},s,y=String.random,w=t.valid,e=function(a,n){return a&&Object.prototype.hasOwnProperty.call(a,n)},p=t.state,v=p.is,k=p.ify})(m,"./chain"),m(function(x){var t=m("./root");t.chain.get=function(s,y,w){var e,p;if(typeof s=="string"){if(s.length==0)return(e=this.chain())._.err={err:t.log("0 length key!",s)},y&&y.call(e,e._.err),e;var v=this,k=v._,a=k.next||h;(e=a[s])||(e=s&&i(s,v)),e=e&&e.$}else if(typeof s=="function"){let g=function(E,N,O){if(!g.stun&&!(($=f.pass)&&!$[l])){var B=E.$._,o=(E.$$||"")._,b=(o||B).put,S=!B.has&&!B.soul,A={},$;if((S||u===b)&&(b=u===(($=E.put)||"")["="]?u===($||"")[":"]?$:$[":"]:$["="]),typeof($=t.valid(b))=="string"&&(b=u===($=f.$.get($)._.put)?n.not?u:b:$),!(n.not&&u===b)){if(u===n.stun){if(($=f.stun)&&$.on&&(k.$.back(function(D){if($.on(""+D.id,A={}),(A.run||0)<g.id)return A}),!A.run&&$.on(""+B.id,A={}),!A.run&&o&&$.on(""+o.id,A={}),g.id>A.run&&((!A.stun||A.stun.end)&&(A.stun=$.on("stun"),A.stun=A.stun&&A.stun.last),A.stun&&!A.stun.end))){(A.stun.add||(A.stun.add={}))[l]=function(){g(E,N,1)};return}if(u===b&&(O=0),($=f.hatch)&&!$.end&&u===n.hatch&&!O){if(_[B.$._.id])return;_[B.$._.id]=1,$.push(function(){g(E,N,1)});return}_={}}if(f.pass){if(f.pass[l+B.id])return;f.pass[l+B.id]=1}if(n.on){n.ok.call(B.$,b,B.get,E,N||g);return}if(n.v2020){n.ok(E,N||g);return}Object.keys(E).forEach(function(D){$[D]=E[D]},$={}),E=$,E.put=b,n.ok.call(n.as,E,N||g)}}};if(y===!0)return c(this,s,y,w),this;e=this;var k=e._,n=y||{},f=k.root,l;n.at=k,n.ok=s;var _={};return g.at=k,(k.any||(k.any={}))[l=String.random(7)]=g,g.off=function(){g.stun=1,k.any&&delete k.any[l]},g.rid=d,g.id=n.run||++f.once,p=f.pass,(f.pass={})[l]=1,n.out=n.out||{get:{}},k.on("out",n.out),f.pass=p,e}else{if(typeof s=="number")return this.get(""+s,y,w);if(typeof(p=r(s))=="string")return this.get(p,y,w);(p=this.get.next)&&(e=p(this,s))}return e?(y&&typeof y=="function"&&e.get(y,w),e):((e=this.chain())._.err={err:t.log("Invalid get request!",s)},y&&y.call(e,e._.err),e)};function i(s,y){var w=y._,e=w.next,p=y.chain(),v=p._;return e||(e=w.next={}),e[v.get=s]=v,y===w.root.$?v.soul=s:(w.soul||w.has)&&(v.has=s),v}function c(s,y,w,e){var p=s._,v=0,k;return(k=p.soul||p.link)?y(k,e,p):p.jam?p.jam.push([y,e]):(p.jam=[[y,e]],s.get(function(a,n){if(!(u===a.put&&!p.root.opt.super&&(k=Object.keys(p.root.opt.peers).length)&&++v<=k)){n.rid(a);var f=(f=a.$)&&f._||{},l=0,_;for(k=p.jam,delete p.jam;_=k[l++];){var g=_[0];_=_[1],g&&g(f.link||f.soul||t.valid(a.put)||((a.put||{})._||{})["#"],_,a,n)}}},{out:{get:{".":!0}}}),s)}function d(s){var y=this.at||this.on;if(!s||y.soul||y.has)return this.off();if(s=(s=(s=s.$||s)._||s).id){y.map;var w;if((w=this.seen||(this.seen={}))[s])return!0;w[s]=!0}}var h={},r=t.valid,u})(m,"./get"),m(function(x){var t=m("./root");t.chain.put=function(e,p,v){var k=this,a=k._,n=a.root;v=v||{},v.root=a.root,v.run||(v.run=n.once),i(v,a.id),v.ack=v.ack||p,v.via=v.via||k,v.data=v.data||e,v.soul||(v.soul=a.soul||typeof p=="string"&&p);var f=v.state=v.state||t.state();return typeof e=="function"?(e(function(l){v.data=l,k.put(r,r,v)}),k):v.soul?(v.$=n.$.get(v.soul),v.todo=[{it:v.data,ref:v.$}],v.turn=v.turn||s,v.ran=v.ran||c,function l(){var _=v.todo,g=_.pop(),j=g.it;g.ref&&g.ref._.id;var E,N,O,B,o;if(i(v,g.ref),(B=g.todo)&&(N=B.pop(),j=j[N],B.length&&_.push(g)),N&&(_.path||(_.path=[])).push(N),!(E=y(j))&&!(o=t.is(j))){if(!Object.plain(j)){c.err(v,"Invalid data: "+h(j)+" at "+(v.via.back(function($){$.get&&B.push($.get)},B=[])||B.join("."))+"."+(_.path||[]).join("."));return}for(var b=v.seen||(v.seen=[]),S=b.length;S--;)if(j===(B=b[S]).it){E=j=B.link;break}}if(N&&E)g.node=w(g.node,N,f,j);else{let $=function(D,T){var C=O.link["#"];T&&(T.off(),T.rid(D));var U=C||D.soul||(B=(D.$$||D.$)._||"").soul||B.link||((B=B.put||"")._||"")["#"]||B["#"]||((B=D.put||"")&&D.$$?B["#"]:(B["="]||B[":"]||"")["#"]);if(!C&&i(v,D.$),!U&&!g.link["#"]){(g.wait||(g.wait=[])).push(function(){$(D,T)});return}U||(U=[],(D.$$||D.$).back(function(P){if(B=P.soul||P.link)return U.push(B);U.push(P.get)}),U=U.reverse().join("/")),O.link["#"]=U,!o&&(((v.graph||(v.graph={}))[U]=O.node||(O.node={_:{}}))._["#"]=U),delete v.wait[A],O.wait&&setTimeout.each(O.wait,function(P){P&&P()}),v.ran(v)};if(!v.seen){c.err(v,"Data at root of graph must be a node (an object).");return}v.seen.push(O={it:j,link:{},todo:o?[]:Object.keys(j).sort().reverse(),path:(_.path||[]).slice(),up:g}),g.node=w(g.node,N,f,O.link),!o&&O.todo.length&&_.push(O);var A=v.seen.length;(v.wait||(v.wait={}))[A]="",B=(O.ref=o?j:N?g.ref.get(N):g.ref)._,(B=j&&(j._||"")["#"]||B.soul||B.link)?$({soul:B}):O.ref.get($,{run:v.run,v2020:1,out:{get:{".":" "}}})}if(!_.length)return v.ran(v);v.turn(l)}(),k):(d(v),k)};function i(e,p){if(p){p=(p._||"").id||p;var v=e.root.stun||(e.root.stun={on:t.on}),k={},a;e.stun||(e.stun=v.on("stun",function(){})),(a=v.on(""+p))&&a.the.last.next(k),!(k.run>=e.run)&&v.on(""+p,function(n){if(e.stun.end){this.off(),this.to.next(n);return}n.run=n.run||e.run,n.stun=n.stun||e.stun})}}function c(e){if(e.err){c.end(e.stun,e.root);return}if(!(e.todo.length||e.end||!Object.empty(e.wait))){e.end=1;var p=e.$.back(-1)._,v=p.root,k=p.ask(function(l){v.on("ack",l),l.err&&!l.lack&&t.log(l),++a>(e.acks||0)&&this.off(),e.ack&&e.ack(l,this)},e.opt),a=0,n=e.stun,f;(f=function(){n&&(c.end(n,v),setTimeout.each(Object.keys(n=n.add||""),function(l){(l=n[l])&&l()}))}).hatch=f,e.ack&&!e.ok&&(e.ok=e.acks||9),e.via._.on("out",{put:e.out=e.graph,ok:e.ok&&{"@":e.ok+1},opt:e.opt,"#":k,_:f})}}c.end=function(e,p){e.end=u,e.the.to===e&&e===e.the.last&&delete p.stun,e.off()},c.err=function(e,p){(e.ack||u).call(e,e.out={err:e.err=t.log(p)}),e.ran(e)};function d(e){var p=e.via._,v;e.via=e.via.back(function(k){if(k.soul||!k.get)return k.$;v=e.data,(e.data={})[k.get]=v}),(!e.via||!e.via._.soul)&&(e.via=p.root.$.get(((e.data||"")._||"")["#"]||p.$.back("opt.uuid")())),e.via.put(e.data,e.ack,e)}function h(e,p){return e&&(p=e.constructor)&&p.name||typeof e}var r,u=function(){},s=setTimeout.turn,y=t.valid,w=t.state.ify})(m,"./put"),m(function(x){var t=m("./root");m("./chain"),m("./back"),m("./put"),m("./get"),x.exports=t})(m,"./index"),m(function(x){var t=m("./index");t.chain.on=function(d,h,r,u){var s=this,y=s._;y.root;var w;if(typeof d=="string")return h?(w=y.on(d,h,r||y,u),r&&r.$&&(r.subs||(r.subs=[])).push(w),s):y.on(d);var e=h;return(e=e===!0?{change:!0}:e||{}).not=1,e.on=1,s.get(d,e),s},t.chain.once=function(d,h){if(h=h||{},!d)return i(this);var r=this,u=r._,s=u.root;u.put;var y=String.random(7),w;return r.get(function(e,p,v,k){var a=this,n=a._,f=n.one||(n.one={});if(k.stun||f[y]==="")return;if((w=t.valid(e))===!0){l();return}if(typeof w=="string")return;clearTimeout((u.one||"")[y]),clearTimeout(f[y]),f[y]=setTimeout(l,h.wait||99);function l(_){if(!n.has&&!n.soul&&(n={put:e,get:p}),c===(w=n.put)&&(w=((v.$$||"")._||"").put),typeof t.valid(w)=="string"&&(w=s.$.get(w)._.put,w===c&&!_)){f[y]=setTimeout(function(){l(1)},h.wait||99);return}k.stun||f[y]!==""&&(f[y]="",(u.soul||u.has)&&k.off(),d.call(a,w,n.get),clearTimeout(f[y]))}},{on:1}),r};function i(d,h,r){return t.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(r=d.chain())._.nix=d.once(function(u,s){r._.on("in",this._)}),r._.lex=d._.lex,r}t.chain.off=function(){var d=this,h=d._,r,u=h.back;if(u)return h.ack=0,(r=u.next)&&r[h.get]&&delete r[h.get],(r=u.any)&&(delete u.any,u.any={}),(r=u.ask)&&delete r[h.get],(r=u.put)&&delete r[h.get],(r=h.soul)&&delete u.root.graph[r],(r=h.map)&&Object.keys(r).forEach(function(s,y){y=r[s],y.link&&u.root.$.get(y.link).off()}),(r=h.next)&&Object.keys(r).forEach(function(s,y){y=r[s],y.$.off()}),h.on("off",{}),d};var c})(m,"./on"),m(function(x){var t=m("./index"),i=t.chain.get.next;t.chain.get.next=function(r,u){var s;return Object.plain(u)?(s=((s=u["#"])||"")["="]||s)?r.get(s):((s=r.chain()._).lex=u,r.on("in",function(y){String.match(y.get||(y.put||"")["."],u["."]||u["#"]||u)&&s.on("in",y),this.to.next(y)}),s.$):(i||d)(r,u)},t.chain.map=function(r,u,s){var y=this,w=y._,e,p;return Object.plain(r)&&(e=r["."]?r:{".":r},r=h),r?(t.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),p=y.chain(),y.map().on(function(v,k,a,n){var f=(r||d).call(this,v,k,a,n);if(h!==f){if(v===f)return p._.on("in",a);if(t.is(f))return p._.on("in",f._);var l={};Object.keys(a.put).forEach(function(_){l[_]=a.put[_]},l),l["="]=f,p._.on("in",{get:k,put:l})}}),p):((p=w.each)||((w.each=p=y.chain())._.lex=e||p._.lex||w.lex,p._.nix=y.back("nix"),y.on("in",c,p._)),p)};function c(r){this.to.next(r);var u=this.as,s=r.$,y=s._,w=r.put,e;!y.soul&&!r.$$||(e=u.lex)&&!String.match(r.get||(w||"")["."],e["."]||e["#"]||e)||t.on.link(r,u)}var d=function(){},h})(m,"./map"),m(function(x){var t=m("./index");t.chain.set=function(i,c,d){var h=this,r=h.back(-1),u,s;return c=c||function(){},d=d||{},d.item=d.item||i,(u=((i||"")._||"")["#"])&&((i={})["#"]=u),typeof(s=t.valid(i))=="string"?h.get(u=s).put(i,c,d):t.is(i)?(h.put(function(y){i.get(function(w,e,p){if(!w)return c.call(h,{err:t.log('Only a node can be linked! Not "'+p.put+'"!')});(s={})[w]={"#":w},y(s)},!0)}),i):(Object.plain(i)&&(i=r.get(u=h.back("opt.uuid")()).put(i)),h.get(u||r.back("opt.uuid")(7)).put(i,c,d))}})(m,"./set"),m(function(x){m("./shim");var t=function(){},i=JSON.parseAsync||function(r,u,s){var y,w=+new Date;try{u(y,JSON.parse(r,s),c.sucks(+new Date-w))}catch(e){u(e)}},c=JSON.stringifyAsync||function(r,u,s,y){var w,e=+new Date;try{u(w,JSON.stringify(r,s,y),c.sucks(+new Date-e))}catch(p){u(p)}};c.sucks=function(r){r>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),c.sucks=t)};function d(r){var u=function(){},s=r.opt||{};s.log=s.log||console.log,s.gap=s.gap||s.wait||0,s.max=s.max||(s.memory?s.memory*999*999:3e8)*.3,s.pack=s.pack||s.max*.01*.01,s.puff=s.puff||9;var y=setTimeout.turn||setTimeout,w=r.dup,e=w.check,p=w.track,v=u.hear=function(n,f){if(n){if(s.max<=n.length)return u.say({dam:"!",err:"Message too big!"},f);u===this&&(v.d+=n.length||0,++v.c);var l=f.SH=+new Date,_=n[0],g;if(_==="["){i(n,function(j,E){if(j||!E)return u.say({dam:"!",err:"DAM JSON parse error."},f);console.STAT&&console.STAT(+new Date,E.length,"# on hear batch");var N=s.puff;(function O(){for(var B=+new Date,o=0,b;o<N&&(b=E[o++]);)u.hear(b,f);E=E.slice(o),console.STAT&&console.STAT(B,+new Date-B,"hear loop"),k(f),E.length&&y(O,0)})()}),n="";return}if(_==="{"||(n["#"]||Object.plain(n))&&(g=n)){if(g)return v.one(g,f,l);i(n,function(j,E){if(j||!E)return u.say({dam:"!",err:"DAM JSON parse error."},f);v.one(E,f,l)});return}}};v.one=function(n,f,l){var _,g,j,E,N;if(n.DBG&&(n.DBG=N={DBG:n.DBG}),N&&(N.h=l),N&&(N.hp=+new Date),(_=n["#"])||(_=n["#"]=String.random(9)),!(j=e(_))&&(g=n["##"],!(g&&(j=n["@"]||n.get&&_)&&w.check(E=j+g)))){if((n._=function(){}).via=u.leap=f,(j=n["><"])&&typeof j=="string"&&j.slice(0,99).split(",").forEach(function(B){this[B]=1},n._.yo={}),j=n.dam){(j=u.hear[j])&&j(n,f,r),p(_);return}(j=n.ok)&&(n._.near=j["/"]);var l=+new Date;N&&(N.is=l),f.SI=_,p.ed=function(B){_===B&&(p.ed=0,(B=w.s[_])&&(B.via=f,n.get&&(B.it=n)))},r.on("in",u.last=n),N&&(N.hd=+new Date),console.STAT&&console.STAT(l,+new Date-l,n.get?"msg get":n.put?"msg put":"msg"),p(_),E&&p(E),u.leap=u.last=null}},v.c=v.d=0,function(){var n=0,f;u.hash=function(g,j){var E,N,O,B=+new Date;c(g.put,function o(b,S){var A=(N||(N=O=S||"")).slice(0,32768);if(E=String.hash(A,E),N=N.slice(32768),N){y(o,0);return}console.STAT&&console.STAT(B,+new Date-B,"say json+hash"),g._.$put=O,g["##"]=E,u.say(g,j),delete g._.$put},l)};function l(g,j){var E;return j instanceof Object?(Object.keys(j).sort().forEach(_,{to:E={},on:j}),E):j}function _(g){this.to[g]=this.on[g]}u.say=function(g,j){var E;if((E=this)&&(E=E.to)&&E.next&&E.next(g),!g)return!1;var N,O,B,o=g["@"],b=g._||(g._=function(){}),S=g.DBG,A=+new Date;if(b.y=b.y||A,j||S&&(S.y=A),(N=g["#"])||(N=g["#"]=String.random(9)),!f&&p(N),!(O=g["##"])&&h!==g.put&&!b.via&&o){u.hash(g,j);return}if(!j&&o&&(j=(E=w.s[o])&&(E.via||(E=E.it)&&(E=E._)&&E.via)||(E=u.last)&&o===E["#"]&&u.leap),!j&&o)return w.s[o]?void 0:(console.STAT&&console.STAT(+new Date,++n,"total no peer to ack to"),!1);if(o&&!g.put&&!O&&((w.s[o]||"").it||"")["##"])return!1;if(!j&&u.way)return u.way(g);if(S&&(S.yh=+new Date),!(B=b.raw)){u.raw(g,j);return}if(S&&(S.yr=+new Date),!j||!j.id){if(!Object.plain(j||s.peers))return!1;var A=+new Date;s.puff;var $=s.peers,D=Object.keys(j||s.peers||{});console.STAT&&console.STAT(A,+new Date-A,"peer keys"),function U(){var P=+new Date;f=1;var M=b.raw;b.raw=B;for(var I=0,H;I<9&&(H=(D||"")[I++]);)(H=$[H]||(j||"")[H])&&u.say(g,H);b.raw=M,f=0,D=D.slice(I),console.STAT&&console.STAT(P,+new Date-P,"say loop"),D.length&&(y(U,0),o&&p(o))}();return}if(!j.wire&&u.wire&&u.wire(j),N!==j.last){if(j.last=N,j===b.via||(E=b.yo)&&(E[j.url]||E[j.pid]||E[j.id]))return!1;if(console.STAT&&console.STAT(A,((S||b).yp=+new Date)-(b.y||A),"say prep"),!f&&o&&p(o),j.batch){if(j.tail=(E=j.tail||0)+B.length,j.tail<=s.pack){j.batch+=(E?",":"")+B;return}k(j)}j.batch="[";var T=+new Date;setTimeout(function(){console.STAT&&console.STAT(T,+new Date-T,"0ms TO"),k(j)},s.gap),a(B,j),console.STAT&&o===j.SI&&console.STAT(A,+new Date-j.SH,"say ack")}},u.say.c=u.say.d=0,u.raw=function(g,j){if(!g)return"";var E=g._||{},N,O;if(O=E.raw)return O;if(typeof g=="string")return g;var B=g["##"],o=g["@"];if(B&&o){if(!E.via&&e(o+B))return!1;if(O=(w.s[o]||"").it){if(B===O["##"])return!1;O["##"]||(O["##"]=B)}}if(!g.dam&&!g["@"]){var b=0,S=[];O=s.peers;for(var A in O){var $=O[A];if(S.push($.url||$.pid||$.id),++b>6)break}b>1&&(g["><"]=S.join())}if(g.put&&(O=g.ok)&&(g.ok={"@":(O["@"]||1)-1,"/":O["/"]==g._.near?u.near:O["/"]}),N=E.$put){O={},Object.keys(g).forEach(function(T){O[T]=g[T]}),O.put=":])([:",c(O,function(T,C){if(!T){var U=+new Date;O=C.indexOf('"put":":])([:"'),D(h,C=C.slice(0,O+6)+N+C.slice(O+14)),console.STAT&&console.STAT(U,+new Date-U,"say slice")}});return}c(g,D);function D(T,C){T||(E.raw=C,u.say(g,j))}}}();function k(n){var f=n.batch,l=typeof f=="string";if(l&&(f+="]"),n.batch=n.tail=null,!!f&&!(l?3>f.length:!f.length)){if(!l)try{f=f.length===1?f[0]:JSON.stringify(f)}catch(_){return s.log("DAM JSON stringify error",_)}f&&a(f,n)}}function a(n,f){try{var l=f.wire;f.say?f.say(n):l.send&&l.send(n),u.say.d+=n.length||0,++u.say.c}catch{(f.queue=f.queue||[]).push(n)}}return u.near=0,u.hi=function(n){var f=n.wire,l;if(!f){u.wire(n.length&&{url:n,id:n}||n);return}n.id?s.peers[n.url||n.id]=n:(l=n.id=n.id||n.url||String.random(9),u.say({dam:"?",pid:r.opt.pid},s.peers[l]=n),delete w.s[n.last]),n.met||(u.near++,n.met=+new Date,r.on("hi",n)),l=n.queue,n.queue=[],setTimeout.each(l||[],function(_){a(_,n)},0,9)},u.bye=function(n){n.met&&--u.near,delete n.met,r.on("bye",n);var f=+new Date;f=f-(n.met||f),u.bye.time=((u.bye.time||f)+f)/2},u.hear["!"]=function(n,f){s.log("Error:",n.err)},u.hear["?"]=function(n,f){n.pid&&(f.pid||(f.pid=n.pid),n["@"])||(u.say({dam:"?",pid:s.pid,"@":n["#"]},f),delete w.s[f.last])},u.hear.mob=function(n,f){if(n.peers){var l=Object.keys(n.peers),_=l[Math.random()*l.length>>0];_&&(u.bye(f),u.hi(_))}},r.on("create",function(n){n.opt.pid=n.opt.pid||String.random(9),this.to.next(n),n.on("out",u.say)}),r.on("bye",function(n,f){n=s.peers[n.id||n]||n,this.to.next(n),n.bye?n.bye():(f=n.wire)&&f.close&&f.close(),delete s.peers[n.id],n.wire=null}),r.on("bye",function(n,f){this.to.next(n),(f=console.STAT)&&(f.peers=u.near),(f=n.url)&&setTimeout(function(){},s.lack||9e3)}),r.on("hi",function(n,f){if(this.to.next(n),(f=console.STAT)&&(f.peers=u.near),!s.super){var l=Object.keys(r.next||"");l.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(l,function(_){var g=r.next[_];if(s.super||(g.ask||"")[""]){u.say({get:{"#":_}},n);return}setTimeout.each(Object.keys(g.ask||""),function(j){j&&u.say({"##":String.hash((r.graph[_]||"")[j]),get:{"#":_,".":j}},n)})})}}),u}var h;try{x.exports=d}catch{}})(m,"./mesh"),m(function(x){var t=m("./index");t.Mesh=m("./mesh"),t.on("opt",function(c){if(this.to.next(c),c.once)return;var d=c.opt;if(d.WebSocket===!1)return;var h=t.window||{},r=d.WebSocket||h.WebSocket||h.webkitWebSocket||h.mozWebSocket;if(!r)return;d.WebSocket=r;var u=d.mesh=d.mesh||t.Mesh(c);u.wire||d.wire,u.wire=d.wire=s;function s(p){try{if(!p||!p.url)return k&&k(p);var v=p.url.replace(/^http/,"ws"),k=p.wire=new d.WebSocket(v);return k.onclose=function(){w(p),d.mesh.bye(p)},k.onerror=function(a){w(p)},k.onopen=function(){d.mesh.hi(p)},k.onmessage=function(a){a&&d.mesh.hear(a.data||a,p)},k}catch{d.mesh.bye(p)}}setTimeout(function(){!d.super&&c.on("out",{dam:"hi"})},1);var y=2*999;function w(p){clearTimeout(p.defer),d.peers[p.url]&&(e&&p.retry<=0||(p.retry=(p.retry||d.retry+1||60)-(-p.tried+(p.tried=+new Date)<y*4?1:0),p.defer=setTimeout(function v(){if(e&&e.hidden)return setTimeout(v,y);s(p)},y)))}var e=""+i!=typeof document&&document});var i})(m,"./websocket"),m(function(x){if(!(typeof Gun>"u")){var t=function(){},i;try{i=(Gun.window||t).localStorage}catch{}i||(Gun.log("Warning: No localStorage exists to persist data to!"),i={setItem:function(d,h){this[d]=h},removeItem:function(d){delete this[d]},getItem:function(d){return this[d]}});var c=JSON.stringifyAsync||function(d,h,r,u){var s;try{h(s,JSON.stringify(d,r,u))}catch(y){h(y)}};Gun.on("create",function d(h){this.to.next(h);var r=h.opt;h.graph;var u=[],s,y,w,e;if(r.localStorage===!1)return;r.prefix=r.file||"gun/";try{s=d[r.prefix]=d[r.prefix]||JSON.parse(w=i.getItem(r.prefix))||{}}catch{s=d[r.prefix]={}}w=(w||"").length,h.on("get",function(v){this.to.next(v);var k=v.get,a,n,f,l;!k||!(a=k["#"])||(n=s[a]||l,n&&(f=k["."])&&!Object.plain(f)&&(n=Gun.state.ify({},f,Gun.state.is(n,f),n[f],a)),Gun.on.get.ack(v,n))}),h.on("put",function(v){this.to.next(v);var k=v.put,a=k["#"],n=k["."],f=v["#"],l=v.ok||"";if(s[a]=Gun.state.ify(s[a],n,k[">"],k[":"],a),e&&w>4999880){h.on("in",{"@":f,err:"localStorage max!"});return}!v["@"]&&(!v._.via||Math.random()<l["@"]/l["/"])&&u.push(f),!y&&(y=setTimeout(p,9+w/333))});function p(){if(!u.length&&((setTimeout.turn||"").s||"").length){setTimeout(p,99);return}var v=u;clearTimeout(y),y=!1,u=[],c(s,function(k,a){try{!k&&i.setItem(r.prefix,a)}catch(n){k=e=n||"localStorage failure"}k&&(Gun.log(k+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),h.on("localStorage:error",{err:k,get:r.prefix,put:s})),w=a.length,setTimeout.each(v,function(n){h.on("in",{"@":n,err:k,ok:0})},0,99)})}})}})(m,"./localStorage")})(),function(){var m;if(""+m!=typeof Gun){var G=function(o){console.warn("Warning! Deprecated internal utility will break in next version:",o)},x=Gun;x.fn=x.fn||{is:function(o){return G("fn"),!!o&&typeof o=="function"}},x.bi=x.bi||{is:function(o){return G("bi"),o instanceof Boolean||typeof o=="boolean"}},x.num=x.num||{is:function(o){return G("num"),!t(o)&&(o-parseFloat(o)+1>=0||o===1/0||o===-1/0)}},x.text=x.text||{is:function(o){return G("text"),typeof o=="string"}},x.text.ify=x.text.ify||function(o){return G("text.ify"),x.text.is(o)?o:typeof JSON<"u"?JSON.stringify(o):o&&o.toString?o.toString():o},x.text.random=x.text.random||function(o,b){G("text.random");var S="";for(o=o||24,b=b||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";o>0;)S+=b.charAt(Math.floor(Math.random()*b.length)),o--;return S},x.text.match=x.text.match||function(o,b){var S,A;return G("text.match"),typeof o!="string"?!1:(typeof b=="string"&&(b={"=":b}),b=b||{},S=b["="]||b["*"]||b[">"]||b["<"],o===S?!0:A!==b["="]?!1:(S=b["*"]||b[">"]||b["<"],o.slice(0,(S||"").length)===S?!0:A!==b["*"]?!1:A!==b[">"]&&A!==b["<"]?o>=b[">"]&&o<=b["<"]:A!==b[">"]&&o>=b[">"]||A!==b["<"]&&o<=b["<"]))},x.text.hash=x.text.hash||function(o,b){if(G("text.hash"),typeof o=="string"){if(b=b||0,!o.length)return b;for(var S=0,A=o.length,$;S<A;++S)$=o.charCodeAt(S),b=(b<<5)-b+$,b|=0;return b}},x.list=x.list||{is:function(o){return G("list"),o instanceof Array}},x.list.slit=x.list.slit||Array.prototype.slice,x.list.sort=x.list.sort||function(o){return G("list.sort"),function(b,S){return!b||!S?0:(b=b[o],S=S[o],b<S?-1:b>S?1:0)}},x.list.map=x.list.map||function(o,b,S){return G("list.map"),N(o,b,S)},x.list.index=1,x.obj=x.boj||{is:function(o){return G("obj"),o?o instanceof Object&&o.constructor===Object||Object.prototype.toString.call(o).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},x.obj.put=x.obj.put||function(o,b,S){return G("obj.put"),(o||{})[b]=S,o},x.obj.has=x.obj.has||function(o,b){return G("obj.has"),o&&Object.prototype.hasOwnProperty.call(o,b)},x.obj.del=x.obj.del||function(o,b){if(G("obj.del"),!!o)return o[b]=null,delete o[b],o},x.obj.as=x.obj.as||function(o,b,S,A){return G("obj.as"),o[b]=o[b]||(A===S?{}:S)},x.obj.ify=x.obj.ify||function(o){if(G("obj.ify"),l(o))return o;try{o=JSON.parse(o)}catch{o={}}return o},function(){var o;function b(S,A){g(this,A)&&o!==this[A]||(this[A]=S)}x.obj.to=x.obj.to||function(S,A){return G("obj.to"),A=A||{},N(S,b,A),A}}(),x.obj.copy=x.obj.copy||function(o){return G("obj.copy"),o&&JSON.parse(JSON.stringify(o))},function(){function o(b,S){var A=this.n,$;if(!(A&&(S===A||l(A)&&g(A,S)))&&$!==S)return!0}x.obj.empty=x.obj.empty||function(b,S){return G("obj.empty"),b?!N(b,o,{n:S}):!0}}(),function(){function o(A,$){if(arguments.length===2){o.r=o.r||{},o.r[A]=$;return}o.r=o.r||[],o.r.push(A)}var b=Object.keys,S;Object.keys=Object.keys||function(A){return S(A,function($,D,T){T(D)})},x.obj.map=S=x.obj.map||function(A,$,D){G("obj.map");var T,C=0,U,P,M,I,H=typeof $=="function";if(o.r=T,b&&l(A)&&(M=b(A),I=!0),D=D||{},t(A)||M)for(U=(M||A).length;C<U;C++){var K=C+x.list.index;if(H){if(P=I?$.call(D,A[M[C]],M[C],o):$.call(D,A[C],K,o),P!==T)return P}else if($===A[I?M[C]:C])return M?M[C]:K}else for(C in A)if(H){if(g(A,C)&&(P=D?$.call(D,A[C],C,o):$(A[C],C,o),P!==T))return P}else if($===A[C])return C;return H?o.r:x.list.index?0:-1}}(),x.time=x.time||{},x.time.is=x.time.is||function(o){return G("time"),o?o instanceof Date:+new Date().getTime()};var n=x.fn.is,t=x.list.is,f=x.obj,l=f.is,g=f.has,N=f.map,i={};i.is=function(o){return G("val.is"),o===m?!1:o===null?!0:o===1/0?!1:h(o)||d(o)||p(o)?!0:i.link.is(o)||!1},i.link=i.rel={_:"#"},function(){i.link.is=function(b){if(G("val.link.is"),b&&b[c]&&!b._&&l(b)){var S={};if(N(b,o,S),S.id)return S.id}return!1};function o(b,S){var A=this;if(A.id)return A.id=!1;if(S==c&&h(b))A.id=b;else return A.id=!1}}(),i.link.ify=function(o){return G("val.link.ify"),E({},c,o)},x.obj.has._=".";var c=i.link._,m,d=x.bi.is,p=x.num.is,h=x.text.is,f=x.obj,l=f.is,E=f.put,N=f.map;x.val=x.val||i;var r={_:"_"};r.soul=function(o,b){return G("node.soul"),o&&o._&&o._[b||y]},r.soul.ify=function(o,b){return G("node.soul.ify"),b=typeof b=="string"?{soul:b}:b||{},o=o||{},o._=o._||{},o._[y]=b.soul||o._[y]||s(),o},r.soul._=i.link._,function(){r.is=function(b,S,A){G("node.is");var $;return l(b)&&($=r.soul(b))?!N(b,o,{as:A,cb:S,s:$,n:b}):!1};function o(b,S){if(S!==r._){if(!i.is(b))return!0;this.cb&&this.cb.call(this.as,b,S,this.n,this.s)}}}(),function(){r.ify=function(b,S,A){return G("node.ify"),S?typeof S=="string"?S={soul:S}:typeof S=="function"&&(S={map:S}):S={},S.map&&(S.node=S.map.call(A,b,m,S.node||{})),(S.node=r.soul.ify(S.node||{},S))&&N(b,o,{o:S,as:A}),S.node};function o(b,S){var A=this.o,$,D;if(A.map){$=A.map.call(this.as,b,""+S,A.node),D===$?_(A.node,S):A.node&&(A.node[S]=$);return}i.is(b)&&(A.node[S]=b)}}();var f=x.obj,l=f.is,_=f.del,N=f.map,u=x.text,s=u.random,y=r.soul._,m;x.node=x.node||r;var w=x.state;w.lex=function(){return G("state.lex"),w().toString(36).replace(".","")},w.to=function(o,b,S){G("state.to");var A=(o||{})[b];return l(A)&&(A=O(A)),w.ify(S,b,w.is(o,b),A,r.soul(o))},function(){w.map=function(b,S,A){G("state.map");var $,D=l(D=b||S)?D:null;return b=n(b=b||S)?b:null,D&&!b?(S=p(S)?S:w(),D[k]=D[k]||{},N(D,o,{o:D,s:S}),D):(A=A||l(S)?S:$,S=p(S)?S:w(),function(T,C,U,P){if(!b)return o.call({o:U,s:S},T,C),T;b.call(A||this||{},T,C,U,P),!(g(U,C)&&$===U[C])&&o.call({o:U,s:S},T,C)})};function o(b,S){k!==S&&w.ify(this.o,S,this.s)}}();var f=x.obj;f.as;var g=f.has,l=f.is,N=f.map,O=f.copy,e=x.num,p=e.is,v=x.fn,n=v.is,k=r._,m,a={};(function(){a.is=function(S,A,$,D){return G("graph.is"),!S||!l(S)||j(S)?!1:!N(S,o,{cb:A,fn:$,as:D})};function o(S,A){if(!S||A!==r.soul(S)||!r.is(S,this.fn,this.as))return!0;this.cb&&(b.n=S,b.as=this.as,this.cb.call(b.as,S,A,b))}function b(S){S&&r.is(b.n,S,b.as)}})(),function(){a.ify=function(D,T,C){G("graph.ify");var U={path:[],obj:D};return T?typeof T=="string"?T={soul:T}:typeof T=="function"&&(T.map=T):T={},typeof C=="string"&&(T.soul=T.soul||C,C=m),T.soul&&(U.link=i.link.ify(T.soul)),T.shell=(C||{}).shell,T.graph=T.graph||{},T.seen=T.seen||[],T.as=T.as||C,o(T,U),T.root=U.node,T.graph};function o(D,T){var C;return(C=$(D,T))?C:(T.env=D,T.soul=S,r.ify(T.obj,b,T)&&(T.link=T.link||i.link.ify(r.soul(T.node)),T.obj!==D.shell&&(D.graph[i.link.is(T.link)]=T.node)),T)}function b(D,T,C){var U=this,P=U.env,M,I;if(r._===T&&g(D,i.link._))return C._;if(M=A(D,T,C,U,P)){if(T||(U.node=U.node||C||{},g(D,r._)&&r.soul(D)&&(U.node._=O(D._)),U.node=r.soul.ify(U.node,i.link.is(U.link)),U.link=U.link||i.link.ify(r.soul(U.node))),(I=P.map)&&(I.call(P.as||{},D,T,C,U),g(C,T))){if(D=C[T],m===D){_(C,T);return}if(!(M=A(D,T,C,U,P)))return}if(!T)return U.node;if(M===!0)return D;if(I=o(P,{obj:D,path:U.path.concat(T)}),!!I.node)return I.link}}function S(D){var T=this,C=i.link.is(T.link),U=T.env.graph;T.link=T.link||i.link.ify(D),T.link[i.link._]=D,T.node&&T.node[r._]&&(T.node[r._][i.link._]=D),g(U,C)&&(U[D]=U[C],_(U,C))}function A(D,T,C,U,P){var M;if(i.is(D))return!0;if(l(D))return 1;if(M=P.invalid)return D=M.call(P.as||{},D,T,C),A(D,T,C,U,P);P.err="Invalid value at '"+U.path.concat(T).join(".")+"'!",x.list.is(D)&&(P.err+=" Use `.set(item)` instead of an Array.")}function $(D,T){for(var C=D.seen,U=C.length,P;U--;)if(P=C[U],T.obj===P.obj)return P;C.push(T)}}(),a.node=function(o){G("graph.node");var b=r.soul(o);if(b)return E({},b,o)},function(){a.to=function(b,S,A){if(G("graph.to"),!!b){var $={};return A=A||{seen:{}},N(b[S],o,{obj:$,graph:b,opt:A}),$}};function o(b,S){var A,$;if(r._===S){if(j(b,i.link._))return;this.obj[S]=O(b);return}if(!(A=i.link.is(b))){this.obj[S]=b;return}if($=this.opt.seen[A]){this.obj[S]=$;return}this.obj[S]=this.opt.seen[A]=a.to(this.graph,A,this.opt)}}();var n=x.fn.is,f=x.obj,l=f.is,_=f.del,g=f.has,j=f.empty,E=f.put,N=f.map,O=f.copy,m;x.graph=x.graph||a}}()}(at);var Rt=at.exports,re=Rt;const oe=pe(re);var ut={exports:{}};ut.exports,function(J){(function(){function m(x,t){return t?Zt(x):x.slice?m[i(x)]:function(c,d){x(c={exports:{}}),m[i(d)]=c.exports};function i(c){return c.split("/").slice(-1).toString().replace(".js","")}}var G=J;m(function(x){typeof self<"u"&&(x.window=self),typeof window<"u"&&(x.window=window);var t=x.window||x,i,c=t.SEA||{};(c.window=x.window)&&(c.window.SEA=c);try{i+""!=typeof G&&(G.exports=c)}catch{}x.exports=c})(m,"./root"),m(function(x){var t=m("./root");try{t.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(m,"./https"),m(function(x){var t;if(t+""==typeof btoa){if(t+""==typeof Buffer)try{ft.Buffer=m("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}ft.btoa=function(i){return Buffer.from(i,"binary").toString("base64")},ft.atob=function(i){return Buffer.from(i,"base64").toString("binary")}}})(m,"./base64"),m(function(x){m("./base64");function t(){}Object.assign(t,{from:Array.from}),t.prototype=Object.create(Array.prototype),t.prototype.toString=function(i,c,d){i=i||"utf8",c=c||0;const h=this.length;if(i==="hex"){const r=new Uint8Array(this);return[...Array((d&&d+1||h)-c).keys()].map(u=>r[u+c].toString(16).padStart(2,"0")).join("")}if(i==="utf8")return Array.from({length:(d||h)-c},(r,u)=>String.fromCharCode(this[u+c])).join("");if(i==="base64")return btoa(this)},x.exports=t})(m,"./array"),m(function(x){m("./base64");var t=m("./array");function i(...c){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),i.from(...c)}i.prototype=Object.create(Array.prototype),Object.assign(i,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const c=arguments[0];let d;if(typeof c=="string"){const h=arguments[1]||"utf8";if(h==="hex"){const r=c.match(/([\da-fA-F]{2})/g).map(u=>parseInt(u,16));if(!r||!r.length)throw new TypeError("Invalid first argument for type 'hex'.");d=t.from(r)}else if(h==="utf8"||h==="binary"){const r=c.length,u=new Uint16Array(r);Array.from({length:r},(s,y)=>u[y]=c.charCodeAt(y)),d=t.from(u)}else if(h==="base64"){const r=atob(c),u=r.length,s=new Uint8Array(u);Array.from({length:u},(y,w)=>s[w]=r.charCodeAt(w)),d=t.from(s)}else h==="binary"?d=t.from(c):console.info("SafeBuffer.from unknown encoding: "+h);return d}if(c.byteLength,c.byteLength?c.byteLength:c.length){let h;return c instanceof ArrayBuffer&&(h=new Uint8Array(c)),t.from(h||c)}},alloc(c,d=0){return t.from(new Uint8Array(Array.from({length:c},()=>d)))},allocUnsafe(c){return t.from(new Uint8Array(Array.from({length:c})))},concat(c){if(!Array.isArray(c))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return t.from(c.reduce((d,h)=>d.concat(Array.from(h)),[]))}}),i.prototype.from=i.from,i.prototype.toString=t.prototype.toString,x.exports=i})(m,"./buffer"),m(function(x){const t=m("./root"),i={Buffer:m("./buffer")};var c={},d;if(JSON.parseAsync=JSON.parseAsync||function(r,u,s){var y;try{u(y,JSON.parse(r,s))}catch(w){u(w)}},JSON.stringifyAsync=JSON.stringifyAsync||function(r,u,s,y){var w;try{u(w,JSON.stringify(r,s,y))}catch(e){u(e)}},i.parse=function(r,u){return new Promise(function(s,y){JSON.parseAsync(r,function(w,e){w?y(w):s(e)},u)})},i.stringify=function(r,u,s){return new Promise(function(y,w){JSON.stringifyAsync(r,function(e,p){e?w(e):y(p)},u,s)})},t.window&&(i.crypto=t.window.crypto||t.window.msCrypto,i.subtle=(i.crypto||c).subtle||(i.crypto||c).webkitSubtle,i.TextEncoder=t.window.TextEncoder,i.TextDecoder=t.window.TextDecoder,i.random=r=>i.Buffer.from(i.crypto.getRandomValues(new Uint8Array(i.Buffer.alloc(r))))),!i.TextDecoder){const{TextEncoder:r,TextDecoder:u}=m((d+""==typeof G?".":"")+"./lib/text-encoding",1);i.TextDecoder=u,i.TextEncoder=r}if(!i.crypto)try{var h=m("crypto",1);Object.assign(i,{crypto:h,random:u=>i.Buffer.from(h.randomBytes(u))});const{Crypto:r}=m("@peculiar/webcrypto",1);i.ossl=i.subtle=new r({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}x.exports=i})(m,"./shim"),m(function(x){var t=m("./root"),i=m("./shim"),c={};c.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},c.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},c.ecdh={name:"ECDH",namedCurve:"P-256"},c.jwk=function(d,h){d=d.split(".");var r=d[0],u=d[1],s={kty:"EC",crv:"P-256",x:r,y:u,ext:!0};return s.key_ops=h?["sign"]:["verify"],h&&(s.d=h),s},c.keyToJwk=function(d){return{kty:"oct",k:d.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},c.recall={validity:12*60*60,hook:function(d){return d}},c.check=function(d){return typeof d=="string"&&d.slice(0,4)==="SEA{"},c.parse=async function(d){try{var h=typeof d=="string";return h&&d.slice(0,4)==="SEA{"&&(d=d.slice(3)),h?await i.parse(d):d}catch{}return d},t.opt=c,x.exports=c})(m,"./settings"),m(function(x){var t=m("./shim");x.exports=async function(i,c){var d=typeof i=="string"?i:await t.stringify(i),h=await t.subtle.digest({name:c||"SHA-256"},new t.TextEncoder().encode(d));return t.Buffer.from(h)}})(m,"./sha256"),m(function(x){const t=m("./shim"),i=t.subtle,c=t.ossl?t.ossl:i,d=h=>c.digest({name:"SHA-1"},new ArrayBuffer(h));x.exports=d})(m,"./sha1"),m(function(x){var t=m("./root"),i=m("./shim"),c=m("./settings"),d=m("./sha256"),h;t.work=t.work||(async(r,u,s,y)=>{try{var w=(u||{}).epub||u;if(y=y||{},w instanceof Function&&(s=w,w=h),r=typeof r=="string"?r:await i.stringify(r),(y.name||"").toLowerCase().slice(0,3)==="sha"){var e=i.Buffer.from(await d(r,y.name),"binary").toString(y.encode||"base64");if(s)try{s(e)}catch(a){console.log(a)}return e}w=w||i.random(9);var p=await(i.ossl||i.subtle).importKey("raw",new i.TextEncoder().encode(r),{name:y.name||"PBKDF2"},!1,["deriveBits"]),v=await(i.ossl||i.subtle).deriveBits({name:y.name||"PBKDF2",iterations:y.iterations||c.pbkdf2.iter,salt:new i.TextEncoder().encode(y.salt||w),hash:y.hash||c.pbkdf2.hash},p,y.length||c.pbkdf2.ks*8);r=i.random(r.length);var k=i.Buffer.from(v,"binary").toString(y.encode||"base64");if(s)try{s(k)}catch(a){console.log(a)}return k}catch(a){if(console.log(a),t.err=a,t.throw)throw a;s&&s();return}}),x.exports=t.work})(m,"./work"),m(function(x){var t=m("./root"),i=m("./shim");m("./settings"),t.name=t.name||(async(c,d)=>{try{if(c)try{c()}catch(h){console.log(h)}return}catch(h){if(console.log(h),t.err=h,t.throw)throw h;c&&c();return}}),t.pair=t.pair||(async(c,d)=>{try{var h=i.ossl||i.subtle,r=await i.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async y=>{var w={};w.priv=(await i.subtle.exportKey("jwk",y.privateKey)).d;var e=await i.subtle.exportKey("jwk",y.publicKey);return w.pub=e.x+"."+e.y,w});try{var u=await h.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async y=>{var w={};w.epriv=(await h.exportKey("jwk",y.privateKey)).d;var e=await h.exportKey("jwk",y.publicKey);return w.epub=e.x+"."+e.y,w})}catch(y){if(t.window)throw y;if(y=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw y}u=u||{};var s={pub:r.pub,priv:r.priv,epub:u.epub,epriv:u.epriv};if(c)try{c(s)}catch(y){console.log(y)}return s}catch(y){if(console.log(y),t.err=y,t.throw)throw y;c&&c();return}}),x.exports=t.pair})(m,"./pair"),m(function(x){var t=m("./root"),i=m("./shim"),c=m("./settings"),d=m("./sha256"),h;t.sign=t.sign||(async(r,u,s,y)=>{try{if(y=y||{},!(u||y).priv){if(!t.I)throw"No signing key.";u=await t.I(null,{what:r,how:"sign",why:y.why})}if(h===r)throw"`undefined` not allowed.";var w=await c.parse(r),e=y.check=y.check||w;if(t.verify&&(t.opt.check(e)||e&&e.s&&e.m)&&h!==await t.verify(e,u)){var f=await c.parse(e);if(y.raw||(f="SEA"+await i.stringify(f)),s)try{s(f)}catch(_){console.log(_)}return f}var p=u.pub,v=u.priv,k=c.jwk(p,v),a=await d(w),n=await(i.ossl||i.subtle).importKey("jwk",k,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(l=>(i.ossl||i.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},l,new Uint8Array(a))),f={m:w,s:i.Buffer.from(n,"binary").toString(y.encode||"base64")};if(y.raw||(f="SEA"+await i.stringify(f)),s)try{s(f)}catch(l){console.log(l)}return f}catch(l){if(console.log(l),t.err=l,t.throw)throw l;s&&s();return}}),x.exports=t.sign})(m,"./sign"),m(function(x){var t=m("./root"),i=m("./shim"),c=m("./settings"),d=m("./sha256"),h;t.verify=t.verify||(async(s,y,w,e)=>{try{var p=await c.parse(s);if(y===!1){var v=await c.parse(p.m);if(w)try{w(v)}catch(E){console.log(E)}return v}e=e||{};var k=y.pub||y,a=t.opt.slow_leak?await t.opt.slow_leak(k):await(i.ossl||i.subtle).importKey("jwk",c.jwk(k),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),n=await d(p.m),f,l,_,g;try{if(f=i.Buffer.from(p.s,e.encode||"base64"),l=new Uint8Array(f),_=await(i.ossl||i.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},a,l,new Uint8Array(n)),!_)throw"Signature did not match."}catch{if(t.opt.fallback)return await t.opt.fall_verify(s,y,w,e)}var j=_?await c.parse(p.m):h;if(w)try{w(j)}catch(E){console.log(E)}return j}catch(E){if(console.log(E),t.err=E,t.throw)throw E;w&&w();return}}),x.exports=t.verify;var r={};t.opt.slow_leak=s=>{if(r[s])return r[s];var y=c.jwk(s);return r[s]=(i.ossl||i.subtle).importKey("jwk",y,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),r[s]};var u=t.opt;t.opt.fall_verify=async function(s,y,w,e,p){if(p===t.opt.fallback)throw"Signature did not match";p=p||1;var v=s||"";s=t.opt.unpack(s)||s;var k=await c.parse(s),a=y.pub||y,n=await t.opt.slow_leak(a),f=p<=t.opt.fallback?i.Buffer.from(await i.subtle.digest({name:"SHA-256"},new i.TextEncoder().encode(await c.parse(k.m)))):await d(k.m),l,_,g;try{if(l=i.Buffer.from(k.s,e.encode||"base64"),_=new Uint8Array(l),g=await(i.ossl||i.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},n,_,new Uint8Array(f)),!g)throw"Signature did not match."}catch{try{l=i.Buffer.from(k.s,"utf8"),_=new Uint8Array(l),g=await(i.ossl||i.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},n,_,new Uint8Array(f))}catch{if(!g)throw"Signature did not match."}}var j=g?await c.parse(k.m):h;if(u.fall_soul=v["#"],u.fall_key=v["."],u.fall_val=s,u.fall_state=v[">"],w)try{w(j)}catch(E){console.log(E)}return j},t.opt.fallback=2})(m,"./verify"),m(function(x){var t=m("./shim"),i=m("./settings"),c=m("./sha256");const d=async(h,r,u)=>{const s=h+(r||t.random(8)).toString("utf8"),y=t.Buffer.from(await c(s),"binary"),w=i.keyToJwk(y);return await t.subtle.importKey("jwk",w,{name:"AES-GCM"},!1,["encrypt","decrypt"])};x.exports=d})(m,"./aeskey"),m(function(x){var t=m("./root"),i=m("./shim");m("./settings");var c=m("./aeskey"),d;t.encrypt=t.encrypt||(async(h,r,u,s)=>{try{s=s||{};var y=(r||s).epriv||r;if(d===h)throw"`undefined` not allowed.";if(!y){if(!t.I)throw"No encryption key.";r=await t.I(null,{what:h,how:"encrypt",why:s.why}),y=r.epriv||r}var w=typeof h=="string"?h:await i.stringify(h),e={s:i.random(9),iv:i.random(15)},p=await c(y,e.s,s).then(k=>i.subtle.encrypt({name:s.name||"AES-GCM",iv:new Uint8Array(e.iv)},k,new i.TextEncoder().encode(w))),v={ct:i.Buffer.from(p,"binary").toString(s.encode||"base64"),iv:e.iv.toString(s.encode||"base64"),s:e.s.toString(s.encode||"base64")};if(s.raw||(v="SEA"+await i.stringify(v)),u)try{u(v)}catch(k){console.log(k)}return v}catch(k){if(console.log(k),t.err=k,t.throw)throw k;u&&u();return}}),x.exports=t.encrypt})(m,"./encrypt"),m(function(x){var t=m("./root"),i=m("./shim"),c=m("./settings"),d=m("./aeskey");t.decrypt=t.decrypt||(async(h,r,u,s)=>{try{s=s||{};var y=(r||s).epriv||r;if(!y){if(!t.I)throw"No decryption key.";r=await t.I(null,{what:h,how:"decrypt",why:s.why}),y=r.epriv||r}var w=await c.parse(h),e,p,v;try{e=i.Buffer.from(w.s,s.encode||"base64"),p=i.Buffer.from(w.iv,s.encode||"base64"),v=i.Buffer.from(w.ct,s.encode||"base64");var k=await d(y,e,s).then(n=>i.subtle.decrypt({name:s.name||"AES-GCM",iv:new Uint8Array(p),tagLength:128},n,new Uint8Array(v)))}catch{if(s.encode==="utf8")throw"Could not decrypt";if(t.opt.fallback)return s.encode="utf8",await t.decrypt(h,r,u,s)}var a=await c.parse(new i.TextDecoder("utf8").decode(k));if(u)try{u(a)}catch(n){console.log(n)}return a}catch(n){if(console.log(n),t.err=n,t.throw)throw n;u&&u();return}}),x.exports=t.decrypt})(m,"./decrypt"),m(function(x){var t=m("./root"),i=m("./shim");m("./settings"),t.secret=t.secret||(async(d,h,r,u)=>{try{if(u=u||{},!h||!h.epriv||!h.epub){if(!t.I)throw"No secret mix.";h=await t.I(null,{what:d,how:"secret",why:u.why})}var s=d.epub||d,y=h.epub,w=h.epriv,e=i.ossl||i.subtle,p=c(s),v=Object.assign({public:await e.importKey(...p,!0,[])},{name:"ECDH",namedCurve:"P-256"}),k=c(y,w),a=await e.importKey(...k,!1,["deriveBits"]).then(async f=>{var l=await e.deriveBits(v,f,256),_=new Uint8Array(l),g=await e.importKey("raw",_,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return e.exportKey("jwk",g).then(({k:j})=>j)}),n=a;if(r)try{r(n)}catch(f){console.log(f)}return n}catch(f){if(console.log(f),t.err=f,t.throw)throw f;r&&r();return}});var c=(d,h)=>{var[r,u]=d.split("."),s=h?{d:h}:{};return["jwk",Object.assign(s,{x:r,y:u,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};x.exports=t.secret})(m,"./secret"),m(function(x){var t=m("./root");t.certify=t.certify||(async(i,c={},d,h,r={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),i=(()=>{var a=[];if(i){if((typeof i=="string"||Array.isArray(i))&&i.indexOf("*")>-1)return"*";if(typeof i=="string")return i;if(Array.isArray(i)){if(i.length===1&&i[0])return typeof i[0]=="object"&&i[0].pub?i[0].pub:typeof i[0]=="string"?i[0]:null;i.map(n=>{typeof n=="string"?a.push(n):typeof n=="object"&&n.pub&&a.push(n.pub)})}return typeof i=="object"&&i.pub?i.pub:a.length>0?a:null}})(),!i)return console.log("No certificant found.");const s=r.expiry&&(typeof r.expiry=="number"||typeof r.expiry=="string")?parseFloat(r.expiry):null,y=(c||{}).read?c.read:null,w=(c||{}).write?c.write:typeof c=="string"||Array.isArray(c)||c["+"]||c["#"]||c["."]||c["="]||c["*"]||c[">"]||c["<"]?c:null,e=(r||{}).block||(r||{}).blacklist||(r||{}).ban||{},p=e.read&&(typeof e.read=="string"||(e.read||{})["#"])?e.read:null,v=typeof e=="string"?e:e.write&&(typeof e.write=="string"||e.write["#"])?e.write:null;if(!y&&!w)return console.log("No policy found.");const k=JSON.stringify({c:i,...s?{e:s}:{},...y?{r:y}:{},...w?{w}:{},...p?{rb:p}:{},...v?{wb:v}:{}});var u=await t.sign(k,d,null,{raw:1});if(r.raw||(u="SEA"+JSON.stringify(u)),h)try{h(u)}catch(a){console.log(a)}return u}catch(s){if(t.err=s,t.throw)throw s;h&&h();return}}),x.exports=t.certify})(m,"./certify"),m(function(x){var t=m("./shim"),i=m("./root");i.work=m("./work"),i.sign=m("./sign"),i.verify=m("./verify"),i.encrypt=m("./encrypt"),i.decrypt=m("./decrypt"),i.certify=m("./certify"),i.random=i.random||t.random,i.Buffer=i.Buffer||m("./buffer"),i.keyid=i.keyid||(async c=>{try{const d=t.Buffer.concat(c.replace(/-/g,"+").replace(/_/g,"/").split(".").map(s=>t.Buffer.from(s,"base64"))),h=t.Buffer.concat([t.Buffer.from([153,d.length/256,d.length%256]),d]),r=await sha1hash(h),u=t.Buffer.from(r,"binary");return u.toString("hex",u.length-8)}catch(d){throw console.log(d),d}}),((i.window||{}).GUN||{}).SEA=i,x.exports=i})(m,"./sea"),m(function(x){var t=m("./sea"),i,c;t.window?i=t.window.GUN||{chain:{}}:i=m((c+""==typeof G?".":"")+"./gun",1),t.GUN=i;function d(r){this._={$:this}}d.prototype=function(){function r(){}return r.prototype=i.chain,new r}(),d.prototype.constructor=d,i.chain.user=function(r){var u=this,y=u.back(-1),s;if(r)return r=t.opt.pub((r._||"")["#"])||r,y.get("~"+r);if(s=y.back("user"))return s;var y=y._,w=y,e=w.opt.uuid||h;return(w=(s=w.user=u.chain(new d))._).opt={},w.opt.uuid=function(p){var v=e(),k=y.user;return!k||!(k=k.is)||!(k=k.pub)||(v="~"+k+"/"+v,p&&p.call&&p(null,v)),v},s};function h(){return i.state().toString(36).replace(".","")}i.User=d,d.GUN=i,d.SEA=i.SEA=t,x.exports=d})(m,"./user"),m(function(x){var t,i=""+t!=typeof GUN?GUN||{chain:{}}:m((""+t==typeof G?".":"")+"./gun",1);i.chain.then=function(c,d){var h=this,r=new Promise(function(u,s){h.once(u,d)});return c?r.then(c):r}})(m,"./then"),m(function(x){var t=m("./user"),i=t.SEA,c=t.GUN,d=function(){};t.prototype.create=function(...h){var r=typeof h[0]=="object"&&(h[0].pub||h[0].epub)?h[0]:typeof h[1]=="object"&&(h[1].pub||h[1].epub)?h[1]:null,u=r&&(r.pub||r.epub)?r.pub:typeof h[0]=="string"?h[0]:null,s=r&&(r.pub||r.epub)?r:u&&typeof h[1]=="string"?h[1]:null,y=h.filter(n=>typeof n=="function")[0]||null,w=h&&h.length>1&&typeof h[h.length-1]=="object"?h[h.length-1]:{},e=this,p=e._,v=e.back(-1);if(y=y||d,w=w||{},w.check!==!1){var k;if(u||(k="No user."),(s||"").length<8&&(k="Password too short!"),k)return y({err:c.log(k)}),e}if(p.ing)return(y||d)({err:c.log("User is already being created or authenticated!"),wait:!0}),e;p.ing=!0;var a={};return a.a=function(n){if(a.pubs=n,n&&!w.already){var f={err:c.log("User already created!")};p.ing=!1,(y||d)(f),e.leave();return}a.salt=String.random(64),i.work(s,a.salt,a.b)},a.b=function(n){a.proof=n,r?a.c(r):i.pair(a.c)},a.c=function(n){var f;a.pair=n||{},(f=p.root.user)&&(f._.sea=n,f.is={pub:n.pub,epub:n.epub,alias:u}),a.data={pub:n.pub},a.d()},a.d=function(){a.data.alias=u,a.e()},a.e=function(){a.data.epub=a.pair.epub,i.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},a.proof,a.f,{raw:1})},a.f=function(n){a.data.auth=JSON.stringify({ek:n,s:a.salt}),a.g(a.data.auth)},a.g=function(n){var f;a.data.auth=a.data.auth||n,v.get(f="~"+a.pair.pub).put(a.data).on(a.h);var l={};l[f]={"#":f},v.get("~@"+u).put(l).get(f).on(a.i)},a.h=function(n,f,l,_){_.off(),a.h.ok=1,a.i()},a.i=function(n,f,l,_){_&&(a.i.ok=1,_.off()),!(!a.h.ok||!a.i.ok)&&(p.ing=!1,y({ok:0,pub:a.pair.pub}),d===y&&(r?e.auth(r):e.auth(u,s)))},v.get("~@"+u).once(a.a),e},t.prototype.leave=function(h,r){var u=this,s=u.back(-1)._.user;if(s&&(delete s.is,delete s._.is,delete s._.sea),i.window)try{var y={};y=i.window.sessionStorage,delete y.recall,delete y.pair}catch{}return u}})(m,"./create"),m(function(x){var t=m("./user"),i=t.SEA,c=t.GUN,d=function(){};t.prototype.auth=function(...r){var u=typeof r[0]=="object"&&(r[0].pub||r[0].epub)?r[0]:typeof r[1]=="object"&&(r[1].pub||r[1].epub)?r[1]:null,s=!u&&typeof r[0]=="string"?r[0]:null,y=(s||u&&!(u.priv&&u.epriv))&&typeof r[1]=="string"?r[1]:null,w=r.filter(l=>typeof l=="function")[0]||null,e=r&&r.length>1&&typeof r[r.length-1]=="object"?r[r.length-1]:{},p=this,v=p._,k=p.back(-1);if(v.ing)return(w||d)({err:c.log("User is already being created or authenticated!"),wait:!0}),p;v.ing=!0;var a={},n,f=9;return a.a=function(l){if(!l)return a.b();if(!l.pub){var _=[];return Object.keys(l).forEach(function(g){g!="_"&&_.push(l[g])}),a.b(_)}if(a.name)return a.f(l);a.c((a.data=l).auth)},a.b=function(l){var _=(a.list=(a.list||[]).concat(l||[])).shift();if(n===_){if(a.name)return a.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(s&&f--){k.get("~@"+s).once(a.a);return}return a.err("Wrong user or password.")}k.get(_).once(a.a)},a.c=function(l){if(n===l)return a.b();if(typeof l=="string")return a.c(h(l));i.work(y,(a.auth=l).s,a.d,a.enc)},a.d=function(l){i.decrypt(a.auth.ek,l,a.e,a.enc)},a.e=function(l){if(n===l)return a.enc?(a.enc=null,a.b()):(a.enc={encode:"utf8"},a.c(a.auth));a.half=l,a.f(a.data)},a.f=function(l){var _=a.half||{},g=a.data||{};a.g(a.lol={pub:l.pub||g.pub,epub:l.epub||g.epub,priv:l.priv||_.priv,epriv:l.epriv||_.epriv})},a.g=function(l){if(!l||!l.pub||!l.epub)return a.b();a.pair=l;var _=k._.user,g=_._;g.tag;var j=g.opt;g=_._=k.get("~"+l.pub)._,g.opt=j,_.is={pub:l.pub,epub:l.epub,alias:s||l.pub},g.sea=a.pair,v.ing=!1;try{y&&n==(h(v.root.graph["~"+l.pub].auth)||"")[":"]&&(e.shuffle=e.change=y)}catch{}if(e.change?a.z():(w||d)(g),i.window&&(p.back("user")._.opt||e).remember)try{var E={};E=i.window.sessionStorage,E.recall=!0,E.pair=JSON.stringify(l)}catch{}try{k._.tag.auth?k._.on("auth",g):setTimeout(function(){k._.on("auth",g)},1)}catch(N){c.log("Your 'auth' callback crashed with:",N)}},a.h=function(l){if(!l)return a.b();if(s=l.alias,s||(s=l.alias="~"+u.pub),!l.auth)return a.g(u);u=null,a.c((a.data=l).auth)},a.z=function(){a.salt=String.random(64),i.work(e.change,a.salt,a.y)},a.y=function(l){i.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},l,a.x,{raw:1})},a.x=function(l){a.w(JSON.stringify({ek:l,s:a.salt}))},a.w=function(l){if(e.shuffle){console.log("migrate core account from UTF8 & shuffle");var _={};Object.keys(a.data).forEach(function(g){_[g]=a.data[g]}),delete _._,_.auth=l,k.get("~"+a.pair.pub).put(_)}k.get("~"+a.pair.pub).get("auth").put(l,w||d)},a.err=function(l){var _={err:c.log(l||"User cannot be found!")};v.ing=!1,(w||d)(_)},a.plugin=function(l){if(!(a.name=l))return a.err();var _=[l];l[0]!=="~"&&(_[1]="~"+l,_[2]="~@"+l),a.b(_)},u?u.priv&&u.epriv?a.g(u):k.get("~"+u.pub).once(a.h):s?k.get("~@"+s).once(a.a):!s&&!y&&i.name(a.plugin),p};function h(r){if(typeof r!="string")return r;try{r=JSON.parse(r)}catch{r={}}return r}})(m,"./auth"),m(function(x){var t=m("./user"),i=t.SEA;t.GUN,t.prototype.recall=function(c,d){var h=this,r=h.back(-1);if(c=c||{},c&&c.sessionStorage){if(i.window)try{var u={};u=i.window.sessionStorage,u&&(r._.opt.remember=!0,(h.back("user")._.opt||c).remember=!0,(u.recall||u.pair)&&r.user().auth(JSON.parse(u.pair),d))}catch{}return h}return h}})(m,"./recall"),m(function(x){var t=m("./user"),i=t.SEA,c=t.GUN,d=function(){};t.prototype.pair=function(){var h=this,r;try{r=new Proxy({DANGER:"\u2620"},{get:function(u,s,y){if(!(!h.is||!(h._||"").sea))return h._.sea[s]}})}catch{}return r},t.prototype.delete=async function(h,r,u){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var s=this;s.back(-1);var y=s.back("user");try{y.auth(h,r,function(w){var e=(y.is||{}).pub;y.map().once(function(){this.put(null)}),y.leave(),(u||d)({ok:0})})}catch(w){c.log("User.delete failed! Error:",w)}return s},t.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const h=this.back(-1);try{return await authRecall(h),h._.user._}catch{const r="No session!";throw c.log(r),{err:r}}},t.prototype.trust=async function(h){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),c.is(h)&&h.get("pub").get((r,u)=>{console.log(r,u)}),h.get("trust").get(path).put(theirPubkey)},t.prototype.grant=function(h,r){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,s=u.back(-1).user(),y=s._.sea,w="";return u.back(function(e){e.is||(w+=e.get||"")}),async function(){var e,p=await s.get("grant").get(y.pub).get(w).then();p=await i.decrypt(p,y),p||(p=i.random(16).toString(),e=await i.encrypt(p,y),s.get("grant").get(y.pub).get(w).put(e));var v=h.get("pub").then(),k=h.get("epub").then();v=await v,k=await k;var a=await i.secret(k,y);e=await i.encrypt(p,a),s.get("grant").get(v).get(w).put(e,r)}(),u},t.prototype.secret=function(h,r){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,s=u.back(-1).user(),y=s.pair(),w="";return u.back(function(e){e.is||(w+=e.get||"")}),async function(){var e,p=await s.get("trust").get(y.pub).get(w).then();p=await i.decrypt(p,y),p||(p=i.random(16).toString(),e=await i.encrypt(p,y),s.get("trust").get(y.pub).get(w).put(e)),e=await i.encrypt(h,p),u.put(e,r)}(),u},x.exports=t})(m,"./share"),m(function(x){var t=m("./sea"),i=m("./settings"),c,d=(t.window||"").GUN||m((""+c==typeof G?".":"")+"./gun",1);d.on("opt",function(e){e.sea||(e.sea={own:{}},e.on("put",h,e)),this.to.next(e)});function h(e){var p=this,v=p.as,k=e.put,a=k["#"],n=k["."],f=k[":"],l=k[">"],_=e["#"],g;if(!(!a||!n)){if((e._||"").faith&&(v.opt||"").faith&&typeof e._=="function"){t.opt.pack(k,function(E){t.verify(E,!1,function(N){k["="]=t.opt.unpack(N),p.to.next(e)})});return}var j=function(E){v.on("in",{"@":_,err:e.err=E})};if((e._||"").DBG&&((e._||"").DBG.c=+new Date),0<=a.indexOf("<?")&&(g=parseFloat(a.split("<?")[1]||""),g&&l<d.state()-g*1e3)){(g=e._)&&g.stun&&g.stun--;return}if(a==="~@"){h.alias(p,e,f,n,a,v,j);return}if(a.slice(0,2)==="~@"){h.pubs(p,e,f,n,a,v,j);return}if(g=t.opt.pub(a)){h.pub(p,e,f,n,a,v,j,v.user||"",g);return}if(0<=a.indexOf("#")){h.hash(p,e,f,n,a,v,j);return}h.any(p,e,f,n,a,v,j,v.user||"")}}h.hash=function(e,p,v,k,a,n,f){t.work(v,null,function(l){function _(g){let j="";for(let E=0;E<g.length;E++)j+=E-1&1?"":String.fromCharCode(parseInt(g.substring(E-1,E+1),16));return btoa(j)}if(l&&l===k.split("#").slice(-1)[0]||l&&l===_(k.split("#").slice(-1)[0]))return e.to.next(p);f("Data hash not same as hash!")},{name:"SHA-256"})},h.alias=function(e,p,v,k,a,n,f){if(!v)return f("Data must exist!");if("~@"+k===u(v))return e.to.next(p);f("Alias not same!")},h.pubs=function(e,p,v,k,a,n,f){if(!v)return f("Alias must exist!");if(k===u(v))return e.to.next(p);f("Alias not same!")},h.pub=async function(e,p,v,k,a,n,f,l,_){var g;const j=await i.parse(v)||{},E=(N,O,B)=>{if(N.m&&N.s&&O&&_)return t.verify(N,_,o=>{if(c!==o&&c!==o.e&&p.put[">"]&&p.put[">"]>parseFloat(o.e))return f("Certificate expired.");if(c!==o&&o.c&&o.w&&(o.c===O||o.c.indexOf("*")>-1)){let S=a.indexOf("/")>-1?a.replace(a.substring(0,a.indexOf("/")+1),""):"";String.match=String.match||d.text.match;const A=Array.isArray(o.w)?o.w:typeof o.w=="object"||typeof o.w=="string"?[o.w]:[];for(const $ of A)if(String.match(S,$["#"])&&String.match(k,$["."])||!$["."]&&String.match(S,$["#"])||!$["#"]&&String.match(k,$["."])||String.match(S?S+"/"+k:k,$["#"]||$)){if($["+"]&&$["+"].indexOf("*")>-1&&S&&S.indexOf(O)==-1&&k.indexOf(O)==-1)return f(`Path "${S}" or key "${k}" must contain string "${O}".`);if(o.wb&&(typeof o.wb=="string"||(o.wb||{})["#"])){var b=e.as.root.$.back(-1);return typeof o.wb=="string"&&o.wb.slice(0,1)!=="~"&&(b=b.get("~"+_)),b.get(o.wb).get(O).once(D=>D&&(D===1||D===!0)?f(`Certificant ${O} blocked.`):B(o))}return B(o)}return f("Certificate verification fail.")}})};if(k==="pub"&&"~"+_===a)return v===_?e.to.next(p):f("Account not same!");if((g=l.is)&&g.pub&&!j["*"]&&!j["+"]&&(_===g.pub||_!==g.pub&&((p._.msg||{}).opt||{}).cert)){t.opt.pack(p.put,N=>{t.sign(N,l._.sea,async function(O){if(c===O)return f(t.err||"Signature fail.");if(p.put[":"]={":":g=t.opt.unpack(O.m),"~":O.s},p.put["="]=g,_===l.is.pub){(g=u(v))&&((n.sea.own[g]=n.sea.own[g]||{})[_]=1),JSON.stringifyAsync(p.put[":"],function(B,o){return B?f(B||"Stringify error."):(p.put[":"]=o,e.to.next(p))});return}if(_!==l.is.pub&&((p._.msg||{}).opt||{}).cert){const B=await i.parse(p._.msg.opt.cert);B&&B.m&&B.s&&E(B,l.is.pub,o=>{p.put[":"]["+"]=B,p.put[":"]["*"]=l.is.pub,JSON.stringifyAsync(p.put[":"],function(b,S){return b?f(b||"Stringify error."):(p.put[":"]=S,e.to.next(p))})})}},{raw:1})});return}t.opt.pack(p.put,N=>{t.verify(N,j["*"]||_,function(O){var B;if(O=t.opt.unpack(O),c===O)return f("Unverified data.");if((B=u(O))&&_===t.opt.pub(B)&&((n.sea.own[B]=n.sea.own[B]||{})[_]=1),j["+"]&&j["+"].m&&j["+"].s&&j["*"])E(j["+"],j["*"],o=>(p.put["="]=O,e.to.next(p)));else return p.put["="]=O,e.to.next(p)})})},h.any=function(e,p,v,k,a,n,f,l){if(n.opt.secure)return f("Soul missing public key at '"+k+"'.");n.on("secure",function(_){if(this.off(),!n.opt.secure)return e.to.next(_);f("Data cannot be changed.")}).on.on("secure",p)};var r=d.valid,u=function(e,p){return typeof(p=r(e))=="string"&&p};(d.state||"").ify;var s=/[^\w_-]/;t.opt.pub=function(e){if(e&&(e=e.split("~"),!(!e||!(e=e[1]))&&(e=e.split(s).slice(0,2),!(!e||e.length!=2)&&(e[0]||"")[0]!=="@")))return e=e.slice(0,2).join("."),e},t.opt.stringy=function(e){},t.opt.pack=function(e,p,v,k,a){var n,f;if(t.opt.check(e))return p(e);e&&e["#"]&&e["."]&&e[">"]&&(n=e[":"],f=1),JSON.parseAsync(f?n:e,function(l,_){var g=c!==(_||"")[":"]&&(_||"")["~"];if(!g){p(e);return}p({m:{"#":a||e["#"],".":v||e["."],":":(_||"")[":"],">":e[">"]||d.state.is(k,v)},s:g})})};var y=t.opt;t.opt.unpack=function(e,p,v){var k;if(c!==e){if(e&&c!==(k=e[":"]))return k;if(p=p||y.fall_key,!v&&y.fall_val&&(v={},v[p]=y.fall_val),!(!p||!v)){if(e===v[p]||!t.opt.check(v[p]))return e;var a=v&&v._&&v._["#"]||y.fall_soul,n=d.state.is(v,p)||y.fall_state;if(e&&e.length===4&&a===e[0]&&p===e[1]&&w(n)===w(e[3]))return e[2];if(n<t.opt.shuffle_attack)return e}}},t.opt.shuffle_attack=15463296e5;var w=Math.floor})(m,"./index")})()}(ut),ut.exports;var ie=typeof window<"u"?window.Gun:Rt;const Ft="#",L="_";ie.chain.unset=function(J){return this&&J&&J[L]&&J[L].put&&J[L].put[L]&&J[L].put[L][Ft]&&this.put({[J[L].put[L][Ft]]:null}),this},F=oe(["http://localhost:3000/gun"]),F.clear=function(){localStorage.clear(),sessionStorage.clear(),indexedDB.databases().then(J=>{for(let m of J)indexedDB.deleteDatabase(m.name)}),console.log("Local data cleared")},F.lookup=async function(J,m){var i;const G=await F.get(J).get(m).then(),x=((i=G==null?void 0:G._)==null?void 0:i[">"])&&Object.keys(G._[">"])[0];if(!x)return null;const t=await F.get(x).then();return t?{id:m,...t}:null};const{ref:ae,inject:ue,provide:se,computed:de,onMounted:ce,onUnmounted:fe}=await R("vue");ee=function(J){const m=ae([]),G=async t=>{const i=crypto.randomUUID(),c=Object.fromEntries(t.entries());c.id=i,m.value.push(c);const d=F.get(`link-plugin/${i}`).put(c);return F.get(J).get("links").set(d),d},x=async t=>{const i=F.get(`link-plugin/${t}`);i.then(()=>{F.get(J).get("links").unset(i)}),m.value=m.value.filter(c=>c.id!==t)};ce(()=>{F.get(J).get("links").map().once(t=>{t&&(m.value.some(i=>i.href===t.href)||m.value.push(t))})}),fe(()=>{F.get(J).get("links").map().off()}),se("link",{links:m,createLink:G,removeLink:x})},ht=function(){const J=ue("link");if(!J)throw new Error("Composable must have an link provider.");return J};let Lt,Y,Q,V,Wt,st,qt,Vt,zt,Yt,ct;({defineComponent:Lt}=await R("vue")),{createTextVNode:Y,withCtx:Q,createVNode:V,toDisplayString:Wt,openBlock:st,createBlock:qt,createCommentVNode:Vt,withModifiers:zt,createElementBlock:Yt}=await R("vue"),{ref:ct}=await R("vue"),te=Lt({__name:"LinkForm",emits:["submit"],setup(J,{emit:m}){const G=m,{links:x,createLink:t}=ht(),i=ct(null),c=ct(""),d=async()=>{var h;try{if(c.value.length)return;const r=new FormData(i.value??void 0),u=await t(r);(h=i.value)==null||h.reset(),G("submit")}catch(r){console.error(r),c.value=r.response.data}};return(h,r)=>(st(),Yt("form",{ref_key:"form",ref:i,onSubmit:zt(d,["prevent"]),class:"space-y-2"},[V(lt,null,{default:Q(()=>r[0]||(r[0]=[Y(" Add a link ")])),_:1}),c.value?(st(),qt(Kt,{key:0,color:"red"},{default:Q(()=>[Y(Wt(c.value),1)]),_:1})):Vt("",!0),V(nt,{name:"href",placeholder:"Write your link here ..."}),V(nt,{name:"title",placeholder:"Give it a title (optional)"}),V(pt,{className:"w-full mt-4"},{default:Q(()=>r[1]||(r[1]=[Y(" Submit ")])),_:1})],544))}})});export{lt as _,he as __tla,te as a,pt as b,F as g,ee as l,ht as u};
