import{importShared as R,__tla as le}from"./__federation_fn_import-Cl8bnd4D.js";import{c as Zt,b as pe,a as ft}from"./_commonjs-dynamic-modules-D9Q0Knnx.js";let lt,te,pt,F,ee,ht,he=Promise.all([(()=>{try{return le}catch{}})()]).then(async()=>{let yt,dt,gt,vt,bt,mt,wt,tt,et,ne,kt,St,_t,xt,At,jt,Ot,Tt,Dt,$t,Bt,Ct,nt,Nt,Ut,rt,ot,Et,it,Gt,Pt,Jt,Mt,It,Ht,Kt;({defineComponent:yt}=await R("vue")),{renderSlot:dt,normalizeClass:gt,openBlock:vt,createElementBlock:bt}=await R("vue"),lt=yt({__name:"Title",props:{float:{type:String,default:"left",required:!1}},setup(J){return(m,G)=>(vt(),bt("h3",{class:gt(`my-auto text-${J.float} text-lg text-gray-800 dark:text-gray-100 font-semibold`)},[dt(m.$slots,"default")],2))}}),{createTextVNode:mt,Fragment:wt,openBlock:tt,createElementBlock:et,createCommentVNode:ne,renderSlot:kt,normalizeClass:St}=await R("vue"),_t=["disabled"],{ref:xt,computed:At,watch:jt}=await R("vue"),pt={__name:"SubmitButton",props:{className:{type:String,default:""}},setup(J){const m=J,G=xt(!1),x=()=>{G.value=!0,setTimeout(()=>{G.value=!1},2e3)};jt(G,o=>{o&&x()});const t=At(()=>`inline-flex justify-center px-4 py-2 text-sm font-medium border border-blue-600 dark:border-blue-400 text-blue-600 dark:text-blue-400 bg-transparent rounded-lg shadow-sm hover:bg-blue-50 dark:hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 ${m.className}
`);return(o,c)=>(tt(),et("button",{type:"submit",disabled:G.value,class:St(t.value)},[G.value?(tt(),et(wt,{key:0},[mt(" Sending ... ")],64)):kt(o.$slots,"default",{key:1})],10,_t))}},{defineComponent:Ot}=await R("vue"),{createElementVNode:Tt,openBlock:Dt,createElementBlock:$t}=await R("vue"),Bt={class:"relative w-full flex items-center min-w-[100px] outline-none rounded-md transition duration-100 border bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-white border-gray-300 dark:border-gray-600"},Ct=["id","type","name","placeholder","disabled","value"],nt=Ot({__name:"TextInput",props:{id:{type:String,required:!1},type:{type:String,default:"text"},name:{type:String,required:!1},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(J,{emit:m}){return(G,x)=>(Dt(),$t("div",Bt,[Tt("input",{id:J.id,type:J.type,name:J.name,placeholder:J.placeholder,disabled:J.disabled,value:J.modelValue,onInput:x[0]||(x[0]=t=>G.$emit("update:modelValue",t.target.value)),class:"w-full bg-transparent focus:outline-none focus:ring-0 border-none text-sm rounded-lg transition duration-100 py-2 text-gray-900 dark:text-white pr-3 pl-3 placeholder-gray-400 dark:placeholder-gray-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"},null,40,Ct)]))}}),{defineComponent:Nt}=await R("vue"),{toDisplayString:Ut,openBlock:rt,createElementBlock:ot,createCommentVNode:Et,createElementVNode:it,renderSlot:Gt,normalizeClass:Pt}=await R("vue"),Jt={class:"flex items-start"},Mt={key:0,class:"font-semibold"},It={class:"overflow-y-auto text-xs"},{computed:Ht}=await R("vue"),Kt=Nt({__name:"Callout",props:{title:{type:String,required:!1},color:{type:String,default:"red",validator:J=>["red","green"].includes(J)}},setup(J){const m=J,G=Ht(()=>{const x="flex flex-col overflow-hidden rounded-lg border-l-4 p-4 mb-2 opacity-75",t=m.color==="red"?"bg-red-100 border-red-500 text-red-700":"bg-green-100 border-green-500 text-green-700";return`${x} ${t}`});return(x,t)=>(rt(),ot("div",{class:Pt(G.value)},[it("div",Jt,[J.title?(rt(),ot("h4",Mt,Ut(J.title),1)):Et("",!0)]),it("p",It,[Gt(x.$slots,"default")])],2))}});var at={exports:{}};at.exports,function(J){(function(){function m(x,t){return t?Zt(x):x.slice?m[o(x)]:function(c,p){x(c={exports:{}}),m[o(p)]=c.exports};function o(c){return c.split("/").slice(-1).toString().replace(".js","")}}var G=J;m(function(x){String.random=function(o,c){var p="";for(o=o||24,c=c||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";o-- >0;)p+=c.charAt(Math.floor(Math.random()*c.length));return p},String.match=function(o,c){var p,y;return typeof o!="string"?!1:(typeof c=="string"&&(c={"=":c}),c=c||{},p=c["="]||c["*"]||c[">"]||c["<"],o===p?!0:y!==c["="]?!1:(p=c["*"]||c[">"],o.slice(0,(p||"").length)===p?!0:y!==c["*"]?!1:y!==c[">"]&&y!==c["<"]?o>=c[">"]&&o<=c["<"]:y!==c[">"]&&o>=c[">"]||y!==c["<"]&&o<=c["<"]))},String.hash=function(o,c){if(typeof o=="string"){if(c=c||0,!o.length)return c;for(var p=0,y=o.length,i;p<y;++p)i=o.charCodeAt(p),c=(c<<5)-c+i,c|=0;return c}};var t=Object.prototype.hasOwnProperty;Object.plain=function(o){return o?o instanceof Object&&o.constructor===Object||Object.prototype.toString.call(o).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(o,c){for(var p in o)if(t.call(o,p)&&(!c||c.indexOf(p)==-1))return!1;return!0},Object.keys=Object.keys||function(o){var c=[];for(var p in o)t.call(o,p)&&c.push(p);return c},function(){var o,c=setTimeout,p=0,y=0,i=typeof setImmediate!=""+o&&setImmediate||function(s,d){return typeof MessageChannel==""+o?c:((s=new MessageChannel).port1.onmessage=function(w){w.data==""&&d()},function(w){d=w,s.port2.postMessage("")})}(),u=c.check=c.check||typeof performance!=""+o&&performance||{now:function(){return+new Date}};c.hold=c.hold||9,c.poll=c.poll||function(s){if(c.hold>=u.now()-p&&y++<3333){s();return}i(function(){p=u.now(),s()},y=0)}}(),function(){var o=setTimeout,c=o.turn=o.turn||function(d){p.push(d)==1&&y(s)},p=c.s=[],y=o.poll,i=0,u,s=function(){(u=p[i++])&&u(),(i==p.length||i==99)&&(p=c.s=p.slice(i),i=0),p.length&&y(s)}}(),function(){var o,c=setTimeout,p=c.turn;(c.each=c.each||function(y,i,u,s){s=s||9,function d(w,e,h){if(e=(w=(y||[]).splice(0,s)).length){for(var v=0;v<e&&o===(h=i(w[v]));v++);if(o===h){p(d);return}}u&&u(h)}()})()}()})(m,"./shim"),m(function(x){x.exports=function t(u,c,p){if(!u)return{to:t};var y,i=typeof c=="function",u=(this.tag||(this.tag={}))[u]||i&&(this.tag[u]={tag:u,to:t._={next:function(d){var w;(w=this.to)&&w.next(d)}}});if(i){var s={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:c,the:u,on:this,as:p};return(s.back=u.last||u).to=s,u.last=s}return(u=u.to)&&y!==c&&u.next(c),u}})(m,"./onto"),m(function(x){x.exports=function(t){return t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"&&t!=1/0&&t!=-1/0&&t===t||!!t&&typeof t["#"]=="string"&&Object.keys(t).length===1&&t["#"]}})(m,"./valid"),m(function(x){m("./shim");function t(){var u=+new Date;return y<u?(c=0,y=u+t.drift):y=u+(c+=1)/p+t.drift}t.drift=0;var o=-1/0,c=0,p=999,y=o,i;t.is=function(u,s,d){var w=s&&u&&u._&&u._[">"]||d;if(w)return typeof(w=w[s])=="number"?w:o},t.ify=function(u,s,d,w,e){(u=u||{})._=u._||{},e&&(u._["#"]=e);var h=u._[">"]||(u._[">"]={});return i!==s&&s!=="_"&&(typeof d=="number"&&(h[s]=d),i!==w&&(u[s]=w)),u},x.exports=t})(m,"./state"),m(function(x){m("./shim");function t(o){var c={s:{}},p=c.s;o=o||{max:999,age:1e3*9},c.check=function(i){return p[i]?y(i):!1};var y=c.track=function(i){var u=p[i]||(p[i]={});return u.was=c.now=+new Date,c.to||(c.to=setTimeout(c.drop,o.age+9)),y.ed&&y.ed(i),u};return c.drop=function(i){c.to=null,c.now=+new Date;var u=Object.keys(p);console.STAT&&console.STAT(c.now,+new Date-c.now,"dup drop keys"),setTimeout.each(u,function(s){var d=p[s];d&&(i||o.age)>c.now-d.was||delete p[s]},0,99)},c}x.exports=t})(m,"./dup"),m(function(x){m("./onto"),x.exports=function(o,c){if(this.on){var p=(this.opt||{}).lack||9e3;if(typeof o!="function"){if(!o)return;var i=o["#"]||o,y=(this.tag||"")[i];return y?(c&&(y=this.on(i,c),clearTimeout(y.err),y.err=setTimeout(function(){y.off()},p)),!0):void 0}var i=c&&c["#"]||t(9);if(!o)return i;var u=this.on(i,o,c);return u.err=u.err||setTimeout(function(){u.off(),u.next({err:"Error: No ACK yet.",lack:!0})},p),i}};var t=String.random||function(){return Math.random().toString(36).slice(2)}})(m,"./ask"),m(function(x){function t(e){return e instanceof t?(this._={$:this}).$:this instanceof t?t.create(this._={$:this,opt:e}):new t(e)}t.is=function(e){return e instanceof t||e&&e._&&e===e._.$||!1},t.version=.202,t.chain=t.prototype,t.chain.toJSON=function(){},m("./shim"),t.valid=m("./valid"),t.state=m("./state"),t.on=m("./onto"),t.dup=m("./dup"),t.ask=m("./ask"),function(){t.create=function(r){r.root=r.root||r,r.graph=r.graph||{},r.on=r.on||t.on,r.ask=r.ask||t.ask,r.dup=r.dup||t.dup();var b=r.$.opt(r.opt);return r.once||(r.on("in",e,r),r.on("out",e,r),r.on("put",k,r),t.on("create",r),r.on("create",r)),r.once=1,b};function e(r){if(r){if(r.out===e){this.to.next(r);return}var b=this,S=b.as,A=S.at||S,$=A.$,D=A.dup,T,N=r.DBG;if((T=r["#"])||(T=r["#"]=c(9)),!D.check(T)){if(D.track(T),T=r._,r._=typeof T=="function"?T:function(){},r.$&&r.$===(r.$._||"").$||(r.$=$),r["@"]&&!r.put&&n(r),!A.ask(r["@"],r))if(N&&(N.u=+new Date),r.put){h(r);return}else r.get&&t.on.get(r,$);N&&(N.uc=+new Date),b.to.next(r),N&&(N.ua=+new Date),!(r.nts||r.NTS)&&(r.out=e,A.on("out",r),N&&(N.ue=+new Date))}}}function h(r){if(r){var b=r._||"",S=b.root=((b.$=r.$||"")._||"").root;if(r["@"]&&b.faith&&!b.miss){r.out=e,S.on("out",r);return}b.latch=S.hatch,b.match=S.hatch=[];var A=r.put,$=b.DBG=r.DBG,D=+new Date;if(C=C||D,!(A["#"]&&A["."])){$&&($.p=D),b["#"]=r["#"],b.msg=r,b.all=0,b.stun=1;var T=Object.keys(A);console.STAT&&console.STAT(D,(($||b).pk=+new Date)-D,"put sort");var N=0,E,P,M,I,H,K,z;(function W(X){if(E!=N){if(E=N,!(M=T[N])){console.STAT&&console.STAT(D,(($||b).pd=+new Date)-D,"put"),a(b);return}(I=A[M])?(z=I._)?M!==z["#"]?K=l+_(M)+"soul not same.":(H=z[">"])||(K=l+_(M)+"no state."):K=l+_(M)+"no meta.":K=l+_(M)+"no node.",P=Object.keys(I||{})}if(K){r.err=b.err=K,a(b);return}var Qt=0,q;for(X=X||0;X++<9&&(q=P[Qt++]);)if(q!=="_"){var Z=I[q],Xt=H[q];if(s===Xt){K=l+_(q)+"on"+_(M)+"no state.";break}if(!y(Z)){K=l+_(q)+"on"+_(M)+"bad "+typeof Z+_(Z);break}v(Z,q,M,Xt,r),++U}if((P=P.slice(Qt)).length){p(W);return}++N,P=null,W(X)})()}}}t.on.put=h;function v(r,b,S,A,$){var D=$._||"",T=D.root,N=T.graph,E,P=N[S]||d,M=i(P,b,1),I=P[b],H=D.DBG;(E=console.STAT)&&(!N[S]||!I)&&(E.has=(E.has||0)+1);var K=O();if(A>K){setTimeout(function(){v(r,b,S,A,$)},(E=A-K)>j?j:E),console.STAT&&console.STAT((H||D).Hf=+new Date,E,"future");return}if(!(A<M)&&!(!D.faith&&A===M&&(r===I||g(r)<=g(I))&&!D.miss)){D.stun++;var z=$["#"]+D.all++,W={toString:function(){return z},_:D};W.toJSON=W.toString,T.dup.track(W)["#"]=$["#"],H&&(H.ph=H.ph||+new Date),T.on("put",{"#":W,"@":$["@"],put:{"#":S,".":b,":":r,">":A},ok:$.ok,_:D})}}function k(r){var b;(b=(r._||"").DBG)&&(b.pa=+new Date,b.pm=b.pm||+new Date);var S=this,A=S.as,$=A.graph,D=r._,T=r.put,N=T["#"],E=T["."],P=T[":"],M=T[">"];r["#"];var I;(I=D.msg)&&(I=I.put)&&(I=I[N])&&u(I,E,M,P,N),$[N]=u($[N],E,M,P,N),(I=(A.next||"")[N])&&I.on("in",r),a(D),S.to.next(r)}function a(r,b){var S;if(!r.stop&&!(!r.err&&0<--r.stun)&&(r.stop=1,!!(S=r.root))){var A=r.match;A.end=1,A===S.hatch&&(!(A=r.latch)||A.end?delete S.hatch:S.hatch=A),r.hatch&&r.hatch(),setTimeout.each(r.match,function($){$&&$()}),!(!(b=r.msg)||r.err||b.err)&&(b.out=e,r.root.on("out",b),B())}}function n(r){var b=r["@"]||"",S;if(!(S=b._)){var A=(A=r.$)&&(A=A._)&&(A=A.root)&&(A=A.dup);if(!(A=A.check(b)))return;r["@"]=A["#"]||r["@"];return}S.acks=(S.acks||0)+1,(S.err=r.err)&&(r["@"]=S["#"],a(S)),S.ok=r.ok||S.ok,!S.stop&&!S.crack&&(S.crack=S.match&&S.match.push(function(){f(S)})),f(S)}function f(r){!r||!r.root||r.stun||r.acks!==r.all||r.root.on("in",{"@":r["#"],err:r.err,ok:r.err?s:r.ok||{"":1}})}var l="Error: Invalid graph!",_=function(r){return" '"+(""+r).slice(0,9)+"...' "},g=JSON.stringify,j=2147483647,O=t.state,U=0,C,B=function(){U>999&&U/-(C-(C=+new Date))>1&&(t.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),B=function(){U=0})}}(),function(){t.on.get=function(h,v){var k=v._,a=h.get,n=a["#"],f=k.graph[n],l=a["."],_=k.next||(k.next={}),g=_[n],j=h._||{},O=j.DBG=h.DBG;if(O&&(O.g=+new Date),!f)return k.on("get",h);if(l){if((typeof l!="string"||s===f[l])&&!((g||"").next||"")[l]){k.on("get",h);return}f=u({},l,i(f,l),f[l],n)}f&&e(h,f),k.on("get",h)};function e(h,v){var k=+new Date,a=h._||{},n=a.DBG=h.DBG,f=h["#"],l=c(9),_=Object.keys(v||"").sort(),g=((v||"")._||"")["#"];_.length;var j=h.$._.root,O=v===j.graph[g];console.STAT&&console.STAT(k,((n||a).gk=+new Date)-k,"got keys"),v&&function U(){k=+new Date;for(var C=0,B,r={},b;C<9&&(B=_[C++]);)u(r,B,i(v,B),v[B],g);_=_.slice(C),(b={})[g]=r,r=b;var S;O&&(S=function(){},S.ram=S.faith=!0),b=_.length,console.STAT&&console.STAT(k,-(k-(k=+new Date)),"got copied some"),n&&(n.ga=+new Date),j.on("in",{"@":f,"#":l,put:r,"%":b?l=c(9):s,$:j.$,_:S,DBG:n,FOO:1}),console.STAT&&console.STAT(k,+new Date-k,"got in"),b&&setTimeout.turn(U)}(),v||j.on("in",{"@":h["#"]})}t.on.get.ack=e}(),function(){t.chain.opt=function(e){e=e||{};var h=this,v=h._,k=e.peers||e;return Object.plain(e)||(e={}),Object.plain(v.opt)||(v.opt=e),typeof k=="string"&&(k=[k]),Object.plain(v.opt.peers)||(v.opt.peers={}),k instanceof Array&&(e.peers={},k.forEach(function(a){var n={};n.id=n.url=a,e.peers[a]=v.opt.peers[a]=v.opt.peers[a]||n})),o(e,function a(n){var f=this[n];if(this&&this.hasOwnProperty(n)||typeof f=="string"||Object.empty(f)){this[n]=f;return}f&&f.constructor!==Object&&!(f instanceof Array)||o(f,a)}),v.opt.from=e,t.on("opt",v),v.opt.uuid=v.opt.uuid||function(a){return t.state().toString(36).replace(".","")+String.random(a||12)},h}}();var o=function(e,h){Object.keys(e).forEach(h,e)},c=String.random,p=setTimeout.turn,y=t.valid,i=t.state.is,u=t.state.ify,s,d={},w;t.log=function(){return!t.log.off&&w.log.apply(w,arguments),[].slice.call(arguments).join(" ")},t.log.once=function(e,h,v){return(v=t.log.once)[e]=v[e]||0,v[e]++||t.log(h)},typeof window<"u"&&((window.GUN=window.Gun=t).window=window);try{typeof G<"u"&&(G.exports=t)}catch{}x.exports=t,(t.window||{}).console=(t.window||{}).console||{log:function(){}},(w=console).only=function(e,h){return w.only.i&&e===w.only.i&&w.only.i++&&(w.log.apply(w,arguments)||h)},t.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(m,"./root"),m(function(x){var t=m("./root");t.chain.back=function(p,y){var i;if(p=p||1,p===-1||p===1/0)return this._.root.$;if(p===1)return(this._.back||this._).$;var u=this,s=u._;if(typeof p=="string"&&(p=p.split(".")),p instanceof Array){var d=0,w=p.length,i=s;for(d;d<w;d++)i=(i||o)[p[d]];return c!==i?y?u:i:(i=s.back)?i.$.back(p,y):void 0}if(typeof p=="function"){for(var e,i={back:s};(i=i.back)&&c===(e=p(i,y)););return e}return typeof p=="number"?(s.back||s).$.back(p-1):this};var o={},c})(m,"./back"),m(function(x){var t=m("./root");t.chain.chain=function(a){var n=this,f=n._,l=new(a||n).constructor(n),_=l._,g;return _.root=g=f.root,_.id=++g.once,_.back=n._,_.on=t.on,_.on("in",t.on.in,_),_.on("out",t.on.out,_),l};function o(a){var n,f=this.as,l=f.back,_=f.root,g;if(a.$||(a.$=f.$),this.to.next(a),f.err){f.on("in",{put:f.put=s,$:f.$});return}if(n=a.get){if(_.pass&&(_.pass[f.id]=f),f.lex&&Object.keys(f.lex).forEach(function(j){g[j]=f.lex[j]},g=a.get=a.get||{}),n["#"]||f.soul){if(n["#"]=n["#"]||f.soul,a["#"]||(a["#"]=d(9)),l=_.$.get(n["#"])._,n=n["."]){if(e(l.put,n)&&(g=l.ask&&l.ask[n],(l.ask||(l.ask={}))[n]=l.$.get(n)._,l.on("in",{get:n,put:{"#":l.soul,".":n,":":l.put[n],">":v(_.graph[l.soul],n)}}),g))return}else{if(g=l.ask&&l.ask[""],(l.ask||(l.ask={}))[""]=l,s!==l.put&&(l.on("in",l),g))return;a.$=l.$}return _.ask(i,a),_.on("in",a)}if(n["."])return f.get?(a={get:{".":f.get},$:f.$},(l.ask||(l.ask={}))[f.get]=a.$._,l.on("out",a)):(a={get:f.lex?a.get:{},$:f.$},l.on("out",a));if((f.ask||(f.ask={}))[""]=f,f.get)return n["."]=f.get,(l.ask||(l.ask={}))[f.get]=a.$._,l.on("out",a)}return l.on("out",a)}t.on.out=o;function c(a,n){n=n||this.as;var f=n.root,l=a.$||(a.$=n.$),_=(l||"")._||u,g=a.put||"",j=g["#"],O=g["."],U=s!==g["="]?g["="]:g[":"],C=g[">"]||-1/0,B;if(s!==a.put&&(s===g["#"]||s===g["."]||s===g[":"]&&s===g["="]||s===g[">"])){if(!w(g)){if(!(j=((g||"")._||"")["#"])){console.log("chain not yet supported for",g,"...",a,n);return}return l=n.root.$.get(j),setTimeout.each(Object.keys(g).sort(),function(r){r=="_"||s===(C=v(g,r))||n.on("in",{$:l,put:{"#":j,".":r,"=":g[r],">":C},VIA:a})})}n.on("in",{$:_.back.$,put:{"#":j=_.back.soul,".":O=_.has||_.get,"=":g,">":v(_.back.put,O)},via:a});return}(a.seen||"")[n.id]||((a.seen||(a.seen=function(){}))[n.id]=n,n!==_&&(Object.keys(a).forEach(function(r){g[r]=a[r]},g={}),g.get=n.get||g.get,!n.soul&&!n.has?g.$$$=g.$$$||n.$:_.soul&&(g.$=n.$,g.$$=g.$$||_.$),a=g),y(a,n),(n.soul||a.$$)&&C>=v(f.graph[j],O)&&((g=f.$.get(j)._).put=k(g.put,O,C,U,j)),!_.soul&&C>=v(f.graph[j],O)&&(B=(f.$.get(j)._.next||"")[O])&&(B.put=U,typeof(g=w(U))=="string"&&(B.put=f.$.get(g)._.put||U)),this.to&&this.to.next(a),n.any&&setTimeout.each(Object.keys(n.any),function(r){(r=n.any[r])&&r(a)},0,99),n.echo&&setTimeout.each(Object.keys(n.echo),function(r){(r=n.echo[r])&&r.on("in",a)},0,99),((a.$$||"")._||_).soul&&(B=n.next)&&(B=B[O])&&(g={},Object.keys(a).forEach(function(r){g[r]=a[r]}),g.$=(a.$$||a.$).get(g.get=O),delete g.$$,delete g.$$$,B.on("in",g)),p(a,n))}t.on.in=c;function p(a,n){if(n=n||this.as||a.$._,!(a.$$&&this!==t.on)&&!(!a.put||n.soul)){var f=a.put||"",l=f["="]||f[":"],_,g=n.root,j=g.$.get(f["#"]).get(f["."])._;if(typeof(l=w(l))!="string"){this===t.on&&((j.echo||(j.echo={}))[n.id]=n);return}if(!((j.echo||(j.echo={}))[n.id]&&!(g.pass||"")[n.id])){if(_=g.pass){if(_[l+n.id])return;_[l+n.id]=1}(j.echo||(j.echo={}))[n.id]=n,n.has&&(n.link=l);var O=g.$.get(j.link=l)._;(O.echo||(O.echo={}))[j.id]=j;var _=n.ask||"";(_[""]||n.lex)&&O.on("out",{get:{"#":l}}),setTimeout.each(Object.keys(_),function(C,B){!C||!(B=_[C])||B.on("out",{get:{"#":l,".":C}})},0,99)}}}t.on.link=p;function y(a,n){var f=a.put||"",l=s!==f["="]?f["="]:f[":"],_=n.root,g,j;if(s===l){if(n.soul&&s!==n.put||(j=(a.$$||a.$||"")._||"",a["@"]&&(s!==j.put||s!==n.put)))return;(g=n.link||a.linked)&&delete(_.$.get(g)._.echo||"")[n.id],n.has&&(n.link=null),n.put=s,setTimeout.each(Object.keys(n.next||""),function(O,U){(U=n.next[O])&&(g&&delete(_.$.get(g).get(O)._.echo||"")[U.id],U.on("in",{get:O,put:s,$:U.$}))},0,99);return}n.soul||a.$$||(g=w(l),j=a.$._||"",!((g===j.link||n.has&&!j.link)&&!((_.pass||"")[n.id]&&typeof g!="string"))&&(delete(j.echo||"")[n.id],y({get:n.get,put:s,$:a.$,linked:a.linked=a.linked||j.link},n)))}t.on.unlink=y;function i(a,n){var f=this.as,l=f.$._;l.root;var _=f.get||"",g=(a.put||"")[_["#"]]||"";if(!a.put||typeof _["."]=="string"&&s===g[_["."]]){if(s!==l.put||!l.soul&&!l.has)return;l.ack=(l.ack||0)+1,l.on("in",{get:l.get,put:l.put=s,$:l.$,"@":a["@"]});return}(a._||{}).miss=1,t.on.put(a)}var u={},s,d=String.random,w=t.valid,e=function(a,n){return a&&Object.prototype.hasOwnProperty.call(a,n)},h=t.state,v=h.is,k=h.ify})(m,"./chain"),m(function(x){var t=m("./root");t.chain.get=function(s,d,w){var e,h;if(typeof s=="string"){if(s.length==0)return(e=this.chain())._.err={err:t.log("0 length key!",s)},d&&d.call(e,e._.err),e;var v=this,k=v._,a=k.next||y;(e=a[s])||(e=s&&o(s,v)),e=e&&e.$}else if(typeof s=="function"){let g=function(O,U,C){if(!g.stun&&!(($=f.pass)&&!$[l])){var B=O.$._,r=(O.$$||"")._,b=(r||B).put,S=!B.has&&!B.soul,A={},$;if((S||u===b)&&(b=u===(($=O.put)||"")["="]?u===($||"")[":"]?$:$[":"]:$["="]),typeof($=t.valid(b))=="string"&&(b=u===($=f.$.get($)._.put)?n.not?u:b:$),!(n.not&&u===b)){if(u===n.stun){if(($=f.stun)&&$.on&&(k.$.back(function(D){if($.on(""+D.id,A={}),(A.run||0)<g.id)return A}),!A.run&&$.on(""+B.id,A={}),!A.run&&r&&$.on(""+r.id,A={}),g.id>A.run&&((!A.stun||A.stun.end)&&(A.stun=$.on("stun"),A.stun=A.stun&&A.stun.last),A.stun&&!A.stun.end))){(A.stun.add||(A.stun.add={}))[l]=function(){g(O,U,1)};return}if(u===b&&(C=0),($=f.hatch)&&!$.end&&u===n.hatch&&!C){if(_[B.$._.id])return;_[B.$._.id]=1,$.push(function(){g(O,U,1)});return}_={}}if(f.pass){if(f.pass[l+B.id])return;f.pass[l+B.id]=1}if(n.on){n.ok.call(B.$,b,B.get,O,U||g);return}if(n.v2020){n.ok(O,U||g);return}Object.keys(O).forEach(function(D){$[D]=O[D]},$={}),O=$,O.put=b,n.ok.call(n.as,O,U||g)}}};if(d===!0)return c(this,s,d,w),this;e=this;var k=e._,n=d||{},f=k.root,l;n.at=k,n.ok=s;var _={};return g.at=k,(k.any||(k.any={}))[l=String.random(7)]=g,g.off=function(){g.stun=1,k.any&&delete k.any[l]},g.rid=p,g.id=n.run||++f.once,h=f.pass,(f.pass={})[l]=1,n.out=n.out||{get:{}},k.on("out",n.out),f.pass=h,e}else{if(typeof s=="number")return this.get(""+s,d,w);if(typeof(h=i(s))=="string")return this.get(h,d,w);(h=this.get.next)&&(e=h(this,s))}return e?(d&&typeof d=="function"&&e.get(d,w),e):((e=this.chain())._.err={err:t.log("Invalid get request!",s)},d&&d.call(e,e._.err),e)};function o(s,d){var w=d._,e=w.next,h=d.chain(),v=h._;return e||(e=w.next={}),e[v.get=s]=v,d===w.root.$?v.soul=s:(w.soul||w.has)&&(v.has=s),v}function c(s,d,w,e){var h=s._,v=0,k;return(k=h.soul||h.link)?d(k,e,h):h.jam?h.jam.push([d,e]):(h.jam=[[d,e]],s.get(function(a,n){if(!(u===a.put&&!h.root.opt.super&&(k=Object.keys(h.root.opt.peers).length)&&++v<=k)){n.rid(a);var f=(f=a.$)&&f._||{},l=0,_;for(k=h.jam,delete h.jam;_=k[l++];){var g=_[0];_=_[1],g&&g(f.link||f.soul||t.valid(a.put)||((a.put||{})._||{})["#"],_,a,n)}}},{out:{get:{".":!0}}}),s)}function p(s){var d=this.at||this.on;if(!s||d.soul||d.has)return this.off();if(s=(s=(s=s.$||s)._||s).id){d.map;var w;if((w=this.seen||(this.seen={}))[s])return!0;w[s]=!0}}var y={},i=t.valid,u})(m,"./get"),m(function(x){var t=m("./root");t.chain.put=function(e,h,v){var k=this,a=k._,n=a.root;v=v||{},v.root=a.root,v.run||(v.run=n.once),o(v,a.id),v.ack=v.ack||h,v.via=v.via||k,v.data=v.data||e,v.soul||(v.soul=a.soul||typeof h=="string"&&h);var f=v.state=v.state||t.state();return typeof e=="function"?(e(function(l){v.data=l,k.put(i,i,v)}),k):v.soul?(v.$=n.$.get(v.soul),v.todo=[{it:v.data,ref:v.$}],v.turn=v.turn||s,v.ran=v.ran||c,function l(){var _=v.todo,g=_.pop(),j=g.it;g.ref&&g.ref._.id;var O,U,C,B,r;if(o(v,g.ref),(B=g.todo)&&(U=B.pop(),j=j[U],B.length&&_.push(g)),U&&(_.path||(_.path=[])).push(U),!(O=d(j))&&!(r=t.is(j))){if(!Object.plain(j)){c.err(v,"Invalid data: "+y(j)+" at "+(v.via.back(function($){$.get&&B.push($.get)},B=[])||B.join("."))+"."+(_.path||[]).join("."));return}for(var b=v.seen||(v.seen=[]),S=b.length;S--;)if(j===(B=b[S]).it){O=j=B.link;break}}if(U&&O)g.node=w(g.node,U,f,j);else{let $=function(D,T){var N=C.link["#"];T&&(T.off(),T.rid(D));var E=N||D.soul||(B=(D.$$||D.$)._||"").soul||B.link||((B=B.put||"")._||"")["#"]||B["#"]||((B=D.put||"")&&D.$$?B["#"]:(B["="]||B[":"]||"")["#"]);if(!N&&o(v,D.$),!E&&!g.link["#"]){(g.wait||(g.wait=[])).push(function(){$(D,T)});return}E||(E=[],(D.$$||D.$).back(function(P){if(B=P.soul||P.link)return E.push(B);E.push(P.get)}),E=E.reverse().join("/")),C.link["#"]=E,!r&&(((v.graph||(v.graph={}))[E]=C.node||(C.node={_:{}}))._["#"]=E),delete v.wait[A],C.wait&&setTimeout.each(C.wait,function(P){P&&P()}),v.ran(v)};if(!v.seen){c.err(v,"Data at root of graph must be a node (an object).");return}v.seen.push(C={it:j,link:{},todo:r?[]:Object.keys(j).sort().reverse(),path:(_.path||[]).slice(),up:g}),g.node=w(g.node,U,f,C.link),!r&&C.todo.length&&_.push(C);var A=v.seen.length;(v.wait||(v.wait={}))[A]="",B=(C.ref=r?j:U?g.ref.get(U):g.ref)._,(B=j&&(j._||"")["#"]||B.soul||B.link)?$({soul:B}):C.ref.get($,{run:v.run,v2020:1,out:{get:{".":" "}}})}if(!_.length)return v.ran(v);v.turn(l)}(),k):(p(v),k)};function o(e,h){if(h){h=(h._||"").id||h;var v=e.root.stun||(e.root.stun={on:t.on}),k={},a;e.stun||(e.stun=v.on("stun",function(){})),(a=v.on(""+h))&&a.the.last.next(k),!(k.run>=e.run)&&v.on(""+h,function(n){if(e.stun.end){this.off(),this.to.next(n);return}n.run=n.run||e.run,n.stun=n.stun||e.stun})}}function c(e){if(e.err){c.end(e.stun,e.root);return}if(!(e.todo.length||e.end||!Object.empty(e.wait))){e.end=1;var h=e.$.back(-1)._,v=h.root,k=h.ask(function(l){v.on("ack",l),l.err&&!l.lack&&t.log(l),++a>(e.acks||0)&&this.off(),e.ack&&e.ack(l,this)},e.opt),a=0,n=e.stun,f;(f=function(){n&&(c.end(n,v),setTimeout.each(Object.keys(n=n.add||""),function(l){(l=n[l])&&l()}))}).hatch=f,e.ack&&!e.ok&&(e.ok=e.acks||9),e.via._.on("out",{put:e.out=e.graph,ok:e.ok&&{"@":e.ok+1},opt:e.opt,"#":k,_:f})}}c.end=function(e,h){e.end=u,e.the.to===e&&e===e.the.last&&delete h.stun,e.off()},c.err=function(e,h){(e.ack||u).call(e,e.out={err:e.err=t.log(h)}),e.ran(e)};function p(e){var h=e.via._,v;e.via=e.via.back(function(k){if(k.soul||!k.get)return k.$;v=e.data,(e.data={})[k.get]=v}),(!e.via||!e.via._.soul)&&(e.via=h.root.$.get(((e.data||"")._||"")["#"]||h.$.back("opt.uuid")())),e.via.put(e.data,e.ack,e)}function y(e,h){return e&&(h=e.constructor)&&h.name||typeof e}var i,u=function(){},s=setTimeout.turn,d=t.valid,w=t.state.ify})(m,"./put"),m(function(x){var t=m("./root");m("./chain"),m("./back"),m("./put"),m("./get"),x.exports=t})(m,"./index"),m(function(x){var t=m("./index");t.chain.on=function(p,y,i,u){var s=this,d=s._;d.root;var w;if(typeof p=="string")return y?(w=d.on(p,y,i||d,u),i&&i.$&&(i.subs||(i.subs=[])).push(w),s):d.on(p);var e=y;return(e=e===!0?{change:!0}:e||{}).not=1,e.on=1,s.get(p,e),s},t.chain.once=function(p,y){if(y=y||{},!p)return o(this);var i=this,u=i._,s=u.root;u.put;var d=String.random(7),w;return i.get(function(e,h,v,k){var a=this,n=a._,f=n.one||(n.one={});if(k.stun||f[d]==="")return;if((w=t.valid(e))===!0){l();return}if(typeof w=="string")return;clearTimeout((u.one||"")[d]),clearTimeout(f[d]),f[d]=setTimeout(l,y.wait||99);function l(_){if(!n.has&&!n.soul&&(n={put:e,get:h}),c===(w=n.put)&&(w=((v.$$||"")._||"").put),typeof t.valid(w)=="string"&&(w=s.$.get(w)._.put,w===c&&!_)){f[d]=setTimeout(function(){l(1)},y.wait||99);return}k.stun||f[d]!==""&&(f[d]="",(u.soul||u.has)&&k.off(),p.call(a,w,n.get),clearTimeout(f[d]))}},{on:1}),i};function o(p,y,i){return t.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(i=p.chain())._.nix=p.once(function(u,s){i._.on("in",this._)}),i._.lex=p._.lex,i}t.chain.off=function(){var p=this,y=p._,i,u=y.back;if(u)return y.ack=0,(i=u.next)&&i[y.get]&&delete i[y.get],(i=u.any)&&(delete u.any,u.any={}),(i=u.ask)&&delete i[y.get],(i=u.put)&&delete i[y.get],(i=y.soul)&&delete u.root.graph[i],(i=y.map)&&Object.keys(i).forEach(function(s,d){d=i[s],d.link&&u.root.$.get(d.link).off()}),(i=y.next)&&Object.keys(i).forEach(function(s,d){d=i[s],d.$.off()}),y.on("off",{}),p};var c})(m,"./on"),m(function(x){var t=m("./index"),o=t.chain.get.next;t.chain.get.next=function(i,u){var s;return Object.plain(u)?(s=((s=u["#"])||"")["="]||s)?i.get(s):((s=i.chain()._).lex=u,i.on("in",function(d){String.match(d.get||(d.put||"")["."],u["."]||u["#"]||u)&&s.on("in",d),this.to.next(d)}),s.$):(o||p)(i,u)},t.chain.map=function(i,u,s){var d=this,w=d._,e,h;return Object.plain(i)&&(e=i["."]?i:{".":i},i=y),i?(t.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),h=d.chain(),d.map().on(function(v,k,a,n){var f=(i||p).call(this,v,k,a,n);if(y!==f){if(v===f)return h._.on("in",a);if(t.is(f))return h._.on("in",f._);var l={};Object.keys(a.put).forEach(function(_){l[_]=a.put[_]},l),l["="]=f,h._.on("in",{get:k,put:l})}}),h):((h=w.each)||((w.each=h=d.chain())._.lex=e||h._.lex||w.lex,h._.nix=d.back("nix"),d.on("in",c,h._)),h)};function c(i){this.to.next(i);var u=this.as,s=i.$,d=s._,w=i.put,e;!d.soul&&!i.$$||(e=u.lex)&&!String.match(i.get||(w||"")["."],e["."]||e["#"]||e)||t.on.link(i,u)}var p=function(){},y})(m,"./map"),m(function(x){var t=m("./index");t.chain.set=function(o,c,p){var y=this,i=y.back(-1),u,s;return c=c||function(){},p=p||{},p.item=p.item||o,(u=((o||"")._||"")["#"])&&((o={})["#"]=u),typeof(s=t.valid(o))=="string"?y.get(u=s).put(o,c,p):t.is(o)?(y.put(function(d){o.get(function(w,e,h){if(!w)return c.call(y,{err:t.log('Only a node can be linked! Not "'+h.put+'"!')});(s={})[w]={"#":w},d(s)},!0)}),o):(Object.plain(o)&&(o=i.get(u=y.back("opt.uuid")()).put(o)),y.get(u||i.back("opt.uuid")(7)).put(o,c,p))}})(m,"./set"),m(function(x){m("./shim");var t=function(){},o=JSON.parseAsync||function(i,u,s){var d,w=+new Date;try{u(d,JSON.parse(i,s),c.sucks(+new Date-w))}catch(e){u(e)}},c=JSON.stringifyAsync||function(i,u,s,d){var w,e=+new Date;try{u(w,JSON.stringify(i,s,d),c.sucks(+new Date-e))}catch(h){u(h)}};c.sucks=function(i){i>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),c.sucks=t)};function p(i){var u=function(){},s=i.opt||{};s.log=s.log||console.log,s.gap=s.gap||s.wait||0,s.max=s.max||(s.memory?s.memory*999*999:3e8)*.3,s.pack=s.pack||s.max*.01*.01,s.puff=s.puff||9;var d=setTimeout.turn||setTimeout,w=i.dup,e=w.check,h=w.track,v=u.hear=function(n,f){if(n){if(s.max<=n.length)return u.say({dam:"!",err:"Message too big!"},f);u===this&&(v.d+=n.length||0,++v.c);var l=f.SH=+new Date,_=n[0],g;if(_==="["){o(n,function(j,O){if(j||!O)return u.say({dam:"!",err:"DAM JSON parse error."},f);console.STAT&&console.STAT(+new Date,O.length,"# on hear batch");var U=s.puff;(function C(){for(var B=+new Date,r=0,b;r<U&&(b=O[r++]);)u.hear(b,f);O=O.slice(r),console.STAT&&console.STAT(B,+new Date-B,"hear loop"),k(f),O.length&&d(C,0)})()}),n="";return}if(_==="{"||(n["#"]||Object.plain(n))&&(g=n)){if(g)return v.one(g,f,l);o(n,function(j,O){if(j||!O)return u.say({dam:"!",err:"DAM JSON parse error."},f);v.one(O,f,l)});return}}};v.one=function(n,f,l){var _,g,j,O,U;if(n.DBG&&(n.DBG=U={DBG:n.DBG}),U&&(U.h=l),U&&(U.hp=+new Date),(_=n["#"])||(_=n["#"]=String.random(9)),!(j=e(_))&&(g=n["##"],!(g&&(j=n["@"]||n.get&&_)&&w.check(O=j+g)))){if((n._=function(){}).via=u.leap=f,(j=n["><"])&&typeof j=="string"&&j.slice(0,99).split(",").forEach(function(B){this[B]=1},n._.yo={}),j=n.dam){(j=u.hear[j])&&j(n,f,i),h(_);return}(j=n.ok)&&(n._.near=j["/"]);var l=+new Date;U&&(U.is=l),f.SI=_,h.ed=function(B){_===B&&(h.ed=0,(B=w.s[_])&&(B.via=f,n.get&&(B.it=n)))},i.on("in",u.last=n),U&&(U.hd=+new Date),console.STAT&&console.STAT(l,+new Date-l,n.get?"msg get":n.put?"msg put":"msg"),h(_),O&&h(O),u.leap=u.last=null}},v.c=v.d=0,function(){var n=0,f;u.hash=function(g,j){var O,U,C,B=+new Date;c(g.put,function r(b,S){var A=(U||(U=C=S||"")).slice(0,32768);if(O=String.hash(A,O),U=U.slice(32768),U){d(r,0);return}console.STAT&&console.STAT(B,+new Date-B,"say json+hash"),g._.$put=C,g["##"]=O,u.say(g,j),delete g._.$put},l)};function l(g,j){var O;return j instanceof Object?(Object.keys(j).sort().forEach(_,{to:O={},on:j}),O):j}function _(g){this.to[g]=this.on[g]}u.say=function(g,j){var O;if((O=this)&&(O=O.to)&&O.next&&O.next(g),!g)return!1;var U,C,B,r=g["@"],b=g._||(g._=function(){}),S=g.DBG,A=+new Date;if(b.y=b.y||A,j||S&&(S.y=A),(U=g["#"])||(U=g["#"]=String.random(9)),!f&&h(U),!(C=g["##"])&&y!==g.put&&!b.via&&r){u.hash(g,j);return}if(!j&&r&&(j=(O=w.s[r])&&(O.via||(O=O.it)&&(O=O._)&&O.via)||(O=u.last)&&r===O["#"]&&u.leap),!j&&r)return w.s[r]?void 0:(console.STAT&&console.STAT(+new Date,++n,"total no peer to ack to"),!1);if(r&&!g.put&&!C&&((w.s[r]||"").it||"")["##"])return!1;if(!j&&u.way)return u.way(g);if(S&&(S.yh=+new Date),!(B=b.raw)){u.raw(g,j);return}if(S&&(S.yr=+new Date),!j||!j.id){if(!Object.plain(j||s.peers))return!1;var A=+new Date;s.puff;var $=s.peers,D=Object.keys(j||s.peers||{});console.STAT&&console.STAT(A,+new Date-A,"peer keys"),function E(){var P=+new Date;f=1;var M=b.raw;b.raw=B;for(var I=0,H;I<9&&(H=(D||"")[I++]);)(H=$[H]||(j||"")[H])&&u.say(g,H);b.raw=M,f=0,D=D.slice(I),console.STAT&&console.STAT(P,+new Date-P,"say loop"),D.length&&(d(E,0),r&&h(r))}();return}if(!j.wire&&u.wire&&u.wire(j),U!==j.last){if(j.last=U,j===b.via||(O=b.yo)&&(O[j.url]||O[j.pid]||O[j.id]))return!1;if(console.STAT&&console.STAT(A,((S||b).yp=+new Date)-(b.y||A),"say prep"),!f&&r&&h(r),j.batch){if(j.tail=(O=j.tail||0)+B.length,j.tail<=s.pack){j.batch+=(O?",":"")+B;return}k(j)}j.batch="[";var T=+new Date;setTimeout(function(){console.STAT&&console.STAT(T,+new Date-T,"0ms TO"),k(j)},s.gap),a(B,j),console.STAT&&r===j.SI&&console.STAT(A,+new Date-j.SH,"say ack")}},u.say.c=u.say.d=0,u.raw=function(g,j){if(!g)return"";var O=g._||{},U,C;if(C=O.raw)return C;if(typeof g=="string")return g;var B=g["##"],r=g["@"];if(B&&r){if(!O.via&&e(r+B))return!1;if(C=(w.s[r]||"").it){if(B===C["##"])return!1;C["##"]||(C["##"]=B)}}if(!g.dam&&!g["@"]){var b=0,S=[];C=s.peers;for(var A in C){var $=C[A];if(S.push($.url||$.pid||$.id),++b>6)break}b>1&&(g["><"]=S.join())}if(g.put&&(C=g.ok)&&(g.ok={"@":(C["@"]||1)-1,"/":C["/"]==g._.near?u.near:C["/"]}),U=O.$put){C={},Object.keys(g).forEach(function(T){C[T]=g[T]}),C.put=":])([:",c(C,function(T,N){if(!T){var E=+new Date;C=N.indexOf('"put":":])([:"'),D(y,N=N.slice(0,C+6)+U+N.slice(C+14)),console.STAT&&console.STAT(E,+new Date-E,"say slice")}});return}c(g,D);function D(T,N){T||(O.raw=N,u.say(g,j))}}}();function k(n){var f=n.batch,l=typeof f=="string";if(l&&(f+="]"),n.batch=n.tail=null,!!f&&!(l?3>f.length:!f.length)){if(!l)try{f=f.length===1?f[0]:JSON.stringify(f)}catch(_){return s.log("DAM JSON stringify error",_)}f&&a(f,n)}}function a(n,f){try{var l=f.wire;f.say?f.say(n):l.send&&l.send(n),u.say.d+=n.length||0,++u.say.c}catch{(f.queue=f.queue||[]).push(n)}}return u.near=0,u.hi=function(n){var f=n.wire,l;if(!f){u.wire(n.length&&{url:n,id:n}||n);return}n.id?s.peers[n.url||n.id]=n:(l=n.id=n.id||n.url||String.random(9),u.say({dam:"?",pid:i.opt.pid},s.peers[l]=n),delete w.s[n.last]),n.met||(u.near++,n.met=+new Date,i.on("hi",n)),l=n.queue,n.queue=[],setTimeout.each(l||[],function(_){a(_,n)},0,9)},u.bye=function(n){n.met&&--u.near,delete n.met,i.on("bye",n);var f=+new Date;f=f-(n.met||f),u.bye.time=((u.bye.time||f)+f)/2},u.hear["!"]=function(n,f){s.log("Error:",n.err)},u.hear["?"]=function(n,f){n.pid&&(f.pid||(f.pid=n.pid),n["@"])||(u.say({dam:"?",pid:s.pid,"@":n["#"]},f),delete w.s[f.last])},u.hear.mob=function(n,f){if(n.peers){var l=Object.keys(n.peers),_=l[Math.random()*l.length>>0];_&&(u.bye(f),u.hi(_))}},i.on("create",function(n){n.opt.pid=n.opt.pid||String.random(9),this.to.next(n),n.on("out",u.say)}),i.on("bye",function(n,f){n=s.peers[n.id||n]||n,this.to.next(n),n.bye?n.bye():(f=n.wire)&&f.close&&f.close(),delete s.peers[n.id],n.wire=null}),i.on("bye",function(n,f){this.to.next(n),(f=console.STAT)&&(f.peers=u.near),(f=n.url)&&setTimeout(function(){},s.lack||9e3)}),i.on("hi",function(n,f){if(this.to.next(n),(f=console.STAT)&&(f.peers=u.near),!s.super){var l=Object.keys(i.next||"");l.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(l,function(_){var g=i.next[_];if(s.super||(g.ask||"")[""]){u.say({get:{"#":_}},n);return}setTimeout.each(Object.keys(g.ask||""),function(j){j&&u.say({"##":String.hash((i.graph[_]||"")[j]),get:{"#":_,".":j}},n)})})}}),u}var y;try{x.exports=p}catch{}})(m,"./mesh"),m(function(x){var t=m("./index");t.Mesh=m("./mesh"),t.on("opt",function(c){if(this.to.next(c),c.once)return;var p=c.opt;if(p.WebSocket===!1)return;var y=t.window||{},i=p.WebSocket||y.WebSocket||y.webkitWebSocket||y.mozWebSocket;if(!i)return;p.WebSocket=i;var u=p.mesh=p.mesh||t.Mesh(c);u.wire||p.wire,u.wire=p.wire=s;function s(h){try{if(!h||!h.url)return k&&k(h);var v=h.url.replace(/^http/,"ws"),k=h.wire=new p.WebSocket(v);return k.onclose=function(){w(h),p.mesh.bye(h)},k.onerror=function(a){w(h)},k.onopen=function(){p.mesh.hi(h)},k.onmessage=function(a){a&&p.mesh.hear(a.data||a,h)},k}catch{p.mesh.bye(h)}}setTimeout(function(){!p.super&&c.on("out",{dam:"hi"})},1);var d=2*999;function w(h){clearTimeout(h.defer),p.peers[h.url]&&(e&&h.retry<=0||(h.retry=(h.retry||p.retry+1||60)-(-h.tried+(h.tried=+new Date)<d*4?1:0),h.defer=setTimeout(function v(){if(e&&e.hidden)return setTimeout(v,d);s(h)},d)))}var e=""+o!=typeof document&&document});var o})(m,"./websocket"),m(function(x){if(!(typeof Gun>"u")){var t=function(){},o;try{o=(Gun.window||t).localStorage}catch{}o||(Gun.log("Warning: No localStorage exists to persist data to!"),o={setItem:function(p,y){this[p]=y},removeItem:function(p){delete this[p]},getItem:function(p){return this[p]}});var c=JSON.stringifyAsync||function(p,y,i,u){var s;try{y(s,JSON.stringify(p,i,u))}catch(d){y(d)}};Gun.on("create",function p(y){this.to.next(y);var i=y.opt;y.graph;var u=[],s,d,w,e;if(i.localStorage===!1)return;i.prefix=i.file||"gun/";try{s=p[i.prefix]=p[i.prefix]||JSON.parse(w=o.getItem(i.prefix))||{}}catch{s=p[i.prefix]={}}w=(w||"").length,y.on("get",function(v){this.to.next(v);var k=v.get,a,n,f,l;!k||!(a=k["#"])||(n=s[a]||l,n&&(f=k["."])&&!Object.plain(f)&&(n=Gun.state.ify({},f,Gun.state.is(n,f),n[f],a)),Gun.on.get.ack(v,n))}),y.on("put",function(v){this.to.next(v);var k=v.put,a=k["#"],n=k["."],f=v["#"],l=v.ok||"";if(s[a]=Gun.state.ify(s[a],n,k[">"],k[":"],a),e&&w>4999880){y.on("in",{"@":f,err:"localStorage max!"});return}!v["@"]&&(!v._.via||Math.random()<l["@"]/l["/"])&&u.push(f),!d&&(d=setTimeout(h,9+w/333))});function h(){if(!u.length&&((setTimeout.turn||"").s||"").length){setTimeout(h,99);return}var v=u;clearTimeout(d),d=!1,u=[],c(s,function(k,a){try{!k&&o.setItem(i.prefix,a)}catch(n){k=e=n||"localStorage failure"}k&&(Gun.log(k+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),y.on("localStorage:error",{err:k,get:i.prefix,put:s})),w=a.length,setTimeout.each(v,function(n){y.on("in",{"@":n,err:k,ok:0})},0,99)})}})}})(m,"./localStorage")})(),function(){var m;if(""+m!=typeof Gun){var G=function(r){console.warn("Warning! Deprecated internal utility will break in next version:",r)},x=Gun;x.fn=x.fn||{is:function(r){return G("fn"),!!r&&typeof r=="function"}},x.bi=x.bi||{is:function(r){return G("bi"),r instanceof Boolean||typeof r=="boolean"}},x.num=x.num||{is:function(r){return G("num"),!t(r)&&(r-parseFloat(r)+1>=0||r===1/0||r===-1/0)}},x.text=x.text||{is:function(r){return G("text"),typeof r=="string"}},x.text.ify=x.text.ify||function(r){return G("text.ify"),x.text.is(r)?r:typeof JSON<"u"?JSON.stringify(r):r&&r.toString?r.toString():r},x.text.random=x.text.random||function(r,b){G("text.random");var S="";for(r=r||24,b=b||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";r>0;)S+=b.charAt(Math.floor(Math.random()*b.length)),r--;return S},x.text.match=x.text.match||function(r,b){var S,A;return G("text.match"),typeof r!="string"?!1:(typeof b=="string"&&(b={"=":b}),b=b||{},S=b["="]||b["*"]||b[">"]||b["<"],r===S?!0:A!==b["="]?!1:(S=b["*"]||b[">"]||b["<"],r.slice(0,(S||"").length)===S?!0:A!==b["*"]?!1:A!==b[">"]&&A!==b["<"]?r>=b[">"]&&r<=b["<"]:A!==b[">"]&&r>=b[">"]||A!==b["<"]&&r<=b["<"]))},x.text.hash=x.text.hash||function(r,b){if(G("text.hash"),typeof r=="string"){if(b=b||0,!r.length)return b;for(var S=0,A=r.length,$;S<A;++S)$=r.charCodeAt(S),b=(b<<5)-b+$,b|=0;return b}},x.list=x.list||{is:function(r){return G("list"),r instanceof Array}},x.list.slit=x.list.slit||Array.prototype.slice,x.list.sort=x.list.sort||function(r){return G("list.sort"),function(b,S){return!b||!S?0:(b=b[r],S=S[r],b<S?-1:b>S?1:0)}},x.list.map=x.list.map||function(r,b,S){return G("list.map"),U(r,b,S)},x.list.index=1,x.obj=x.boj||{is:function(r){return G("obj"),r?r instanceof Object&&r.constructor===Object||Object.prototype.toString.call(r).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},x.obj.put=x.obj.put||function(r,b,S){return G("obj.put"),(r||{})[b]=S,r},x.obj.has=x.obj.has||function(r,b){return G("obj.has"),r&&Object.prototype.hasOwnProperty.call(r,b)},x.obj.del=x.obj.del||function(r,b){if(G("obj.del"),!!r)return r[b]=null,delete r[b],r},x.obj.as=x.obj.as||function(r,b,S,A){return G("obj.as"),r[b]=r[b]||(A===S?{}:S)},x.obj.ify=x.obj.ify||function(r){if(G("obj.ify"),l(r))return r;try{r=JSON.parse(r)}catch{r={}}return r},function(){var r;function b(S,A){g(this,A)&&r!==this[A]||(this[A]=S)}x.obj.to=x.obj.to||function(S,A){return G("obj.to"),A=A||{},U(S,b,A),A}}(),x.obj.copy=x.obj.copy||function(r){return G("obj.copy"),r&&JSON.parse(JSON.stringify(r))},function(){function r(b,S){var A=this.n,$;if(!(A&&(S===A||l(A)&&g(A,S)))&&$!==S)return!0}x.obj.empty=x.obj.empty||function(b,S){return G("obj.empty"),b?!U(b,r,{n:S}):!0}}(),function(){function r(A,$){if(arguments.length===2){r.r=r.r||{},r.r[A]=$;return}r.r=r.r||[],r.r.push(A)}var b=Object.keys,S;Object.keys=Object.keys||function(A){return S(A,function($,D,T){T(D)})},x.obj.map=S=x.obj.map||function(A,$,D){G("obj.map");var T,N=0,E,P,M,I,H=typeof $=="function";if(r.r=T,b&&l(A)&&(M=b(A),I=!0),D=D||{},t(A)||M)for(E=(M||A).length;N<E;N++){var K=N+x.list.index;if(H){if(P=I?$.call(D,A[M[N]],M[N],r):$.call(D,A[N],K,r),P!==T)return P}else if($===A[I?M[N]:N])return M?M[N]:K}else for(N in A)if(H){if(g(A,N)&&(P=D?$.call(D,A[N],N,r):$(A[N],N,r),P!==T))return P}else if($===A[N])return N;return H?r.r:x.list.index?0:-1}}(),x.time=x.time||{},x.time.is=x.time.is||function(r){return G("time"),r?r instanceof Date:+new Date().getTime()};var n=x.fn.is,t=x.list.is,f=x.obj,l=f.is,g=f.has,U=f.map,o={};o.is=function(r){return G("val.is"),r===m?!1:r===null?!0:r===1/0?!1:y(r)||p(r)||h(r)?!0:o.link.is(r)||!1},o.link=o.rel={_:"#"},function(){o.link.is=function(b){if(G("val.link.is"),b&&b[c]&&!b._&&l(b)){var S={};if(U(b,r,S),S.id)return S.id}return!1};function r(b,S){var A=this;if(A.id)return A.id=!1;if(S==c&&y(b))A.id=b;else return A.id=!1}}(),o.link.ify=function(r){return G("val.link.ify"),O({},c,r)},x.obj.has._=".";var c=o.link._,m,p=x.bi.is,h=x.num.is,y=x.text.is,f=x.obj,l=f.is,O=f.put,U=f.map;x.val=x.val||o;var i={_:"_"};i.soul=function(r,b){return G("node.soul"),r&&r._&&r._[b||d]},i.soul.ify=function(r,b){return G("node.soul.ify"),b=typeof b=="string"?{soul:b}:b||{},r=r||{},r._=r._||{},r._[d]=b.soul||r._[d]||s(),r},i.soul._=o.link._,function(){i.is=function(b,S,A){G("node.is");var $;return l(b)&&($=i.soul(b))?!U(b,r,{as:A,cb:S,s:$,n:b}):!1};function r(b,S){if(S!==i._){if(!o.is(b))return!0;this.cb&&this.cb.call(this.as,b,S,this.n,this.s)}}}(),function(){i.ify=function(b,S,A){return G("node.ify"),S?typeof S=="string"?S={soul:S}:typeof S=="function"&&(S={map:S}):S={},S.map&&(S.node=S.map.call(A,b,m,S.node||{})),(S.node=i.soul.ify(S.node||{},S))&&U(b,r,{o:S,as:A}),S.node};function r(b,S){var A=this.o,$,D;if(A.map){$=A.map.call(this.as,b,""+S,A.node),D===$?_(A.node,S):A.node&&(A.node[S]=$);return}o.is(b)&&(A.node[S]=b)}}();var f=x.obj,l=f.is,_=f.del,U=f.map,u=x.text,s=u.random,d=i.soul._,m;x.node=x.node||i;var w=x.state;w.lex=function(){return G("state.lex"),w().toString(36).replace(".","")},w.to=function(r,b,S){G("state.to");var A=(r||{})[b];return l(A)&&(A=C(A)),w.ify(S,b,w.is(r,b),A,i.soul(r))},function(){w.map=function(b,S,A){G("state.map");var $,D=l(D=b||S)?D:null;return b=n(b=b||S)?b:null,D&&!b?(S=h(S)?S:w(),D[k]=D[k]||{},U(D,r,{o:D,s:S}),D):(A=A||l(S)?S:$,S=h(S)?S:w(),function(T,N,E,P){if(!b)return r.call({o:E,s:S},T,N),T;b.call(A||this||{},T,N,E,P),!(g(E,N)&&$===E[N])&&r.call({o:E,s:S},T,N)})};function r(b,S){k!==S&&w.ify(this.o,S,this.s)}}();var f=x.obj;f.as;var g=f.has,l=f.is,U=f.map,C=f.copy,e=x.num,h=e.is,v=x.fn,n=v.is,k=i._,m,a={};(function(){a.is=function(S,A,$,D){return G("graph.is"),!S||!l(S)||j(S)?!1:!U(S,r,{cb:A,fn:$,as:D})};function r(S,A){if(!S||A!==i.soul(S)||!i.is(S,this.fn,this.as))return!0;this.cb&&(b.n=S,b.as=this.as,this.cb.call(b.as,S,A,b))}function b(S){S&&i.is(b.n,S,b.as)}})(),function(){a.ify=function(D,T,N){G("graph.ify");var E={path:[],obj:D};return T?typeof T=="string"?T={soul:T}:typeof T=="function"&&(T.map=T):T={},typeof N=="string"&&(T.soul=T.soul||N,N=m),T.soul&&(E.link=o.link.ify(T.soul)),T.shell=(N||{}).shell,T.graph=T.graph||{},T.seen=T.seen||[],T.as=T.as||N,r(T,E),T.root=E.node,T.graph};function r(D,T){var N;return(N=$(D,T))?N:(T.env=D,T.soul=S,i.ify(T.obj,b,T)&&(T.link=T.link||o.link.ify(i.soul(T.node)),T.obj!==D.shell&&(D.graph[o.link.is(T.link)]=T.node)),T)}function b(D,T,N){var E=this,P=E.env,M,I;if(i._===T&&g(D,o.link._))return N._;if(M=A(D,T,N,E,P)){if(T||(E.node=E.node||N||{},g(D,i._)&&i.soul(D)&&(E.node._=C(D._)),E.node=i.soul.ify(E.node,o.link.is(E.link)),E.link=E.link||o.link.ify(i.soul(E.node))),(I=P.map)&&(I.call(P.as||{},D,T,N,E),g(N,T))){if(D=N[T],m===D){_(N,T);return}if(!(M=A(D,T,N,E,P)))return}if(!T)return E.node;if(M===!0)return D;if(I=r(P,{obj:D,path:E.path.concat(T)}),!!I.node)return I.link}}function S(D){var T=this,N=o.link.is(T.link),E=T.env.graph;T.link=T.link||o.link.ify(D),T.link[o.link._]=D,T.node&&T.node[i._]&&(T.node[i._][o.link._]=D),g(E,N)&&(E[D]=E[N],_(E,N))}function A(D,T,N,E,P){var M;if(o.is(D))return!0;if(l(D))return 1;if(M=P.invalid)return D=M.call(P.as||{},D,T,N),A(D,T,N,E,P);P.err="Invalid value at '"+E.path.concat(T).join(".")+"'!",x.list.is(D)&&(P.err+=" Use `.set(item)` instead of an Array.")}function $(D,T){for(var N=D.seen,E=N.length,P;E--;)if(P=N[E],T.obj===P.obj)return P;N.push(T)}}(),a.node=function(r){G("graph.node");var b=i.soul(r);if(b)return O({},b,r)},function(){a.to=function(b,S,A){if(G("graph.to"),!!b){var $={};return A=A||{seen:{}},U(b[S],r,{obj:$,graph:b,opt:A}),$}};function r(b,S){var A,$;if(i._===S){if(j(b,o.link._))return;this.obj[S]=C(b);return}if(!(A=o.link.is(b))){this.obj[S]=b;return}if($=this.opt.seen[A]){this.obj[S]=$;return}this.obj[S]=this.opt.seen[A]=a.to(this.graph,A,this.opt)}}();var n=x.fn.is,f=x.obj,l=f.is,_=f.del,g=f.has,j=f.empty,O=f.put,U=f.map,C=f.copy,m;x.graph=x.graph||a}}()}(at);var Rt=at.exports,re=Rt;const oe=pe(re);var ut={exports:{}};ut.exports,function(J){(function(){function m(x,t){return t?Zt(x):x.slice?m[o(x)]:function(c,p){x(c={exports:{}}),m[o(p)]=c.exports};function o(c){return c.split("/").slice(-1).toString().replace(".js","")}}var G=J;m(function(x){typeof self<"u"&&(x.window=self),typeof window<"u"&&(x.window=window);var t=x.window||x,o,c=t.SEA||{};(c.window=x.window)&&(c.window.SEA=c);try{o+""!=typeof G&&(G.exports=c)}catch{}x.exports=c})(m,"./root"),m(function(x){var t=m("./root");try{t.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(m,"./https"),m(function(x){var t;if(t+""==typeof btoa){if(t+""==typeof Buffer)try{ft.Buffer=m("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}ft.btoa=function(o){return Buffer.from(o,"binary").toString("base64")},ft.atob=function(o){return Buffer.from(o,"base64").toString("binary")}}})(m,"./base64"),m(function(x){m("./base64");function t(){}Object.assign(t,{from:Array.from}),t.prototype=Object.create(Array.prototype),t.prototype.toString=function(o,c,p){o=o||"utf8",c=c||0;const y=this.length;if(o==="hex"){const i=new Uint8Array(this);return[...Array((p&&p+1||y)-c).keys()].map(u=>i[u+c].toString(16).padStart(2,"0")).join("")}if(o==="utf8")return Array.from({length:(p||y)-c},(i,u)=>String.fromCharCode(this[u+c])).join("");if(o==="base64")return btoa(this)},x.exports=t})(m,"./array"),m(function(x){m("./base64");var t=m("./array");function o(...c){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),o.from(...c)}o.prototype=Object.create(Array.prototype),Object.assign(o,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const c=arguments[0];let p;if(typeof c=="string"){const y=arguments[1]||"utf8";if(y==="hex"){const i=c.match(/([\da-fA-F]{2})/g).map(u=>parseInt(u,16));if(!i||!i.length)throw new TypeError("Invalid first argument for type 'hex'.");p=t.from(i)}else if(y==="utf8"||y==="binary"){const i=c.length,u=new Uint16Array(i);Array.from({length:i},(s,d)=>u[d]=c.charCodeAt(d)),p=t.from(u)}else if(y==="base64"){const i=atob(c),u=i.length,s=new Uint8Array(u);Array.from({length:u},(d,w)=>s[w]=i.charCodeAt(w)),p=t.from(s)}else y==="binary"?p=t.from(c):console.info("SafeBuffer.from unknown encoding: "+y);return p}if(c.byteLength,c.byteLength?c.byteLength:c.length){let y;return c instanceof ArrayBuffer&&(y=new Uint8Array(c)),t.from(y||c)}},alloc(c,p=0){return t.from(new Uint8Array(Array.from({length:c},()=>p)))},allocUnsafe(c){return t.from(new Uint8Array(Array.from({length:c})))},concat(c){if(!Array.isArray(c))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return t.from(c.reduce((p,y)=>p.concat(Array.from(y)),[]))}}),o.prototype.from=o.from,o.prototype.toString=t.prototype.toString,x.exports=o})(m,"./buffer"),m(function(x){const t=m("./root"),o={Buffer:m("./buffer")};var c={},p;if(JSON.parseAsync=JSON.parseAsync||function(i,u,s){var d;try{u(d,JSON.parse(i,s))}catch(w){u(w)}},JSON.stringifyAsync=JSON.stringifyAsync||function(i,u,s,d){var w;try{u(w,JSON.stringify(i,s,d))}catch(e){u(e)}},o.parse=function(i,u){return new Promise(function(s,d){JSON.parseAsync(i,function(w,e){w?d(w):s(e)},u)})},o.stringify=function(i,u,s){return new Promise(function(d,w){JSON.stringifyAsync(i,function(e,h){e?w(e):d(h)},u,s)})},t.window&&(o.crypto=t.window.crypto||t.window.msCrypto,o.subtle=(o.crypto||c).subtle||(o.crypto||c).webkitSubtle,o.TextEncoder=t.window.TextEncoder,o.TextDecoder=t.window.TextDecoder,o.random=i=>o.Buffer.from(o.crypto.getRandomValues(new Uint8Array(o.Buffer.alloc(i))))),!o.TextDecoder){const{TextEncoder:i,TextDecoder:u}=m((p+""==typeof G?".":"")+"./lib/text-encoding",1);o.TextDecoder=u,o.TextEncoder=i}if(!o.crypto)try{var y=m("crypto",1);Object.assign(o,{crypto:y,random:u=>o.Buffer.from(y.randomBytes(u))});const{Crypto:i}=m("@peculiar/webcrypto",1);o.ossl=o.subtle=new i({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}x.exports=o})(m,"./shim"),m(function(x){var t=m("./root"),o=m("./shim"),c={};c.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},c.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},c.ecdh={name:"ECDH",namedCurve:"P-256"},c.jwk=function(p,y){p=p.split(".");var i=p[0],u=p[1],s={kty:"EC",crv:"P-256",x:i,y:u,ext:!0};return s.key_ops=y?["sign"]:["verify"],y&&(s.d=y),s},c.keyToJwk=function(p){return{kty:"oct",k:p.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},c.recall={validity:12*60*60,hook:function(p){return p}},c.check=function(p){return typeof p=="string"&&p.slice(0,4)==="SEA{"},c.parse=async function(p){try{var y=typeof p=="string";return y&&p.slice(0,4)==="SEA{"&&(p=p.slice(3)),y?await o.parse(p):p}catch{}return p},t.opt=c,x.exports=c})(m,"./settings"),m(function(x){var t=m("./shim");x.exports=async function(o,c){var p=typeof o=="string"?o:await t.stringify(o),y=await t.subtle.digest({name:c||"SHA-256"},new t.TextEncoder().encode(p));return t.Buffer.from(y)}})(m,"./sha256"),m(function(x){const t=m("./shim"),o=t.subtle,c=t.ossl?t.ossl:o,p=y=>c.digest({name:"SHA-1"},new ArrayBuffer(y));x.exports=p})(m,"./sha1"),m(function(x){var t=m("./root"),o=m("./shim"),c=m("./settings"),p=m("./sha256"),y;t.work=t.work||(async(i,u,s,d)=>{try{var w=(u||{}).epub||u;if(d=d||{},w instanceof Function&&(s=w,w=y),i=typeof i=="string"?i:await o.stringify(i),(d.name||"").toLowerCase().slice(0,3)==="sha"){var e=o.Buffer.from(await p(i,d.name),"binary").toString(d.encode||"base64");if(s)try{s(e)}catch(a){console.log(a)}return e}w=w||o.random(9);var h=await(o.ossl||o.subtle).importKey("raw",new o.TextEncoder().encode(i),{name:d.name||"PBKDF2"},!1,["deriveBits"]),v=await(o.ossl||o.subtle).deriveBits({name:d.name||"PBKDF2",iterations:d.iterations||c.pbkdf2.iter,salt:new o.TextEncoder().encode(d.salt||w),hash:d.hash||c.pbkdf2.hash},h,d.length||c.pbkdf2.ks*8);i=o.random(i.length);var k=o.Buffer.from(v,"binary").toString(d.encode||"base64");if(s)try{s(k)}catch(a){console.log(a)}return k}catch(a){if(console.log(a),t.err=a,t.throw)throw a;s&&s();return}}),x.exports=t.work})(m,"./work"),m(function(x){var t=m("./root"),o=m("./shim");m("./settings"),t.name=t.name||(async(c,p)=>{try{if(c)try{c()}catch(y){console.log(y)}return}catch(y){if(console.log(y),t.err=y,t.throw)throw y;c&&c();return}}),t.pair=t.pair||(async(c,p)=>{try{var y=o.ossl||o.subtle,i=await o.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async d=>{var w={};w.priv=(await o.subtle.exportKey("jwk",d.privateKey)).d;var e=await o.subtle.exportKey("jwk",d.publicKey);return w.pub=e.x+"."+e.y,w});try{var u=await y.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async d=>{var w={};w.epriv=(await y.exportKey("jwk",d.privateKey)).d;var e=await y.exportKey("jwk",d.publicKey);return w.epub=e.x+"."+e.y,w})}catch(d){if(t.window)throw d;if(d=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw d}u=u||{};var s={pub:i.pub,priv:i.priv,epub:u.epub,epriv:u.epriv};if(c)try{c(s)}catch(d){console.log(d)}return s}catch(d){if(console.log(d),t.err=d,t.throw)throw d;c&&c();return}}),x.exports=t.pair})(m,"./pair"),m(function(x){var t=m("./root"),o=m("./shim"),c=m("./settings"),p=m("./sha256"),y;t.sign=t.sign||(async(i,u,s,d)=>{try{if(d=d||{},!(u||d).priv){if(!t.I)throw"No signing key.";u=await t.I(null,{what:i,how:"sign",why:d.why})}if(y===i)throw"`undefined` not allowed.";var w=await c.parse(i),e=d.check=d.check||w;if(t.verify&&(t.opt.check(e)||e&&e.s&&e.m)&&y!==await t.verify(e,u)){var f=await c.parse(e);if(d.raw||(f="SEA"+await o.stringify(f)),s)try{s(f)}catch(_){console.log(_)}return f}var h=u.pub,v=u.priv,k=c.jwk(h,v),a=await p(w),n=await(o.ossl||o.subtle).importKey("jwk",k,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(l=>(o.ossl||o.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},l,new Uint8Array(a))),f={m:w,s:o.Buffer.from(n,"binary").toString(d.encode||"base64")};if(d.raw||(f="SEA"+await o.stringify(f)),s)try{s(f)}catch(l){console.log(l)}return f}catch(l){if(console.log(l),t.err=l,t.throw)throw l;s&&s();return}}),x.exports=t.sign})(m,"./sign"),m(function(x){var t=m("./root"),o=m("./shim"),c=m("./settings"),p=m("./sha256"),y;t.verify=t.verify||(async(s,d,w,e)=>{try{var h=await c.parse(s);if(d===!1){var v=await c.parse(h.m);if(w)try{w(v)}catch(O){console.log(O)}return v}e=e||{};var k=d.pub||d,a=t.opt.slow_leak?await t.opt.slow_leak(k):await(o.ossl||o.subtle).importKey("jwk",c.jwk(k),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),n=await p(h.m),f,l,_,g;try{if(f=o.Buffer.from(h.s,e.encode||"base64"),l=new Uint8Array(f),_=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},a,l,new Uint8Array(n)),!_)throw"Signature did not match."}catch{if(t.opt.fallback)return await t.opt.fall_verify(s,d,w,e)}var j=_?await c.parse(h.m):y;if(w)try{w(j)}catch(O){console.log(O)}return j}catch(O){if(console.log(O),t.err=O,t.throw)throw O;w&&w();return}}),x.exports=t.verify;var i={};t.opt.slow_leak=s=>{if(i[s])return i[s];var d=c.jwk(s);return i[s]=(o.ossl||o.subtle).importKey("jwk",d,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),i[s]};var u=t.opt;t.opt.fall_verify=async function(s,d,w,e,h){if(h===t.opt.fallback)throw"Signature did not match";h=h||1;var v=s||"";s=t.opt.unpack(s)||s;var k=await c.parse(s),a=d.pub||d,n=await t.opt.slow_leak(a),f=h<=t.opt.fallback?o.Buffer.from(await o.subtle.digest({name:"SHA-256"},new o.TextEncoder().encode(await c.parse(k.m)))):await p(k.m),l,_,g;try{if(l=o.Buffer.from(k.s,e.encode||"base64"),_=new Uint8Array(l),g=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},n,_,new Uint8Array(f)),!g)throw"Signature did not match."}catch{try{l=o.Buffer.from(k.s,"utf8"),_=new Uint8Array(l),g=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},n,_,new Uint8Array(f))}catch{if(!g)throw"Signature did not match."}}var j=g?await c.parse(k.m):y;if(u.fall_soul=v["#"],u.fall_key=v["."],u.fall_val=s,u.fall_state=v[">"],w)try{w(j)}catch(O){console.log(O)}return j},t.opt.fallback=2})(m,"./verify"),m(function(x){var t=m("./shim"),o=m("./settings"),c=m("./sha256");const p=async(y,i,u)=>{const s=y+(i||t.random(8)).toString("utf8"),d=t.Buffer.from(await c(s),"binary"),w=o.keyToJwk(d);return await t.subtle.importKey("jwk",w,{name:"AES-GCM"},!1,["encrypt","decrypt"])};x.exports=p})(m,"./aeskey"),m(function(x){var t=m("./root"),o=m("./shim");m("./settings");var c=m("./aeskey"),p;t.encrypt=t.encrypt||(async(y,i,u,s)=>{try{s=s||{};var d=(i||s).epriv||i;if(p===y)throw"`undefined` not allowed.";if(!d){if(!t.I)throw"No encryption key.";i=await t.I(null,{what:y,how:"encrypt",why:s.why}),d=i.epriv||i}var w=typeof y=="string"?y:await o.stringify(y),e={s:o.random(9),iv:o.random(15)},h=await c(d,e.s,s).then(k=>o.subtle.encrypt({name:s.name||"AES-GCM",iv:new Uint8Array(e.iv)},k,new o.TextEncoder().encode(w))),v={ct:o.Buffer.from(h,"binary").toString(s.encode||"base64"),iv:e.iv.toString(s.encode||"base64"),s:e.s.toString(s.encode||"base64")};if(s.raw||(v="SEA"+await o.stringify(v)),u)try{u(v)}catch(k){console.log(k)}return v}catch(k){if(console.log(k),t.err=k,t.throw)throw k;u&&u();return}}),x.exports=t.encrypt})(m,"./encrypt"),m(function(x){var t=m("./root"),o=m("./shim"),c=m("./settings"),p=m("./aeskey");t.decrypt=t.decrypt||(async(y,i,u,s)=>{try{s=s||{};var d=(i||s).epriv||i;if(!d){if(!t.I)throw"No decryption key.";i=await t.I(null,{what:y,how:"decrypt",why:s.why}),d=i.epriv||i}var w=await c.parse(y),e,h,v;try{e=o.Buffer.from(w.s,s.encode||"base64"),h=o.Buffer.from(w.iv,s.encode||"base64"),v=o.Buffer.from(w.ct,s.encode||"base64");var k=await p(d,e,s).then(n=>o.subtle.decrypt({name:s.name||"AES-GCM",iv:new Uint8Array(h),tagLength:128},n,new Uint8Array(v)))}catch{if(s.encode==="utf8")throw"Could not decrypt";if(t.opt.fallback)return s.encode="utf8",await t.decrypt(y,i,u,s)}var a=await c.parse(new o.TextDecoder("utf8").decode(k));if(u)try{u(a)}catch(n){console.log(n)}return a}catch(n){if(console.log(n),t.err=n,t.throw)throw n;u&&u();return}}),x.exports=t.decrypt})(m,"./decrypt"),m(function(x){var t=m("./root"),o=m("./shim");m("./settings"),t.secret=t.secret||(async(p,y,i,u)=>{try{if(u=u||{},!y||!y.epriv||!y.epub){if(!t.I)throw"No secret mix.";y=await t.I(null,{what:p,how:"secret",why:u.why})}var s=p.epub||p,d=y.epub,w=y.epriv,e=o.ossl||o.subtle,h=c(s),v=Object.assign({public:await e.importKey(...h,!0,[])},{name:"ECDH",namedCurve:"P-256"}),k=c(d,w),a=await e.importKey(...k,!1,["deriveBits"]).then(async f=>{var l=await e.deriveBits(v,f,256),_=new Uint8Array(l),g=await e.importKey("raw",_,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return e.exportKey("jwk",g).then(({k:j})=>j)}),n=a;if(i)try{i(n)}catch(f){console.log(f)}return n}catch(f){if(console.log(f),t.err=f,t.throw)throw f;i&&i();return}});var c=(p,y)=>{var[i,u]=p.split("."),s=y?{d:y}:{};return["jwk",Object.assign(s,{x:i,y:u,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};x.exports=t.secret})(m,"./secret"),m(function(x){var t=m("./root");t.certify=t.certify||(async(o,c={},p,y,i={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),o=(()=>{var a=[];if(o){if((typeof o=="string"||Array.isArray(o))&&o.indexOf("*")>-1)return"*";if(typeof o=="string")return o;if(Array.isArray(o)){if(o.length===1&&o[0])return typeof o[0]=="object"&&o[0].pub?o[0].pub:typeof o[0]=="string"?o[0]:null;o.map(n=>{typeof n=="string"?a.push(n):typeof n=="object"&&n.pub&&a.push(n.pub)})}return typeof o=="object"&&o.pub?o.pub:a.length>0?a:null}})(),!o)return console.log("No certificant found.");const s=i.expiry&&(typeof i.expiry=="number"||typeof i.expiry=="string")?parseFloat(i.expiry):null,d=(c||{}).read?c.read:null,w=(c||{}).write?c.write:typeof c=="string"||Array.isArray(c)||c["+"]||c["#"]||c["."]||c["="]||c["*"]||c[">"]||c["<"]?c:null,e=(i||{}).block||(i||{}).blacklist||(i||{}).ban||{},h=e.read&&(typeof e.read=="string"||(e.read||{})["#"])?e.read:null,v=typeof e=="string"?e:e.write&&(typeof e.write=="string"||e.write["#"])?e.write:null;if(!d&&!w)return console.log("No policy found.");const k=JSON.stringify({c:o,...s?{e:s}:{},...d?{r:d}:{},...w?{w}:{},...h?{rb:h}:{},...v?{wb:v}:{}});var u=await t.sign(k,p,null,{raw:1});if(i.raw||(u="SEA"+JSON.stringify(u)),y)try{y(u)}catch(a){console.log(a)}return u}catch(s){if(t.err=s,t.throw)throw s;y&&y();return}}),x.exports=t.certify})(m,"./certify"),m(function(x){var t=m("./shim"),o=m("./root");o.work=m("./work"),o.sign=m("./sign"),o.verify=m("./verify"),o.encrypt=m("./encrypt"),o.decrypt=m("./decrypt"),o.certify=m("./certify"),o.random=o.random||t.random,o.Buffer=o.Buffer||m("./buffer"),o.keyid=o.keyid||(async c=>{try{const p=t.Buffer.concat(c.replace(/-/g,"+").replace(/_/g,"/").split(".").map(s=>t.Buffer.from(s,"base64"))),y=t.Buffer.concat([t.Buffer.from([153,p.length/256,p.length%256]),p]),i=await sha1hash(y),u=t.Buffer.from(i,"binary");return u.toString("hex",u.length-8)}catch(p){throw console.log(p),p}}),((o.window||{}).GUN||{}).SEA=o,x.exports=o})(m,"./sea"),m(function(x){var t=m("./sea"),o,c;t.window?o=t.window.GUN||{chain:{}}:o=m((c+""==typeof G?".":"")+"./gun",1),t.GUN=o;function p(i){this._={$:this}}p.prototype=function(){function i(){}return i.prototype=o.chain,new i}(),p.prototype.constructor=p,o.chain.user=function(i){var u=this,d=u.back(-1),s;if(i)return i=t.opt.pub((i._||"")["#"])||i,d.get("~"+i);if(s=d.back("user"))return s;var d=d._,w=d,e=w.opt.uuid||y;return(w=(s=w.user=u.chain(new p))._).opt={},w.opt.uuid=function(h){var v=e(),k=d.user;return!k||!(k=k.is)||!(k=k.pub)||(v="~"+k+"/"+v,h&&h.call&&h(null,v)),v},s};function y(){return o.state().toString(36).replace(".","")}o.User=p,p.GUN=o,p.SEA=o.SEA=t,x.exports=p})(m,"./user"),m(function(x){var t,o=""+t!=typeof GUN?GUN||{chain:{}}:m((""+t==typeof G?".":"")+"./gun",1);o.chain.then=function(c,p){var y=this,i=new Promise(function(u,s){y.once(u,p)});return c?i.then(c):i}})(m,"./then"),m(function(x){var t=m("./user"),o=t.SEA,c=t.GUN,p=function(){};t.prototype.create=function(...y){var i=typeof y[0]=="object"&&(y[0].pub||y[0].epub)?y[0]:typeof y[1]=="object"&&(y[1].pub||y[1].epub)?y[1]:null,u=i&&(i.pub||i.epub)?i.pub:typeof y[0]=="string"?y[0]:null,s=i&&(i.pub||i.epub)?i:u&&typeof y[1]=="string"?y[1]:null,d=y.filter(n=>typeof n=="function")[0]||null,w=y&&y.length>1&&typeof y[y.length-1]=="object"?y[y.length-1]:{},e=this,h=e._,v=e.back(-1);if(d=d||p,w=w||{},w.check!==!1){var k;if(u||(k="No user."),(s||"").length<8&&(k="Password too short!"),k)return d({err:c.log(k)}),e}if(h.ing)return(d||p)({err:c.log("User is already being created or authenticated!"),wait:!0}),e;h.ing=!0;var a={};return a.a=function(n){if(a.pubs=n,n&&!w.already){var f={err:c.log("User already created!")};h.ing=!1,(d||p)(f),e.leave();return}a.salt=String.random(64),o.work(s,a.salt,a.b)},a.b=function(n){a.proof=n,i?a.c(i):o.pair(a.c)},a.c=function(n){var f;a.pair=n||{},(f=h.root.user)&&(f._.sea=n,f.is={pub:n.pub,epub:n.epub,alias:u}),a.data={pub:n.pub},a.d()},a.d=function(){a.data.alias=u,a.e()},a.e=function(){a.data.epub=a.pair.epub,o.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},a.proof,a.f,{raw:1})},a.f=function(n){a.data.auth=JSON.stringify({ek:n,s:a.salt}),a.g(a.data.auth)},a.g=function(n){var f;a.data.auth=a.data.auth||n,v.get(f="~"+a.pair.pub).put(a.data).on(a.h);var l={};l[f]={"#":f},v.get("~@"+u).put(l).get(f).on(a.i)},a.h=function(n,f,l,_){_.off(),a.h.ok=1,a.i()},a.i=function(n,f,l,_){_&&(a.i.ok=1,_.off()),!(!a.h.ok||!a.i.ok)&&(h.ing=!1,d({ok:0,pub:a.pair.pub}),p===d&&(i?e.auth(i):e.auth(u,s)))},v.get("~@"+u).once(a.a),e},t.prototype.leave=function(y,i){var u=this,s=u.back(-1)._.user;if(s&&(delete s.is,delete s._.is,delete s._.sea),o.window)try{var d={};d=o.window.sessionStorage,delete d.recall,delete d.pair}catch{}return u}})(m,"./create"),m(function(x){var t=m("./user"),o=t.SEA,c=t.GUN,p=function(){};t.prototype.auth=function(...i){var u=typeof i[0]=="object"&&(i[0].pub||i[0].epub)?i[0]:typeof i[1]=="object"&&(i[1].pub||i[1].epub)?i[1]:null,s=!u&&typeof i[0]=="string"?i[0]:null,d=(s||u&&!(u.priv&&u.epriv))&&typeof i[1]=="string"?i[1]:null,w=i.filter(l=>typeof l=="function")[0]||null,e=i&&i.length>1&&typeof i[i.length-1]=="object"?i[i.length-1]:{},h=this,v=h._,k=h.back(-1);if(v.ing)return(w||p)({err:c.log("User is already being created or authenticated!"),wait:!0}),h;v.ing=!0;var a={},n,f=9;return a.a=function(l){if(!l)return a.b();if(!l.pub){var _=[];return Object.keys(l).forEach(function(g){g!="_"&&_.push(l[g])}),a.b(_)}if(a.name)return a.f(l);a.c((a.data=l).auth)},a.b=function(l){var _=(a.list=(a.list||[]).concat(l||[])).shift();if(n===_){if(a.name)return a.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(s&&f--){k.get("~@"+s).once(a.a);return}return a.err("Wrong user or password.")}k.get(_).once(a.a)},a.c=function(l){if(n===l)return a.b();if(typeof l=="string")return a.c(y(l));o.work(d,(a.auth=l).s,a.d,a.enc)},a.d=function(l){o.decrypt(a.auth.ek,l,a.e,a.enc)},a.e=function(l){if(n===l)return a.enc?(a.enc=null,a.b()):(a.enc={encode:"utf8"},a.c(a.auth));a.half=l,a.f(a.data)},a.f=function(l){var _=a.half||{},g=a.data||{};a.g(a.lol={pub:l.pub||g.pub,epub:l.epub||g.epub,priv:l.priv||_.priv,epriv:l.epriv||_.epriv})},a.g=function(l){if(!l||!l.pub||!l.epub)return a.b();a.pair=l;var _=k._.user,g=_._;g.tag;var j=g.opt;g=_._=k.get("~"+l.pub)._,g.opt=j,_.is={pub:l.pub,epub:l.epub,alias:s||l.pub},g.sea=a.pair,v.ing=!1;try{d&&n==(y(v.root.graph["~"+l.pub].auth)||"")[":"]&&(e.shuffle=e.change=d)}catch{}if(e.change?a.z():(w||p)(g),o.window&&(h.back("user")._.opt||e).remember)try{var O={};O=o.window.sessionStorage,O.recall=!0,O.pair=JSON.stringify(l)}catch{}try{k._.tag.auth?k._.on("auth",g):setTimeout(function(){k._.on("auth",g)},1)}catch(U){c.log("Your 'auth' callback crashed with:",U)}},a.h=function(l){if(!l)return a.b();if(s=l.alias,s||(s=l.alias="~"+u.pub),!l.auth)return a.g(u);u=null,a.c((a.data=l).auth)},a.z=function(){a.salt=String.random(64),o.work(e.change,a.salt,a.y)},a.y=function(l){o.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},l,a.x,{raw:1})},a.x=function(l){a.w(JSON.stringify({ek:l,s:a.salt}))},a.w=function(l){if(e.shuffle){console.log("migrate core account from UTF8 & shuffle");var _={};Object.keys(a.data).forEach(function(g){_[g]=a.data[g]}),delete _._,_.auth=l,k.get("~"+a.pair.pub).put(_)}k.get("~"+a.pair.pub).get("auth").put(l,w||p)},a.err=function(l){var _={err:c.log(l||"User cannot be found!")};v.ing=!1,(w||p)(_)},a.plugin=function(l){if(!(a.name=l))return a.err();var _=[l];l[0]!=="~"&&(_[1]="~"+l,_[2]="~@"+l),a.b(_)},u?u.priv&&u.epriv?a.g(u):k.get("~"+u.pub).once(a.h):s?k.get("~@"+s).once(a.a):!s&&!d&&o.name(a.plugin),h};function y(i){if(typeof i!="string")return i;try{i=JSON.parse(i)}catch{i={}}return i}})(m,"./auth"),m(function(x){var t=m("./user"),o=t.SEA;t.GUN,t.prototype.recall=function(c,p){var y=this,i=y.back(-1);if(c=c||{},c&&c.sessionStorage){if(o.window)try{var u={};u=o.window.sessionStorage,u&&(i._.opt.remember=!0,(y.back("user")._.opt||c).remember=!0,(u.recall||u.pair)&&i.user().auth(JSON.parse(u.pair),p))}catch{}return y}return y}})(m,"./recall"),m(function(x){var t=m("./user"),o=t.SEA,c=t.GUN,p=function(){};t.prototype.pair=function(){var y=this,i;try{i=new Proxy({DANGER:"\u2620"},{get:function(u,s,d){if(!(!y.is||!(y._||"").sea))return y._.sea[s]}})}catch{}return i},t.prototype.delete=async function(y,i,u){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var s=this;s.back(-1);var d=s.back("user");try{d.auth(y,i,function(w){var e=(d.is||{}).pub;d.map().once(function(){this.put(null)}),d.leave(),(u||p)({ok:0})})}catch(w){c.log("User.delete failed! Error:",w)}return s},t.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const y=this.back(-1);try{return await authRecall(y),y._.user._}catch{const i="No session!";throw c.log(i),{err:i}}},t.prototype.trust=async function(y){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),c.is(y)&&y.get("pub").get((i,u)=>{console.log(i,u)}),y.get("trust").get(path).put(theirPubkey)},t.prototype.grant=function(y,i){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,s=u.back(-1).user(),d=s._.sea,w="";return u.back(function(e){e.is||(w+=e.get||"")}),async function(){var e,h=await s.get("grant").get(d.pub).get(w).then();h=await o.decrypt(h,d),h||(h=o.random(16).toString(),e=await o.encrypt(h,d),s.get("grant").get(d.pub).get(w).put(e));var v=y.get("pub").then(),k=y.get("epub").then();v=await v,k=await k;var a=await o.secret(k,d);e=await o.encrypt(h,a),s.get("grant").get(v).get(w).put(e,i)}(),u},t.prototype.secret=function(y,i){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,s=u.back(-1).user(),d=s.pair(),w="";return u.back(function(e){e.is||(w+=e.get||"")}),async function(){var e,h=await s.get("trust").get(d.pub).get(w).then();h=await o.decrypt(h,d),h||(h=o.random(16).toString(),e=await o.encrypt(h,d),s.get("trust").get(d.pub).get(w).put(e)),e=await o.encrypt(y,h),u.put(e,i)}(),u},x.exports=t})(m,"./share"),m(function(x){var t=m("./sea"),o=m("./settings"),c,p=(t.window||"").GUN||m((""+c==typeof G?".":"")+"./gun",1);p.on("opt",function(e){e.sea||(e.sea={own:{}},e.on("put",y,e)),this.to.next(e)});function y(e){var h=this,v=h.as,k=e.put,a=k["#"],n=k["."],f=k[":"],l=k[">"],_=e["#"],g;if(!(!a||!n)){if((e._||"").faith&&(v.opt||"").faith&&typeof e._=="function"){t.opt.pack(k,function(O){t.verify(O,!1,function(U){k["="]=t.opt.unpack(U),h.to.next(e)})});return}var j=function(O){v.on("in",{"@":_,err:e.err=O})};if((e._||"").DBG&&((e._||"").DBG.c=+new Date),0<=a.indexOf("<?")&&(g=parseFloat(a.split("<?")[1]||""),g&&l<p.state()-g*1e3)){(g=e._)&&g.stun&&g.stun--;return}if(a==="~@"){y.alias(h,e,f,n,a,v,j);return}if(a.slice(0,2)==="~@"){y.pubs(h,e,f,n,a,v,j);return}if(g=t.opt.pub(a)){y.pub(h,e,f,n,a,v,j,v.user||"",g);return}if(0<=a.indexOf("#")){y.hash(h,e,f,n,a,v,j);return}y.any(h,e,f,n,a,v,j,v.user||"")}}y.hash=function(e,h,v,k,a,n,f){t.work(v,null,function(l){function _(g){let j="";for(let O=0;O<g.length;O++)j+=O-1&1?"":String.fromCharCode(parseInt(g.substring(O-1,O+1),16));return btoa(j)}if(l&&l===k.split("#").slice(-1)[0]||l&&l===_(k.split("#").slice(-1)[0]))return e.to.next(h);f("Data hash not same as hash!")},{name:"SHA-256"})},y.alias=function(e,h,v,k,a,n,f){if(!v)return f("Data must exist!");if("~@"+k===u(v))return e.to.next(h);f("Alias not same!")},y.pubs=function(e,h,v,k,a,n,f){if(!v)return f("Alias must exist!");if(k===u(v))return e.to.next(h);f("Alias not same!")},y.pub=async function(e,h,v,k,a,n,f,l,_){var g;const j=await o.parse(v)||{},O=(U,C,B)=>{if(U.m&&U.s&&C&&_)return t.verify(U,_,r=>{if(c!==r&&c!==r.e&&h.put[">"]&&h.put[">"]>parseFloat(r.e))return f("Certificate expired.");if(c!==r&&r.c&&r.w&&(r.c===C||r.c.indexOf("*")>-1)){let S=a.indexOf("/")>-1?a.replace(a.substring(0,a.indexOf("/")+1),""):"";String.match=String.match||p.text.match;const A=Array.isArray(r.w)?r.w:typeof r.w=="object"||typeof r.w=="string"?[r.w]:[];for(const $ of A)if(String.match(S,$["#"])&&String.match(k,$["."])||!$["."]&&String.match(S,$["#"])||!$["#"]&&String.match(k,$["."])||String.match(S?S+"/"+k:k,$["#"]||$)){if($["+"]&&$["+"].indexOf("*")>-1&&S&&S.indexOf(C)==-1&&k.indexOf(C)==-1)return f(`Path "${S}" or key "${k}" must contain string "${C}".`);if(r.wb&&(typeof r.wb=="string"||(r.wb||{})["#"])){var b=e.as.root.$.back(-1);return typeof r.wb=="string"&&r.wb.slice(0,1)!=="~"&&(b=b.get("~"+_)),b.get(r.wb).get(C).once(D=>D&&(D===1||D===!0)?f(`Certificant ${C} blocked.`):B(r))}return B(r)}return f("Certificate verification fail.")}})};if(k==="pub"&&"~"+_===a)return v===_?e.to.next(h):f("Account not same!");if((g=l.is)&&g.pub&&!j["*"]&&!j["+"]&&(_===g.pub||_!==g.pub&&((h._.msg||{}).opt||{}).cert)){t.opt.pack(h.put,U=>{t.sign(U,l._.sea,async function(C){if(c===C)return f(t.err||"Signature fail.");if(h.put[":"]={":":g=t.opt.unpack(C.m),"~":C.s},h.put["="]=g,_===l.is.pub){(g=u(v))&&((n.sea.own[g]=n.sea.own[g]||{})[_]=1),JSON.stringifyAsync(h.put[":"],function(B,r){return B?f(B||"Stringify error."):(h.put[":"]=r,e.to.next(h))});return}if(_!==l.is.pub&&((h._.msg||{}).opt||{}).cert){const B=await o.parse(h._.msg.opt.cert);B&&B.m&&B.s&&O(B,l.is.pub,r=>{h.put[":"]["+"]=B,h.put[":"]["*"]=l.is.pub,JSON.stringifyAsync(h.put[":"],function(b,S){return b?f(b||"Stringify error."):(h.put[":"]=S,e.to.next(h))})})}},{raw:1})});return}t.opt.pack(h.put,U=>{t.verify(U,j["*"]||_,function(C){var B;if(C=t.opt.unpack(C),c===C)return f("Unverified data.");if((B=u(C))&&_===t.opt.pub(B)&&((n.sea.own[B]=n.sea.own[B]||{})[_]=1),j["+"]&&j["+"].m&&j["+"].s&&j["*"])O(j["+"],j["*"],r=>(h.put["="]=C,e.to.next(h)));else return h.put["="]=C,e.to.next(h)})})},y.any=function(e,h,v,k,a,n,f,l){if(n.opt.secure)return f("Soul missing public key at '"+k+"'.");n.on("secure",function(_){if(this.off(),!n.opt.secure)return e.to.next(_);f("Data cannot be changed.")}).on.on("secure",h)};var i=p.valid,u=function(e,h){return typeof(h=i(e))=="string"&&h};(p.state||"").ify;var s=/[^\w_-]/;t.opt.pub=function(e){if(e&&(e=e.split("~"),!(!e||!(e=e[1]))&&(e=e.split(s).slice(0,2),!(!e||e.length!=2)&&(e[0]||"")[0]!=="@")))return e=e.slice(0,2).join("."),e},t.opt.stringy=function(e){},t.opt.pack=function(e,h,v,k,a){var n,f;if(t.opt.check(e))return h(e);e&&e["#"]&&e["."]&&e[">"]&&(n=e[":"],f=1),JSON.parseAsync(f?n:e,function(l,_){var g=c!==(_||"")[":"]&&(_||"")["~"];if(!g){h(e);return}h({m:{"#":a||e["#"],".":v||e["."],":":(_||"")[":"],">":e[">"]||p.state.is(k,v)},s:g})})};var d=t.opt;t.opt.unpack=function(e,h,v){var k;if(c!==e){if(e&&c!==(k=e[":"]))return k;if(h=h||d.fall_key,!v&&d.fall_val&&(v={},v[h]=d.fall_val),!(!h||!v)){if(e===v[h]||!t.opt.check(v[h]))return e;var a=v&&v._&&v._["#"]||d.fall_soul,n=p.state.is(v,h)||d.fall_state;if(e&&e.length===4&&a===e[0]&&h===e[1]&&w(n)===w(e[3]))return e[2];if(n<t.opt.shuffle_attack)return e}}},t.opt.shuffle_attack=15463296e5;var w=Math.floor})(m,"./index")})()}(ut),ut.exports;var ie=typeof window<"u"?window.Gun:Rt;const Ft="#",L="_";ie.chain.unset=function(J){return this&&J&&J[L]&&J[L].put&&J[L].put[L]&&J[L].put[L][Ft]&&this.put({[J[L].put[L][Ft]]:null}),this},F=oe(["http://localhost:3000/gun"]),F.clear=function(){localStorage.clear(),sessionStorage.clear(),indexedDB.databases().then(J=>{for(let m of J)indexedDB.deleteDatabase(m.name)}),console.log("Local data cleared")},F.lookup=async function(J,m){var o;const G=await F.get(J).get(m).then(),x=((o=G==null?void 0:G._)==null?void 0:o[">"])&&Object.keys(G._[">"])[0];if(!x)return null;const t=await F.get(x).then();return t?{id:m,...t}:null};const{ref:ae,inject:ue,provide:se,computed:ye,onMounted:ce,onUnmounted:fe}=await R("vue");ee=function(J){const m=ae([]),G=async t=>{const o=crypto.randomUUID(),c=Object.fromEntries(t.entries());c.id=o,m.value.push(c);const p=F.get(`link-plugin/${o}`).put(c);return F.get("links").get(J).set(p),p},x=async t=>{const o=F.get(`link-plugin/${t}`);o.then(()=>{F.get("links").get(J).unset(o)}),m.value=m.value.filter(c=>c.id!==t)};ce(()=>{F.get("links").get(J).map().once(t=>{t&&(m.value.some(o=>o.href===t.href)||m.value.push(t))})}),fe(()=>{F.get("links").get(J).map().off()}),se("link",{links:m,createLink:G,removeLink:x})},ht=function(){const J=ue("link");if(!J)throw new Error("Composable must have an link provider.");return J};let Lt,Y,Q,V,Wt,st,qt,Vt,zt,Yt,ct;({defineComponent:Lt}=await R("vue")),{createTextVNode:Y,withCtx:Q,createVNode:V,toDisplayString:Wt,openBlock:st,createBlock:qt,createCommentVNode:Vt,withModifiers:zt,createElementBlock:Yt}=await R("vue"),{ref:ct}=await R("vue"),te=Lt({__name:"LinkForm",setup(J){const{links:m,createLink:G}=ht(),x=ct(null),t=ct(""),o=async()=>{var c;try{if(t.value.length)return;const p=new FormData(x.value??void 0),y=await G(p);(c=x.value)==null||c.reset()}catch(p){console.error(p),t.value=p.response.data}};return(c,p)=>(st(),Yt("form",{ref_key:"form",ref:x,onSubmit:zt(o,["prevent"]),class:"space-y-2"},[V(lt,null,{default:Q(()=>p[0]||(p[0]=[Y(" Add a link ")])),_:1}),t.value?(st(),qt(Kt,{key:0,color:"red"},{default:Q(()=>[Y(Wt(t.value),1)]),_:1})):Vt("",!0),V(nt,{name:"href",placeholder:"Write your link here ..."}),V(nt,{name:"title",placeholder:"Give it a title (optional)"}),V(pt,{className:"w-full mt-4"},{default:Q(()=>p[1]||(p[1]=[Y(" Submit ")])),_:1})],544))}})});export{lt as _,he as __tla,te as a,pt as b,F as g,ee as l,ht as u};
