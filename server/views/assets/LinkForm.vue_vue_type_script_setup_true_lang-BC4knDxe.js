import{importShared as F,__tla as pe}from"./__federation_fn_import-ofDdBDNE.js";let lt,te,pt,V,ee,ht,he=Promise.all([(()=>{try{return pe}catch{}})()]).then(async()=>{let yt,dt,gt,bt,vt,wt,mt,tt,et,ne,kt,_t,St,xt,At,Ot,jt,Tt,Dt,$t,Bt,Ct,nt,Nt,Ut,rt,ot,Et,it,Gt,Pt,Jt,Mt,Ht,It,Kt;({defineComponent:yt}=await F("vue")),{renderSlot:dt,normalizeClass:gt,openBlock:bt,createElementBlock:vt}=await F("vue"),lt=yt({__name:"Title",props:{float:{type:String,default:"left",required:!1}},setup(P){return(w,G)=>(bt(),vt("h3",{class:gt(`my-auto text-${P.float} text-lg text-gray-800 dark:text-gray-100 font-semibold`)},[dt(w.$slots,"default")],2))}}),{createTextVNode:wt,Fragment:mt,openBlock:tt,createElementBlock:et,createCommentVNode:ne,renderSlot:kt,normalizeClass:_t}=await F("vue"),St=["disabled"],{ref:xt,computed:At,watch:Ot}=await F("vue"),pt={__name:"SubmitButton",props:{className:{type:String,default:""}},setup(P){const w=P,G=xt(!1),x=()=>{G.value=!0,setTimeout(()=>{G.value=!1},2e3)};Ot(G,o=>{o&&x()});const t=At(()=>`inline-flex justify-center px-4 py-2 text-sm font-medium border border-blue-600 dark:border-blue-400 text-blue-600 dark:text-blue-400 bg-transparent rounded-lg shadow-sm hover:bg-blue-50 dark:hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 ${w.className}
`);return(o,c)=>(tt(),et("button",{type:"submit",disabled:G.value,class:_t(t.value)},[G.value?(tt(),et(mt,{key:0},[wt(" Sending ... ")],64)):kt(o.$slots,"default",{key:1})],10,St))}},{defineComponent:jt}=await F("vue"),{createElementVNode:Tt,openBlock:Dt,createElementBlock:$t}=await F("vue"),Bt={class:"relative w-full flex items-center min-w-[100px] outline-none rounded-md transition duration-100 border bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-white border-gray-300 dark:border-gray-600"},Ct=["id","type","name","placeholder","disabled","value"],nt=jt({__name:"TextInput",props:{id:{type:String,required:!1},type:{type:String,default:"text"},name:{type:String,required:!1},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(P,{emit:w}){return(G,x)=>(Dt(),$t("div",Bt,[Tt("input",{id:P.id,type:P.type,name:P.name,placeholder:P.placeholder,disabled:P.disabled,value:P.modelValue,onInput:x[0]||(x[0]=t=>G.$emit("update:modelValue",t.target.value)),class:"w-full bg-transparent focus:outline-none focus:ring-0 border-none text-sm rounded-lg transition duration-100 py-2 text-gray-900 dark:text-white pr-3 pl-3 placeholder-gray-400 dark:placeholder-gray-500 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"},null,40,Ct)]))}}),{defineComponent:Nt}=await F("vue"),{toDisplayString:Ut,openBlock:rt,createElementBlock:ot,createCommentVNode:Et,createElementVNode:it,renderSlot:Gt,normalizeClass:Pt}=await F("vue"),Jt={class:"flex items-start"},Mt={key:0,class:"font-semibold"},Ht={class:"overflow-y-auto text-xs"},{computed:It}=await F("vue"),Kt=Nt({__name:"Callout",props:{title:{type:String,required:!1},color:{type:String,default:"red",validator:P=>["red","green"].includes(P)}},setup(P){const w=P,G=It(()=>{const x="flex flex-col overflow-hidden rounded-lg border-l-4 p-4 mb-2 opacity-75",t=w.color==="red"?"bg-red-100 border-red-500 text-red-700":"bg-green-100 border-green-500 text-green-700";return`${x} ${t}`});return(x,t)=>(rt(),ot("div",{class:Pt(G.value)},[it("div",Jt,[P.title?(rt(),ot("h4",Mt,Ut(P.title),1)):Et("",!0)]),it("p",Ht,[Gt(x.$slots,"default")])],2))}});var at=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function re(P){return P&&P.__esModule&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P}function Ft(P){throw new Error('Could not dynamically require "'+P+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ut={exports:{}};ut.exports,function(P){(function(){function w(x,t){return t?Ft(x):x.slice?w[o(x)]:function(c,h){x(c={exports:{}}),w[o(h)]=c.exports};function o(c){return c.split("/").slice(-1).toString().replace(".js","")}}var G=P;w(function(x){String.random=function(o,c){var h="";for(o=o||24,c=c||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";o-- >0;)h+=c.charAt(Math.floor(Math.random()*c.length));return h},String.match=function(o,c){var h,y;return typeof o!="string"?!1:(typeof c=="string"&&(c={"=":c}),c=c||{},h=c["="]||c["*"]||c[">"]||c["<"],o===h?!0:y!==c["="]?!1:(h=c["*"]||c[">"],o.slice(0,(h||"").length)===h?!0:y!==c["*"]?!1:y!==c[">"]&&y!==c["<"]?o>=c[">"]&&o<=c["<"]:y!==c[">"]&&o>=c[">"]||y!==c["<"]&&o<=c["<"]))},String.hash=function(o,c){if(typeof o=="string"){if(c=c||0,!o.length)return c;for(var h=0,y=o.length,i;h<y;++h)i=o.charCodeAt(h),c=(c<<5)-c+i,c|=0;return c}};var t=Object.prototype.hasOwnProperty;Object.plain=function(o){return o?o instanceof Object&&o.constructor===Object||Object.prototype.toString.call(o).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(o,c){for(var h in o)if(t.call(o,h)&&(!c||c.indexOf(h)==-1))return!1;return!0},Object.keys=Object.keys||function(o){var c=[];for(var h in o)t.call(o,h)&&c.push(h);return c},function(){var o,c=setTimeout,h=0,y=0,i=typeof setImmediate!=""+o&&setImmediate||function(s,d){return typeof MessageChannel==""+o?c:((s=new MessageChannel).port1.onmessage=function(m){m.data==""&&d()},function(m){d=m,s.port2.postMessage("")})}(),u=c.check=c.check||typeof performance!=""+o&&performance||{now:function(){return+new Date}};c.hold=c.hold||9,c.poll=c.poll||function(s){if(c.hold>=u.now()-h&&y++<3333){s();return}i(function(){h=u.now(),s()},y=0)}}(),function(){var o=setTimeout,c=o.turn=o.turn||function(d){h.push(d)==1&&y(s)},h=c.s=[],y=o.poll,i=0,u,s=function(){(u=h[i++])&&u(),(i==h.length||i==99)&&(h=c.s=h.slice(i),i=0),h.length&&y(s)}}(),function(){var o,c=setTimeout,h=c.turn;(c.each=c.each||function(y,i,u,s){s=s||9,function d(m,e,p){if(e=(m=(y||[]).splice(0,s)).length){for(var b=0;b<e&&o===(p=i(m[b]));b++);if(o===p){h(d);return}}u&&u(p)}()})()}()})(w,"./shim"),w(function(x){x.exports=function t(u,c,h){if(!u)return{to:t};var y,i=typeof c=="function",u=(this.tag||(this.tag={}))[u]||i&&(this.tag[u]={tag:u,to:t._={next:function(d){var m;(m=this.to)&&m.next(d)}}});if(i){var s={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:c,the:u,on:this,as:h};return(s.back=u.last||u).to=s,u.last=s}return(u=u.to)&&y!==c&&u.next(c),u}})(w,"./onto"),w(function(x){x.exports=function(t){return t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"&&t!=1/0&&t!=-1/0&&t===t||!!t&&typeof t["#"]=="string"&&Object.keys(t).length===1&&t["#"]}})(w,"./valid"),w(function(x){w("./shim");function t(){var u=+new Date;return y<u?(c=0,y=u+t.drift):y=u+(c+=1)/h+t.drift}t.drift=0;var o=-1/0,c=0,h=999,y=o,i;t.is=function(u,s,d){var m=s&&u&&u._&&u._[">"]||d;if(m)return typeof(m=m[s])=="number"?m:o},t.ify=function(u,s,d,m,e){(u=u||{})._=u._||{},e&&(u._["#"]=e);var p=u._[">"]||(u._[">"]={});return i!==s&&s!=="_"&&(typeof d=="number"&&(p[s]=d),i!==m&&(u[s]=m)),u},x.exports=t})(w,"./state"),w(function(x){w("./shim");function t(o){var c={s:{}},h=c.s;o=o||{max:999,age:1e3*9},c.check=function(i){return h[i]?y(i):!1};var y=c.track=function(i){var u=h[i]||(h[i]={});return u.was=c.now=+new Date,c.to||(c.to=setTimeout(c.drop,o.age+9)),y.ed&&y.ed(i),u};return c.drop=function(i){c.to=null,c.now=+new Date;var u=Object.keys(h);console.STAT&&console.STAT(c.now,+new Date-c.now,"dup drop keys"),setTimeout.each(u,function(s){var d=h[s];d&&(i||o.age)>c.now-d.was||delete h[s]},0,99)},c}x.exports=t})(w,"./dup"),w(function(x){w("./onto"),x.exports=function(o,c){if(this.on){var h=(this.opt||{}).lack||9e3;if(typeof o!="function"){if(!o)return;var i=o["#"]||o,y=(this.tag||"")[i];return y?(c&&(y=this.on(i,c),clearTimeout(y.err),y.err=setTimeout(function(){y.off()},h)),!0):void 0}var i=c&&c["#"]||t(9);if(!o)return i;var u=this.on(i,o,c);return u.err=u.err||setTimeout(function(){u.off(),u.next({err:"Error: No ACK yet.",lack:!0})},h),i}};var t=String.random||function(){return Math.random().toString(36).slice(2)}})(w,"./ask"),w(function(x){function t(e){return e instanceof t?(this._={$:this}).$:this instanceof t?t.create(this._={$:this,opt:e}):new t(e)}t.is=function(e){return e instanceof t||e&&e._&&e===e._.$||!1},t.version=.202,t.chain=t.prototype,t.chain.toJSON=function(){},w("./shim"),t.valid=w("./valid"),t.state=w("./state"),t.on=w("./onto"),t.dup=w("./dup"),t.ask=w("./ask"),function(){t.create=function(r){r.root=r.root||r,r.graph=r.graph||{},r.on=r.on||t.on,r.ask=r.ask||t.ask,r.dup=r.dup||t.dup();var v=r.$.opt(r.opt);return r.once||(r.on("in",e,r),r.on("out",e,r),r.on("put",k,r),t.on("create",r),r.on("create",r)),r.once=1,v};function e(r){if(r){if(r.out===e){this.to.next(r);return}var v=this,_=v.as,A=_.at||_,$=A.$,D=A.dup,T,N=r.DBG;if((T=r["#"])||(T=r["#"]=c(9)),!D.check(T)){if(D.track(T),T=r._,r._=typeof T=="function"?T:function(){},r.$&&r.$===(r.$._||"").$||(r.$=$),r["@"]&&!r.put&&n(r),!A.ask(r["@"],r))if(N&&(N.u=+new Date),r.put){p(r);return}else r.get&&t.on.get(r,$);N&&(N.uc=+new Date),v.to.next(r),N&&(N.ua=+new Date),!(r.nts||r.NTS)&&(r.out=e,A.on("out",r),N&&(N.ue=+new Date))}}}function p(r){if(r){var v=r._||"",_=v.root=((v.$=r.$||"")._||"").root;if(r["@"]&&v.faith&&!v.miss){r.out=e,_.on("out",r);return}v.latch=_.hatch,v.match=_.hatch=[];var A=r.put,$=v.DBG=r.DBG,D=+new Date;if(C=C||D,!(A["#"]&&A["."])){$&&($.p=D),v["#"]=r["#"],v.msg=r,v.all=0,v.stun=1;var T=Object.keys(A);console.STAT&&console.STAT(D,(($||v).pk=+new Date)-D,"put sort");var N=0,E,J,M,H,I,K,z;(function L(X){if(E!=N){if(E=N,!(M=T[N])){console.STAT&&console.STAT(D,(($||v).pd=+new Date)-D,"put"),a(v);return}(H=A[M])?(z=H._)?M!==z["#"]?K=l+S(M)+"soul not same.":(I=z[">"])||(K=l+S(M)+"no state."):K=l+S(M)+"no meta.":K=l+S(M)+"no node.",J=Object.keys(H||{})}if(K){r.err=v.err=K,a(v);return}var Xt=0,W;for(X=X||0;X++<9&&(W=J[Xt++]);)if(W!=="_"){var Z=H[W],Zt=I[W];if(s===Zt){K=l+S(W)+"on"+S(M)+"no state.";break}if(!y(Z)){K=l+S(W)+"on"+S(M)+"bad "+typeof Z+S(Z);break}b(Z,W,M,Zt,r),++U}if((J=J.slice(Xt)).length){h(L);return}++N,J=null,L(X)})()}}}t.on.put=p;function b(r,v,_,A,$){var D=$._||"",T=D.root,N=T.graph,E,J=N[_]||d,M=i(J,v,1),H=J[v],I=D.DBG;(E=console.STAT)&&(!N[_]||!H)&&(E.has=(E.has||0)+1);var K=j();if(A>K){setTimeout(function(){b(r,v,_,A,$)},(E=A-K)>O?O:E),console.STAT&&console.STAT((I||D).Hf=+new Date,E,"future");return}if(!(A<M)&&!(!D.faith&&A===M&&(r===H||g(r)<=g(H))&&!D.miss)){D.stun++;var z=$["#"]+D.all++,L={toString:function(){return z},_:D};L.toJSON=L.toString,T.dup.track(L)["#"]=$["#"],I&&(I.ph=I.ph||+new Date),T.on("put",{"#":L,"@":$["@"],put:{"#":_,".":v,":":r,">":A},ok:$.ok,_:D})}}function k(r){var v;(v=(r._||"").DBG)&&(v.pa=+new Date,v.pm=v.pm||+new Date);var _=this,A=_.as,$=A.graph,D=r._,T=r.put,N=T["#"],E=T["."],J=T[":"],M=T[">"];r["#"];var H;(H=D.msg)&&(H=H.put)&&(H=H[N])&&u(H,E,M,J,N),$[N]=u($[N],E,M,J,N),(H=(A.next||"")[N])&&H.on("in",r),a(D),_.to.next(r)}function a(r,v){var _;if(!r.stop&&!(!r.err&&0<--r.stun)&&(r.stop=1,!!(_=r.root))){var A=r.match;A.end=1,A===_.hatch&&(!(A=r.latch)||A.end?delete _.hatch:_.hatch=A),r.hatch&&r.hatch(),setTimeout.each(r.match,function($){$&&$()}),!(!(v=r.msg)||r.err||v.err)&&(v.out=e,r.root.on("out",v),B())}}function n(r){var v=r["@"]||"",_;if(!(_=v._)){var A=(A=r.$)&&(A=A._)&&(A=A.root)&&(A=A.dup);if(!(A=A.check(v)))return;r["@"]=A["#"]||r["@"];return}_.acks=(_.acks||0)+1,(_.err=r.err)&&(r["@"]=_["#"],a(_)),_.ok=r.ok||_.ok,!_.stop&&!_.crack&&(_.crack=_.match&&_.match.push(function(){f(_)})),f(_)}function f(r){!r||!r.root||r.stun||r.acks!==r.all||r.root.on("in",{"@":r["#"],err:r.err,ok:r.err?s:r.ok||{"":1}})}var l="Error: Invalid graph!",S=function(r){return" '"+(""+r).slice(0,9)+"...' "},g=JSON.stringify,O=2147483647,j=t.state,U=0,C,B=function(){U>999&&U/-(C-(C=+new Date))>1&&(t.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),B=function(){U=0})}}(),function(){t.on.get=function(p,b){var k=b._,a=p.get,n=a["#"],f=k.graph[n],l=a["."],S=k.next||(k.next={}),g=S[n],O=p._||{},j=O.DBG=p.DBG;if(j&&(j.g=+new Date),!f)return k.on("get",p);if(l){if((typeof l!="string"||s===f[l])&&!((g||"").next||"")[l]){k.on("get",p);return}f=u({},l,i(f,l),f[l],n)}f&&e(p,f),k.on("get",p)};function e(p,b){var k=+new Date,a=p._||{},n=a.DBG=p.DBG,f=p["#"],l=c(9),S=Object.keys(b||"").sort(),g=((b||"")._||"")["#"];S.length;var O=p.$._.root,j=b===O.graph[g];console.STAT&&console.STAT(k,((n||a).gk=+new Date)-k,"got keys"),b&&function U(){k=+new Date;for(var C=0,B,r={},v;C<9&&(B=S[C++]);)u(r,B,i(b,B),b[B],g);S=S.slice(C),(v={})[g]=r,r=v;var _;j&&(_=function(){},_.ram=_.faith=!0),v=S.length,console.STAT&&console.STAT(k,-(k-(k=+new Date)),"got copied some"),n&&(n.ga=+new Date),O.on("in",{"@":f,"#":l,put:r,"%":v?l=c(9):s,$:O.$,_,DBG:n,FOO:1}),console.STAT&&console.STAT(k,+new Date-k,"got in"),v&&setTimeout.turn(U)}(),b||O.on("in",{"@":p["#"]})}t.on.get.ack=e}(),function(){t.chain.opt=function(e){e=e||{};var p=this,b=p._,k=e.peers||e;return Object.plain(e)||(e={}),Object.plain(b.opt)||(b.opt=e),typeof k=="string"&&(k=[k]),Object.plain(b.opt.peers)||(b.opt.peers={}),k instanceof Array&&(e.peers={},k.forEach(function(a){var n={};n.id=n.url=a,e.peers[a]=b.opt.peers[a]=b.opt.peers[a]||n})),o(e,function a(n){var f=this[n];if(this&&this.hasOwnProperty(n)||typeof f=="string"||Object.empty(f)){this[n]=f;return}f&&f.constructor!==Object&&!(f instanceof Array)||o(f,a)}),b.opt.from=e,t.on("opt",b),b.opt.uuid=b.opt.uuid||function(a){return t.state().toString(36).replace(".","")+String.random(a||12)},p}}();var o=function(e,p){Object.keys(e).forEach(p,e)},c=String.random,h=setTimeout.turn,y=t.valid,i=t.state.is,u=t.state.ify,s,d={},m;t.log=function(){return!t.log.off&&m.log.apply(m,arguments),[].slice.call(arguments).join(" ")},t.log.once=function(e,p,b){return(b=t.log.once)[e]=b[e]||0,b[e]++||t.log(p)},typeof window<"u"&&((window.GUN=window.Gun=t).window=window);try{typeof G<"u"&&(G.exports=t)}catch{}x.exports=t,(t.window||{}).console=(t.window||{}).console||{log:function(){}},(m=console).only=function(e,p){return m.only.i&&e===m.only.i&&m.only.i++&&(m.log.apply(m,arguments)||p)},t.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(w,"./root"),w(function(x){var t=w("./root");t.chain.back=function(h,y){var i;if(h=h||1,h===-1||h===1/0)return this._.root.$;if(h===1)return(this._.back||this._).$;var u=this,s=u._;if(typeof h=="string"&&(h=h.split(".")),h instanceof Array){var d=0,m=h.length,i=s;for(d;d<m;d++)i=(i||o)[h[d]];return c!==i?y?u:i:(i=s.back)?i.$.back(h,y):void 0}if(typeof h=="function"){for(var e,i={back:s};(i=i.back)&&c===(e=h(i,y)););return e}return typeof h=="number"?(s.back||s).$.back(h-1):this};var o={},c})(w,"./back"),w(function(x){var t=w("./root");t.chain.chain=function(a){var n=this,f=n._,l=new(a||n).constructor(n),S=l._,g;return S.root=g=f.root,S.id=++g.once,S.back=n._,S.on=t.on,S.on("in",t.on.in,S),S.on("out",t.on.out,S),l};function o(a){var n,f=this.as,l=f.back,S=f.root,g;if(a.$||(a.$=f.$),this.to.next(a),f.err){f.on("in",{put:f.put=s,$:f.$});return}if(n=a.get){if(S.pass&&(S.pass[f.id]=f),f.lex&&Object.keys(f.lex).forEach(function(O){g[O]=f.lex[O]},g=a.get=a.get||{}),n["#"]||f.soul){if(n["#"]=n["#"]||f.soul,a["#"]||(a["#"]=d(9)),l=S.$.get(n["#"])._,n=n["."]){if(e(l.put,n)&&(g=l.ask&&l.ask[n],(l.ask||(l.ask={}))[n]=l.$.get(n)._,l.on("in",{get:n,put:{"#":l.soul,".":n,":":l.put[n],">":b(S.graph[l.soul],n)}}),g))return}else{if(g=l.ask&&l.ask[""],(l.ask||(l.ask={}))[""]=l,s!==l.put&&(l.on("in",l),g))return;a.$=l.$}return S.ask(i,a),S.on("in",a)}if(n["."])return f.get?(a={get:{".":f.get},$:f.$},(l.ask||(l.ask={}))[f.get]=a.$._,l.on("out",a)):(a={get:f.lex?a.get:{},$:f.$},l.on("out",a));if((f.ask||(f.ask={}))[""]=f,f.get)return n["."]=f.get,(l.ask||(l.ask={}))[f.get]=a.$._,l.on("out",a)}return l.on("out",a)}t.on.out=o;function c(a,n){n=n||this.as;var f=n.root,l=a.$||(a.$=n.$),S=(l||"")._||u,g=a.put||"",O=g["#"],j=g["."],U=s!==g["="]?g["="]:g[":"],C=g[">"]||-1/0,B;if(s!==a.put&&(s===g["#"]||s===g["."]||s===g[":"]&&s===g["="]||s===g[">"])){if(!m(g)){if(!(O=((g||"")._||"")["#"])){console.log("chain not yet supported for",g,"...",a,n);return}return l=n.root.$.get(O),setTimeout.each(Object.keys(g).sort(),function(r){r=="_"||s===(C=b(g,r))||n.on("in",{$:l,put:{"#":O,".":r,"=":g[r],">":C},VIA:a})})}n.on("in",{$:S.back.$,put:{"#":O=S.back.soul,".":j=S.has||S.get,"=":g,">":b(S.back.put,j)},via:a});return}(a.seen||"")[n.id]||((a.seen||(a.seen=function(){}))[n.id]=n,n!==S&&(Object.keys(a).forEach(function(r){g[r]=a[r]},g={}),g.get=n.get||g.get,!n.soul&&!n.has?g.$$$=g.$$$||n.$:S.soul&&(g.$=n.$,g.$$=g.$$||S.$),a=g),y(a,n),(n.soul||a.$$)&&C>=b(f.graph[O],j)&&((g=f.$.get(O)._).put=k(g.put,j,C,U,O)),!S.soul&&C>=b(f.graph[O],j)&&(B=(f.$.get(O)._.next||"")[j])&&(B.put=U,typeof(g=m(U))=="string"&&(B.put=f.$.get(g)._.put||U)),this.to&&this.to.next(a),n.any&&setTimeout.each(Object.keys(n.any),function(r){(r=n.any[r])&&r(a)},0,99),n.echo&&setTimeout.each(Object.keys(n.echo),function(r){(r=n.echo[r])&&r.on("in",a)},0,99),((a.$$||"")._||S).soul&&(B=n.next)&&(B=B[j])&&(g={},Object.keys(a).forEach(function(r){g[r]=a[r]}),g.$=(a.$$||a.$).get(g.get=j),delete g.$$,delete g.$$$,B.on("in",g)),h(a,n))}t.on.in=c;function h(a,n){if(n=n||this.as||a.$._,!(a.$$&&this!==t.on)&&!(!a.put||n.soul)){var f=a.put||"",l=f["="]||f[":"],S,g=n.root,O=g.$.get(f["#"]).get(f["."])._;if(typeof(l=m(l))!="string"){this===t.on&&((O.echo||(O.echo={}))[n.id]=n);return}if(!((O.echo||(O.echo={}))[n.id]&&!(g.pass||"")[n.id])){if(S=g.pass){if(S[l+n.id])return;S[l+n.id]=1}(O.echo||(O.echo={}))[n.id]=n,n.has&&(n.link=l);var j=g.$.get(O.link=l)._;(j.echo||(j.echo={}))[O.id]=O;var S=n.ask||"";(S[""]||n.lex)&&j.on("out",{get:{"#":l}}),setTimeout.each(Object.keys(S),function(C,B){!C||!(B=S[C])||B.on("out",{get:{"#":l,".":C}})},0,99)}}}t.on.link=h;function y(a,n){var f=a.put||"",l=s!==f["="]?f["="]:f[":"],S=n.root,g,O;if(s===l){if(n.soul&&s!==n.put||(O=(a.$$||a.$||"")._||"",a["@"]&&(s!==O.put||s!==n.put)))return;(g=n.link||a.linked)&&delete(S.$.get(g)._.echo||"")[n.id],n.has&&(n.link=null),n.put=s,setTimeout.each(Object.keys(n.next||""),function(j,U){(U=n.next[j])&&(g&&delete(S.$.get(g).get(j)._.echo||"")[U.id],U.on("in",{get:j,put:s,$:U.$}))},0,99);return}n.soul||a.$$||(g=m(l),O=a.$._||"",!((g===O.link||n.has&&!O.link)&&!((S.pass||"")[n.id]&&typeof g!="string"))&&(delete(O.echo||"")[n.id],y({get:n.get,put:s,$:a.$,linked:a.linked=a.linked||O.link},n)))}t.on.unlink=y;function i(a,n){var f=this.as,l=f.$._;l.root;var S=f.get||"",g=(a.put||"")[S["#"]]||"";if(!a.put||typeof S["."]=="string"&&s===g[S["."]]){if(s!==l.put||!l.soul&&!l.has)return;l.ack=(l.ack||0)+1,l.on("in",{get:l.get,put:l.put=s,$:l.$,"@":a["@"]});return}(a._||{}).miss=1,t.on.put(a)}var u={},s,d=String.random,m=t.valid,e=function(a,n){return a&&Object.prototype.hasOwnProperty.call(a,n)},p=t.state,b=p.is,k=p.ify})(w,"./chain"),w(function(x){var t=w("./root");t.chain.get=function(s,d,m){var e,p;if(typeof s=="string"){if(s.length==0)return(e=this.chain())._.err={err:t.log("0 length key!",s)},d&&d.call(e,e._.err),e;var b=this,k=b._,a=k.next||y;(e=a[s])||(e=s&&o(s,b)),e=e&&e.$}else if(typeof s=="function"){let g=function(j,U,C){if(!g.stun&&!(($=f.pass)&&!$[l])){var B=j.$._,r=(j.$$||"")._,v=(r||B).put,_=!B.has&&!B.soul,A={},$;if((_||u===v)&&(v=u===(($=j.put)||"")["="]?u===($||"")[":"]?$:$[":"]:$["="]),typeof($=t.valid(v))=="string"&&(v=u===($=f.$.get($)._.put)?n.not?u:v:$),!(n.not&&u===v)){if(u===n.stun){if(($=f.stun)&&$.on&&(k.$.back(function(D){if($.on(""+D.id,A={}),(A.run||0)<g.id)return A}),!A.run&&$.on(""+B.id,A={}),!A.run&&r&&$.on(""+r.id,A={}),g.id>A.run&&((!A.stun||A.stun.end)&&(A.stun=$.on("stun"),A.stun=A.stun&&A.stun.last),A.stun&&!A.stun.end))){(A.stun.add||(A.stun.add={}))[l]=function(){g(j,U,1)};return}if(u===v&&(C=0),($=f.hatch)&&!$.end&&u===n.hatch&&!C){if(S[B.$._.id])return;S[B.$._.id]=1,$.push(function(){g(j,U,1)});return}S={}}if(f.pass){if(f.pass[l+B.id])return;f.pass[l+B.id]=1}if(n.on){n.ok.call(B.$,v,B.get,j,U||g);return}if(n.v2020){n.ok(j,U||g);return}Object.keys(j).forEach(function(D){$[D]=j[D]},$={}),j=$,j.put=v,n.ok.call(n.as,j,U||g)}}};if(d===!0)return c(this,s,d,m),this;e=this;var k=e._,n=d||{},f=k.root,l;n.at=k,n.ok=s;var S={};return g.at=k,(k.any||(k.any={}))[l=String.random(7)]=g,g.off=function(){g.stun=1,k.any&&delete k.any[l]},g.rid=h,g.id=n.run||++f.once,p=f.pass,(f.pass={})[l]=1,n.out=n.out||{get:{}},k.on("out",n.out),f.pass=p,e}else{if(typeof s=="number")return this.get(""+s,d,m);if(typeof(p=i(s))=="string")return this.get(p,d,m);(p=this.get.next)&&(e=p(this,s))}return e?(d&&typeof d=="function"&&e.get(d,m),e):((e=this.chain())._.err={err:t.log("Invalid get request!",s)},d&&d.call(e,e._.err),e)};function o(s,d){var m=d._,e=m.next,p=d.chain(),b=p._;return e||(e=m.next={}),e[b.get=s]=b,d===m.root.$?b.soul=s:(m.soul||m.has)&&(b.has=s),b}function c(s,d,m,e){var p=s._,b=0,k;return(k=p.soul||p.link)?d(k,e,p):p.jam?p.jam.push([d,e]):(p.jam=[[d,e]],s.get(function(a,n){if(!(u===a.put&&!p.root.opt.super&&(k=Object.keys(p.root.opt.peers).length)&&++b<=k)){n.rid(a);var f=(f=a.$)&&f._||{},l=0,S;for(k=p.jam,delete p.jam;S=k[l++];){var g=S[0];S=S[1],g&&g(f.link||f.soul||t.valid(a.put)||((a.put||{})._||{})["#"],S,a,n)}}},{out:{get:{".":!0}}}),s)}function h(s){var d=this.at||this.on;if(!s||d.soul||d.has)return this.off();if(s=(s=(s=s.$||s)._||s).id){d.map;var m;if((m=this.seen||(this.seen={}))[s])return!0;m[s]=!0}}var y={},i=t.valid,u})(w,"./get"),w(function(x){var t=w("./root");t.chain.put=function(e,p,b){var k=this,a=k._,n=a.root;b=b||{},b.root=a.root,b.run||(b.run=n.once),o(b,a.id),b.ack=b.ack||p,b.via=b.via||k,b.data=b.data||e,b.soul||(b.soul=a.soul||typeof p=="string"&&p);var f=b.state=b.state||t.state();return typeof e=="function"?(e(function(l){b.data=l,k.put(i,i,b)}),k):b.soul?(b.$=n.$.get(b.soul),b.todo=[{it:b.data,ref:b.$}],b.turn=b.turn||s,b.ran=b.ran||c,function l(){var S=b.todo,g=S.pop(),O=g.it;g.ref&&g.ref._.id;var j,U,C,B,r;if(o(b,g.ref),(B=g.todo)&&(U=B.pop(),O=O[U],B.length&&S.push(g)),U&&(S.path||(S.path=[])).push(U),!(j=d(O))&&!(r=t.is(O))){if(!Object.plain(O)){c.err(b,"Invalid data: "+y(O)+" at "+(b.via.back(function($){$.get&&B.push($.get)},B=[])||B.join("."))+"."+(S.path||[]).join("."));return}for(var v=b.seen||(b.seen=[]),_=v.length;_--;)if(O===(B=v[_]).it){j=O=B.link;break}}if(U&&j)g.node=m(g.node,U,f,O);else{let $=function(D,T){var N=C.link["#"];T&&(T.off(),T.rid(D));var E=N||D.soul||(B=(D.$$||D.$)._||"").soul||B.link||((B=B.put||"")._||"")["#"]||B["#"]||((B=D.put||"")&&D.$$?B["#"]:(B["="]||B[":"]||"")["#"]);if(!N&&o(b,D.$),!E&&!g.link["#"]){(g.wait||(g.wait=[])).push(function(){$(D,T)});return}E||(E=[],(D.$$||D.$).back(function(J){if(B=J.soul||J.link)return E.push(B);E.push(J.get)}),E=E.reverse().join("/")),C.link["#"]=E,!r&&(((b.graph||(b.graph={}))[E]=C.node||(C.node={_:{}}))._["#"]=E),delete b.wait[A],C.wait&&setTimeout.each(C.wait,function(J){J&&J()}),b.ran(b)};if(!b.seen){c.err(b,"Data at root of graph must be a node (an object).");return}b.seen.push(C={it:O,link:{},todo:r?[]:Object.keys(O).sort().reverse(),path:(S.path||[]).slice(),up:g}),g.node=m(g.node,U,f,C.link),!r&&C.todo.length&&S.push(C);var A=b.seen.length;(b.wait||(b.wait={}))[A]="",B=(C.ref=r?O:U?g.ref.get(U):g.ref)._,(B=O&&(O._||"")["#"]||B.soul||B.link)?$({soul:B}):C.ref.get($,{run:b.run,v2020:1,out:{get:{".":" "}}})}if(!S.length)return b.ran(b);b.turn(l)}(),k):(h(b),k)};function o(e,p){if(p){p=(p._||"").id||p;var b=e.root.stun||(e.root.stun={on:t.on}),k={},a;e.stun||(e.stun=b.on("stun",function(){})),(a=b.on(""+p))&&a.the.last.next(k),!(k.run>=e.run)&&b.on(""+p,function(n){if(e.stun.end){this.off(),this.to.next(n);return}n.run=n.run||e.run,n.stun=n.stun||e.stun})}}function c(e){if(e.err){c.end(e.stun,e.root);return}if(!(e.todo.length||e.end||!Object.empty(e.wait))){e.end=1;var p=e.$.back(-1)._,b=p.root,k=p.ask(function(l){b.on("ack",l),l.err&&!l.lack&&t.log(l),++a>(e.acks||0)&&this.off(),e.ack&&e.ack(l,this)},e.opt),a=0,n=e.stun,f;(f=function(){n&&(c.end(n,b),setTimeout.each(Object.keys(n=n.add||""),function(l){(l=n[l])&&l()}))}).hatch=f,e.ack&&!e.ok&&(e.ok=e.acks||9),e.via._.on("out",{put:e.out=e.graph,ok:e.ok&&{"@":e.ok+1},opt:e.opt,"#":k,_:f})}}c.end=function(e,p){e.end=u,e.the.to===e&&e===e.the.last&&delete p.stun,e.off()},c.err=function(e,p){(e.ack||u).call(e,e.out={err:e.err=t.log(p)}),e.ran(e)};function h(e){var p=e.via._,b;e.via=e.via.back(function(k){if(k.soul||!k.get)return k.$;b=e.data,(e.data={})[k.get]=b}),(!e.via||!e.via._.soul)&&(e.via=p.root.$.get(((e.data||"")._||"")["#"]||p.$.back("opt.uuid")())),e.via.put(e.data,e.ack,e)}function y(e,p){return e&&(p=e.constructor)&&p.name||typeof e}var i,u=function(){},s=setTimeout.turn,d=t.valid,m=t.state.ify})(w,"./put"),w(function(x){var t=w("./root");w("./chain"),w("./back"),w("./put"),w("./get"),x.exports=t})(w,"./index"),w(function(x){var t=w("./index");t.chain.on=function(h,y,i,u){var s=this,d=s._;d.root;var m;if(typeof h=="string")return y?(m=d.on(h,y,i||d,u),i&&i.$&&(i.subs||(i.subs=[])).push(m),s):d.on(h);var e=y;return(e=e===!0?{change:!0}:e||{}).not=1,e.on=1,s.get(h,e),s},t.chain.once=function(h,y){if(y=y||{},!h)return o(this);var i=this,u=i._,s=u.root;u.put;var d=String.random(7),m;return i.get(function(e,p,b,k){var a=this,n=a._,f=n.one||(n.one={});if(k.stun||f[d]==="")return;if((m=t.valid(e))===!0){l();return}if(typeof m=="string")return;clearTimeout((u.one||"")[d]),clearTimeout(f[d]),f[d]=setTimeout(l,y.wait||99);function l(S){if(!n.has&&!n.soul&&(n={put:e,get:p}),c===(m=n.put)&&(m=((b.$$||"")._||"").put),typeof t.valid(m)=="string"&&(m=s.$.get(m)._.put,m===c&&!S)){f[d]=setTimeout(function(){l(1)},y.wait||99);return}k.stun||f[d]!==""&&(f[d]="",(u.soul||u.has)&&k.off(),h.call(a,m,n.get),clearTimeout(f[d]))}},{on:1}),i};function o(h,y,i){return t.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(i=h.chain())._.nix=h.once(function(u,s){i._.on("in",this._)}),i._.lex=h._.lex,i}t.chain.off=function(){var h=this,y=h._,i,u=y.back;if(u)return y.ack=0,(i=u.next)&&i[y.get]&&delete i[y.get],(i=u.any)&&(delete u.any,u.any={}),(i=u.ask)&&delete i[y.get],(i=u.put)&&delete i[y.get],(i=y.soul)&&delete u.root.graph[i],(i=y.map)&&Object.keys(i).forEach(function(s,d){d=i[s],d.link&&u.root.$.get(d.link).off()}),(i=y.next)&&Object.keys(i).forEach(function(s,d){d=i[s],d.$.off()}),y.on("off",{}),h};var c})(w,"./on"),w(function(x){var t=w("./index"),o=t.chain.get.next;t.chain.get.next=function(i,u){var s;return Object.plain(u)?(s=((s=u["#"])||"")["="]||s)?i.get(s):((s=i.chain()._).lex=u,i.on("in",function(d){String.match(d.get||(d.put||"")["."],u["."]||u["#"]||u)&&s.on("in",d),this.to.next(d)}),s.$):(o||h)(i,u)},t.chain.map=function(i,u,s){var d=this,m=d._,e,p;return Object.plain(i)&&(e=i["."]?i:{".":i},i=y),i?(t.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),p=d.chain(),d.map().on(function(b,k,a,n){var f=(i||h).call(this,b,k,a,n);if(y!==f){if(b===f)return p._.on("in",a);if(t.is(f))return p._.on("in",f._);var l={};Object.keys(a.put).forEach(function(S){l[S]=a.put[S]},l),l["="]=f,p._.on("in",{get:k,put:l})}}),p):((p=m.each)||((m.each=p=d.chain())._.lex=e||p._.lex||m.lex,p._.nix=d.back("nix"),d.on("in",c,p._)),p)};function c(i){this.to.next(i);var u=this.as,s=i.$,d=s._,m=i.put,e;!d.soul&&!i.$$||(e=u.lex)&&!String.match(i.get||(m||"")["."],e["."]||e["#"]||e)||t.on.link(i,u)}var h=function(){},y})(w,"./map"),w(function(x){var t=w("./index");t.chain.set=function(o,c,h){var y=this,i=y.back(-1),u,s;return c=c||function(){},h=h||{},h.item=h.item||o,(u=((o||"")._||"")["#"])&&((o={})["#"]=u),typeof(s=t.valid(o))=="string"?y.get(u=s).put(o,c,h):t.is(o)?(y.put(function(d){o.get(function(m,e,p){if(!m)return c.call(y,{err:t.log('Only a node can be linked! Not "'+p.put+'"!')});(s={})[m]={"#":m},d(s)},!0)}),o):(Object.plain(o)&&(o=i.get(u=y.back("opt.uuid")()).put(o)),y.get(u||i.back("opt.uuid")(7)).put(o,c,h))}})(w,"./set"),w(function(x){w("./shim");var t=function(){},o=JSON.parseAsync||function(i,u,s){var d,m=+new Date;try{u(d,JSON.parse(i,s),c.sucks(+new Date-m))}catch(e){u(e)}},c=JSON.stringifyAsync||function(i,u,s,d){var m,e=+new Date;try{u(m,JSON.stringify(i,s,d),c.sucks(+new Date-e))}catch(p){u(p)}};c.sucks=function(i){i>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),c.sucks=t)};function h(i){var u=function(){},s=i.opt||{};s.log=s.log||console.log,s.gap=s.gap||s.wait||0,s.max=s.max||(s.memory?s.memory*999*999:3e8)*.3,s.pack=s.pack||s.max*.01*.01,s.puff=s.puff||9;var d=setTimeout.turn||setTimeout,m=i.dup,e=m.check,p=m.track,b=u.hear=function(n,f){if(n){if(s.max<=n.length)return u.say({dam:"!",err:"Message too big!"},f);u===this&&(b.d+=n.length||0,++b.c);var l=f.SH=+new Date,S=n[0],g;if(S==="["){o(n,function(O,j){if(O||!j)return u.say({dam:"!",err:"DAM JSON parse error."},f);console.STAT&&console.STAT(+new Date,j.length,"# on hear batch");var U=s.puff;(function C(){for(var B=+new Date,r=0,v;r<U&&(v=j[r++]);)u.hear(v,f);j=j.slice(r),console.STAT&&console.STAT(B,+new Date-B,"hear loop"),k(f),j.length&&d(C,0)})()}),n="";return}if(S==="{"||(n["#"]||Object.plain(n))&&(g=n)){if(g)return b.one(g,f,l);o(n,function(O,j){if(O||!j)return u.say({dam:"!",err:"DAM JSON parse error."},f);b.one(j,f,l)});return}}};b.one=function(n,f,l){var S,g,O,j,U;if(n.DBG&&(n.DBG=U={DBG:n.DBG}),U&&(U.h=l),U&&(U.hp=+new Date),(S=n["#"])||(S=n["#"]=String.random(9)),!(O=e(S))&&(g=n["##"],!(g&&(O=n["@"]||n.get&&S)&&m.check(j=O+g)))){if((n._=function(){}).via=u.leap=f,(O=n["><"])&&typeof O=="string"&&O.slice(0,99).split(",").forEach(function(B){this[B]=1},n._.yo={}),O=n.dam){(O=u.hear[O])&&O(n,f,i),p(S);return}(O=n.ok)&&(n._.near=O["/"]);var l=+new Date;U&&(U.is=l),f.SI=S,p.ed=function(B){S===B&&(p.ed=0,(B=m.s[S])&&(B.via=f,n.get&&(B.it=n)))},i.on("in",u.last=n),U&&(U.hd=+new Date),console.STAT&&console.STAT(l,+new Date-l,n.get?"msg get":n.put?"msg put":"msg"),p(S),j&&p(j),u.leap=u.last=null}},b.c=b.d=0,function(){var n=0,f;u.hash=function(g,O){var j,U,C,B=+new Date;c(g.put,function r(v,_){var A=(U||(U=C=_||"")).slice(0,32768);if(j=String.hash(A,j),U=U.slice(32768),U){d(r,0);return}console.STAT&&console.STAT(B,+new Date-B,"say json+hash"),g._.$put=C,g["##"]=j,u.say(g,O),delete g._.$put},l)};function l(g,O){var j;return O instanceof Object?(Object.keys(O).sort().forEach(S,{to:j={},on:O}),j):O}function S(g){this.to[g]=this.on[g]}u.say=function(g,O){var j;if((j=this)&&(j=j.to)&&j.next&&j.next(g),!g)return!1;var U,C,B,r=g["@"],v=g._||(g._=function(){}),_=g.DBG,A=+new Date;if(v.y=v.y||A,O||_&&(_.y=A),(U=g["#"])||(U=g["#"]=String.random(9)),!f&&p(U),!(C=g["##"])&&y!==g.put&&!v.via&&r){u.hash(g,O);return}if(!O&&r&&(O=(j=m.s[r])&&(j.via||(j=j.it)&&(j=j._)&&j.via)||(j=u.last)&&r===j["#"]&&u.leap),!O&&r)return m.s[r]?void 0:(console.STAT&&console.STAT(+new Date,++n,"total no peer to ack to"),!1);if(r&&!g.put&&!C&&((m.s[r]||"").it||"")["##"])return!1;if(!O&&u.way)return u.way(g);if(_&&(_.yh=+new Date),!(B=v.raw)){u.raw(g,O);return}if(_&&(_.yr=+new Date),!O||!O.id){if(!Object.plain(O||s.peers))return!1;var A=+new Date;s.puff;var $=s.peers,D=Object.keys(O||s.peers||{});console.STAT&&console.STAT(A,+new Date-A,"peer keys"),function E(){var J=+new Date;f=1;var M=v.raw;v.raw=B;for(var H=0,I;H<9&&(I=(D||"")[H++]);)(I=$[I]||(O||"")[I])&&u.say(g,I);v.raw=M,f=0,D=D.slice(H),console.STAT&&console.STAT(J,+new Date-J,"say loop"),D.length&&(d(E,0),r&&p(r))}();return}if(!O.wire&&u.wire&&u.wire(O),U!==O.last){if(O.last=U,O===v.via||(j=v.yo)&&(j[O.url]||j[O.pid]||j[O.id]))return!1;if(console.STAT&&console.STAT(A,((_||v).yp=+new Date)-(v.y||A),"say prep"),!f&&r&&p(r),O.batch){if(O.tail=(j=O.tail||0)+B.length,O.tail<=s.pack){O.batch+=(j?",":"")+B;return}k(O)}O.batch="[";var T=+new Date;setTimeout(function(){console.STAT&&console.STAT(T,+new Date-T,"0ms TO"),k(O)},s.gap),a(B,O),console.STAT&&r===O.SI&&console.STAT(A,+new Date-O.SH,"say ack")}},u.say.c=u.say.d=0,u.raw=function(g,O){if(!g)return"";var j=g._||{},U,C;if(C=j.raw)return C;if(typeof g=="string")return g;var B=g["##"],r=g["@"];if(B&&r){if(!j.via&&e(r+B))return!1;if(C=(m.s[r]||"").it){if(B===C["##"])return!1;C["##"]||(C["##"]=B)}}if(!g.dam&&!g["@"]){var v=0,_=[];C=s.peers;for(var A in C){var $=C[A];if(_.push($.url||$.pid||$.id),++v>6)break}v>1&&(g["><"]=_.join())}if(g.put&&(C=g.ok)&&(g.ok={"@":(C["@"]||1)-1,"/":C["/"]==g._.near?u.near:C["/"]}),U=j.$put){C={},Object.keys(g).forEach(function(T){C[T]=g[T]}),C.put=":])([:",c(C,function(T,N){if(!T){var E=+new Date;C=N.indexOf('"put":":])([:"'),D(y,N=N.slice(0,C+6)+U+N.slice(C+14)),console.STAT&&console.STAT(E,+new Date-E,"say slice")}});return}c(g,D);function D(T,N){T||(j.raw=N,u.say(g,O))}}}();function k(n){var f=n.batch,l=typeof f=="string";if(l&&(f+="]"),n.batch=n.tail=null,!!f&&!(l?3>f.length:!f.length)){if(!l)try{f=f.length===1?f[0]:JSON.stringify(f)}catch(S){return s.log("DAM JSON stringify error",S)}f&&a(f,n)}}function a(n,f){try{var l=f.wire;f.say?f.say(n):l.send&&l.send(n),u.say.d+=n.length||0,++u.say.c}catch{(f.queue=f.queue||[]).push(n)}}return u.near=0,u.hi=function(n){var f=n.wire,l;if(!f){u.wire(n.length&&{url:n,id:n}||n);return}n.id?s.peers[n.url||n.id]=n:(l=n.id=n.id||n.url||String.random(9),u.say({dam:"?",pid:i.opt.pid},s.peers[l]=n),delete m.s[n.last]),n.met||(u.near++,n.met=+new Date,i.on("hi",n)),l=n.queue,n.queue=[],setTimeout.each(l||[],function(S){a(S,n)},0,9)},u.bye=function(n){n.met&&--u.near,delete n.met,i.on("bye",n);var f=+new Date;f=f-(n.met||f),u.bye.time=((u.bye.time||f)+f)/2},u.hear["!"]=function(n,f){s.log("Error:",n.err)},u.hear["?"]=function(n,f){n.pid&&(f.pid||(f.pid=n.pid),n["@"])||(u.say({dam:"?",pid:s.pid,"@":n["#"]},f),delete m.s[f.last])},u.hear.mob=function(n,f){if(n.peers){var l=Object.keys(n.peers),S=l[Math.random()*l.length>>0];S&&(u.bye(f),u.hi(S))}},i.on("create",function(n){n.opt.pid=n.opt.pid||String.random(9),this.to.next(n),n.on("out",u.say)}),i.on("bye",function(n,f){n=s.peers[n.id||n]||n,this.to.next(n),n.bye?n.bye():(f=n.wire)&&f.close&&f.close(),delete s.peers[n.id],n.wire=null}),i.on("bye",function(n,f){this.to.next(n),(f=console.STAT)&&(f.peers=u.near),(f=n.url)&&setTimeout(function(){},s.lack||9e3)}),i.on("hi",function(n,f){if(this.to.next(n),(f=console.STAT)&&(f.peers=u.near),!s.super){var l=Object.keys(i.next||"");l.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(l,function(S){var g=i.next[S];if(s.super||(g.ask||"")[""]){u.say({get:{"#":S}},n);return}setTimeout.each(Object.keys(g.ask||""),function(O){O&&u.say({"##":String.hash((i.graph[S]||"")[O]),get:{"#":S,".":O}},n)})})}}),u}var y;try{x.exports=h}catch{}})(w,"./mesh"),w(function(x){var t=w("./index");t.Mesh=w("./mesh"),t.on("opt",function(c){if(this.to.next(c),c.once)return;var h=c.opt;if(h.WebSocket===!1)return;var y=t.window||{},i=h.WebSocket||y.WebSocket||y.webkitWebSocket||y.mozWebSocket;if(!i)return;h.WebSocket=i;var u=h.mesh=h.mesh||t.Mesh(c);u.wire||h.wire,u.wire=h.wire=s;function s(p){try{if(!p||!p.url)return k&&k(p);var b=p.url.replace(/^http/,"ws"),k=p.wire=new h.WebSocket(b);return k.onclose=function(){m(p),h.mesh.bye(p)},k.onerror=function(a){m(p)},k.onopen=function(){h.mesh.hi(p)},k.onmessage=function(a){a&&h.mesh.hear(a.data||a,p)},k}catch{h.mesh.bye(p)}}setTimeout(function(){!h.super&&c.on("out",{dam:"hi"})},1);var d=2*999;function m(p){clearTimeout(p.defer),h.peers[p.url]&&(e&&p.retry<=0||(p.retry=(p.retry||h.retry+1||60)-(-p.tried+(p.tried=+new Date)<d*4?1:0),p.defer=setTimeout(function b(){if(e&&e.hidden)return setTimeout(b,d);s(p)},d)))}var e=""+o!=typeof document&&document});var o})(w,"./websocket"),w(function(x){if(!(typeof Gun>"u")){var t=function(){},o;try{o=(Gun.window||t).localStorage}catch{}o||(Gun.log("Warning: No localStorage exists to persist data to!"),o={setItem:function(h,y){this[h]=y},removeItem:function(h){delete this[h]},getItem:function(h){return this[h]}});var c=JSON.stringifyAsync||function(h,y,i,u){var s;try{y(s,JSON.stringify(h,i,u))}catch(d){y(d)}};Gun.on("create",function h(y){this.to.next(y);var i=y.opt;y.graph;var u=[],s,d,m,e;if(i.localStorage===!1)return;i.prefix=i.file||"gun/";try{s=h[i.prefix]=h[i.prefix]||JSON.parse(m=o.getItem(i.prefix))||{}}catch{s=h[i.prefix]={}}m=(m||"").length,y.on("get",function(b){this.to.next(b);var k=b.get,a,n,f,l;!k||!(a=k["#"])||(n=s[a]||l,n&&(f=k["."])&&!Object.plain(f)&&(n=Gun.state.ify({},f,Gun.state.is(n,f),n[f],a)),Gun.on.get.ack(b,n))}),y.on("put",function(b){this.to.next(b);var k=b.put,a=k["#"],n=k["."],f=b["#"],l=b.ok||"";if(s[a]=Gun.state.ify(s[a],n,k[">"],k[":"],a),e&&m>4999880){y.on("in",{"@":f,err:"localStorage max!"});return}!b["@"]&&(!b._.via||Math.random()<l["@"]/l["/"])&&u.push(f),!d&&(d=setTimeout(p,9+m/333))});function p(){if(!u.length&&((setTimeout.turn||"").s||"").length){setTimeout(p,99);return}var b=u;clearTimeout(d),d=!1,u=[],c(s,function(k,a){try{!k&&o.setItem(i.prefix,a)}catch(n){k=e=n||"localStorage failure"}k&&(Gun.log(k+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),y.on("localStorage:error",{err:k,get:i.prefix,put:s})),m=a.length,setTimeout.each(b,function(n){y.on("in",{"@":n,err:k,ok:0})},0,99)})}})}})(w,"./localStorage")})(),function(){var w;if(""+w!=typeof Gun){var G=function(r){console.warn("Warning! Deprecated internal utility will break in next version:",r)},x=Gun;x.fn=x.fn||{is:function(r){return G("fn"),!!r&&typeof r=="function"}},x.bi=x.bi||{is:function(r){return G("bi"),r instanceof Boolean||typeof r=="boolean"}},x.num=x.num||{is:function(r){return G("num"),!t(r)&&(r-parseFloat(r)+1>=0||r===1/0||r===-1/0)}},x.text=x.text||{is:function(r){return G("text"),typeof r=="string"}},x.text.ify=x.text.ify||function(r){return G("text.ify"),x.text.is(r)?r:typeof JSON<"u"?JSON.stringify(r):r&&r.toString?r.toString():r},x.text.random=x.text.random||function(r,v){G("text.random");var _="";for(r=r||24,v=v||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";r>0;)_+=v.charAt(Math.floor(Math.random()*v.length)),r--;return _},x.text.match=x.text.match||function(r,v){var _,A;return G("text.match"),typeof r!="string"?!1:(typeof v=="string"&&(v={"=":v}),v=v||{},_=v["="]||v["*"]||v[">"]||v["<"],r===_?!0:A!==v["="]?!1:(_=v["*"]||v[">"]||v["<"],r.slice(0,(_||"").length)===_?!0:A!==v["*"]?!1:A!==v[">"]&&A!==v["<"]?r>=v[">"]&&r<=v["<"]:A!==v[">"]&&r>=v[">"]||A!==v["<"]&&r<=v["<"]))},x.text.hash=x.text.hash||function(r,v){if(G("text.hash"),typeof r=="string"){if(v=v||0,!r.length)return v;for(var _=0,A=r.length,$;_<A;++_)$=r.charCodeAt(_),v=(v<<5)-v+$,v|=0;return v}},x.list=x.list||{is:function(r){return G("list"),r instanceof Array}},x.list.slit=x.list.slit||Array.prototype.slice,x.list.sort=x.list.sort||function(r){return G("list.sort"),function(v,_){return!v||!_?0:(v=v[r],_=_[r],v<_?-1:v>_?1:0)}},x.list.map=x.list.map||function(r,v,_){return G("list.map"),U(r,v,_)},x.list.index=1,x.obj=x.boj||{is:function(r){return G("obj"),r?r instanceof Object&&r.constructor===Object||Object.prototype.toString.call(r).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},x.obj.put=x.obj.put||function(r,v,_){return G("obj.put"),(r||{})[v]=_,r},x.obj.has=x.obj.has||function(r,v){return G("obj.has"),r&&Object.prototype.hasOwnProperty.call(r,v)},x.obj.del=x.obj.del||function(r,v){if(G("obj.del"),!!r)return r[v]=null,delete r[v],r},x.obj.as=x.obj.as||function(r,v,_,A){return G("obj.as"),r[v]=r[v]||(A===_?{}:_)},x.obj.ify=x.obj.ify||function(r){if(G("obj.ify"),l(r))return r;try{r=JSON.parse(r)}catch{r={}}return r},function(){var r;function v(_,A){g(this,A)&&r!==this[A]||(this[A]=_)}x.obj.to=x.obj.to||function(_,A){return G("obj.to"),A=A||{},U(_,v,A),A}}(),x.obj.copy=x.obj.copy||function(r){return G("obj.copy"),r&&JSON.parse(JSON.stringify(r))},function(){function r(v,_){var A=this.n,$;if(!(A&&(_===A||l(A)&&g(A,_)))&&$!==_)return!0}x.obj.empty=x.obj.empty||function(v,_){return G("obj.empty"),v?!U(v,r,{n:_}):!0}}(),function(){function r(A,$){if(arguments.length===2){r.r=r.r||{},r.r[A]=$;return}r.r=r.r||[],r.r.push(A)}var v=Object.keys,_;Object.keys=Object.keys||function(A){return _(A,function($,D,T){T(D)})},x.obj.map=_=x.obj.map||function(A,$,D){G("obj.map");var T,N=0,E,J,M,H,I=typeof $=="function";if(r.r=T,v&&l(A)&&(M=v(A),H=!0),D=D||{},t(A)||M)for(E=(M||A).length;N<E;N++){var K=N+x.list.index;if(I){if(J=H?$.call(D,A[M[N]],M[N],r):$.call(D,A[N],K,r),J!==T)return J}else if($===A[H?M[N]:N])return M?M[N]:K}else for(N in A)if(I){if(g(A,N)&&(J=D?$.call(D,A[N],N,r):$(A[N],N,r),J!==T))return J}else if($===A[N])return N;return I?r.r:x.list.index?0:-1}}(),x.time=x.time||{},x.time.is=x.time.is||function(r){return G("time"),r?r instanceof Date:+new Date().getTime()};var n=x.fn.is,t=x.list.is,f=x.obj,l=f.is,g=f.has,U=f.map,o={};o.is=function(r){return G("val.is"),r===w?!1:r===null?!0:r===1/0?!1:y(r)||h(r)||p(r)?!0:o.link.is(r)||!1},o.link=o.rel={_:"#"},function(){o.link.is=function(v){if(G("val.link.is"),v&&v[c]&&!v._&&l(v)){var _={};if(U(v,r,_),_.id)return _.id}return!1};function r(v,_){var A=this;if(A.id)return A.id=!1;if(_==c&&y(v))A.id=v;else return A.id=!1}}(),o.link.ify=function(r){return G("val.link.ify"),j({},c,r)},x.obj.has._=".";var c=o.link._,w,h=x.bi.is,p=x.num.is,y=x.text.is,f=x.obj,l=f.is,j=f.put,U=f.map;x.val=x.val||o;var i={_:"_"};i.soul=function(r,v){return G("node.soul"),r&&r._&&r._[v||d]},i.soul.ify=function(r,v){return G("node.soul.ify"),v=typeof v=="string"?{soul:v}:v||{},r=r||{},r._=r._||{},r._[d]=v.soul||r._[d]||s(),r},i.soul._=o.link._,function(){i.is=function(v,_,A){G("node.is");var $;return l(v)&&($=i.soul(v))?!U(v,r,{as:A,cb:_,s:$,n:v}):!1};function r(v,_){if(_!==i._){if(!o.is(v))return!0;this.cb&&this.cb.call(this.as,v,_,this.n,this.s)}}}(),function(){i.ify=function(v,_,A){return G("node.ify"),_?typeof _=="string"?_={soul:_}:typeof _=="function"&&(_={map:_}):_={},_.map&&(_.node=_.map.call(A,v,w,_.node||{})),(_.node=i.soul.ify(_.node||{},_))&&U(v,r,{o:_,as:A}),_.node};function r(v,_){var A=this.o,$,D;if(A.map){$=A.map.call(this.as,v,""+_,A.node),D===$?S(A.node,_):A.node&&(A.node[_]=$);return}o.is(v)&&(A.node[_]=v)}}();var f=x.obj,l=f.is,S=f.del,U=f.map,u=x.text,s=u.random,d=i.soul._,w;x.node=x.node||i;var m=x.state;m.lex=function(){return G("state.lex"),m().toString(36).replace(".","")},m.to=function(r,v,_){G("state.to");var A=(r||{})[v];return l(A)&&(A=C(A)),m.ify(_,v,m.is(r,v),A,i.soul(r))},function(){m.map=function(v,_,A){G("state.map");var $,D=l(D=v||_)?D:null;return v=n(v=v||_)?v:null,D&&!v?(_=p(_)?_:m(),D[k]=D[k]||{},U(D,r,{o:D,s:_}),D):(A=A||l(_)?_:$,_=p(_)?_:m(),function(T,N,E,J){if(!v)return r.call({o:E,s:_},T,N),T;v.call(A||this||{},T,N,E,J),!(g(E,N)&&$===E[N])&&r.call({o:E,s:_},T,N)})};function r(v,_){k!==_&&m.ify(this.o,_,this.s)}}();var f=x.obj;f.as;var g=f.has,l=f.is,U=f.map,C=f.copy,e=x.num,p=e.is,b=x.fn,n=b.is,k=i._,w,a={};(function(){a.is=function(_,A,$,D){return G("graph.is"),!_||!l(_)||O(_)?!1:!U(_,r,{cb:A,fn:$,as:D})};function r(_,A){if(!_||A!==i.soul(_)||!i.is(_,this.fn,this.as))return!0;this.cb&&(v.n=_,v.as=this.as,this.cb.call(v.as,_,A,v))}function v(_){_&&i.is(v.n,_,v.as)}})(),function(){a.ify=function(D,T,N){G("graph.ify");var E={path:[],obj:D};return T?typeof T=="string"?T={soul:T}:typeof T=="function"&&(T.map=T):T={},typeof N=="string"&&(T.soul=T.soul||N,N=w),T.soul&&(E.link=o.link.ify(T.soul)),T.shell=(N||{}).shell,T.graph=T.graph||{},T.seen=T.seen||[],T.as=T.as||N,r(T,E),T.root=E.node,T.graph};function r(D,T){var N;return(N=$(D,T))?N:(T.env=D,T.soul=_,i.ify(T.obj,v,T)&&(T.link=T.link||o.link.ify(i.soul(T.node)),T.obj!==D.shell&&(D.graph[o.link.is(T.link)]=T.node)),T)}function v(D,T,N){var E=this,J=E.env,M,H;if(i._===T&&g(D,o.link._))return N._;if(M=A(D,T,N,E,J)){if(T||(E.node=E.node||N||{},g(D,i._)&&i.soul(D)&&(E.node._=C(D._)),E.node=i.soul.ify(E.node,o.link.is(E.link)),E.link=E.link||o.link.ify(i.soul(E.node))),(H=J.map)&&(H.call(J.as||{},D,T,N,E),g(N,T))){if(D=N[T],w===D){S(N,T);return}if(!(M=A(D,T,N,E,J)))return}if(!T)return E.node;if(M===!0)return D;if(H=r(J,{obj:D,path:E.path.concat(T)}),!!H.node)return H.link}}function _(D){var T=this,N=o.link.is(T.link),E=T.env.graph;T.link=T.link||o.link.ify(D),T.link[o.link._]=D,T.node&&T.node[i._]&&(T.node[i._][o.link._]=D),g(E,N)&&(E[D]=E[N],S(E,N))}function A(D,T,N,E,J){var M;if(o.is(D))return!0;if(l(D))return 1;if(M=J.invalid)return D=M.call(J.as||{},D,T,N),A(D,T,N,E,J);J.err="Invalid value at '"+E.path.concat(T).join(".")+"'!",x.list.is(D)&&(J.err+=" Use `.set(item)` instead of an Array.")}function $(D,T){for(var N=D.seen,E=N.length,J;E--;)if(J=N[E],T.obj===J.obj)return J;N.push(T)}}(),a.node=function(r){G("graph.node");var v=i.soul(r);if(v)return j({},v,r)},function(){a.to=function(v,_,A){if(G("graph.to"),!!v){var $={};return A=A||{seen:{}},U(v[_],r,{obj:$,graph:v,opt:A}),$}};function r(v,_){var A,$;if(i._===_){if(O(v,o.link._))return;this.obj[_]=C(v);return}if(!(A=o.link.is(v))){this.obj[_]=v;return}if($=this.opt.seen[A]){this.obj[_]=$;return}this.obj[_]=this.opt.seen[A]=a.to(this.graph,A,this.opt)}}();var n=x.fn.is,f=x.obj,l=f.is,S=f.del,g=f.has,O=f.empty,j=f.put,U=f.map,C=f.copy,w;x.graph=x.graph||a}}()}(ut);var Vt=ut.exports,oe=Vt;const ie=re(oe);var st={exports:{}};st.exports,function(P){(function(){function w(x,t){return t?Ft(x):x.slice?w[o(x)]:function(c,h){x(c={exports:{}}),w[o(h)]=c.exports};function o(c){return c.split("/").slice(-1).toString().replace(".js","")}}var G=P;w(function(x){typeof self<"u"&&(x.window=self),typeof window<"u"&&(x.window=window);var t=x.window||x,o,c=t.SEA||{};(c.window=x.window)&&(c.window.SEA=c);try{o+""!=typeof G&&(G.exports=c)}catch{}x.exports=c})(w,"./root"),w(function(x){var t=w("./root");try{t.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(w,"./https"),w(function(x){var t;if(t+""==typeof btoa){if(t+""==typeof Buffer)try{at.Buffer=w("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}at.btoa=function(o){return Buffer.from(o,"binary").toString("base64")},at.atob=function(o){return Buffer.from(o,"base64").toString("binary")}}})(w,"./base64"),w(function(x){w("./base64");function t(){}Object.assign(t,{from:Array.from}),t.prototype=Object.create(Array.prototype),t.prototype.toString=function(o,c,h){o=o||"utf8",c=c||0;const y=this.length;if(o==="hex"){const i=new Uint8Array(this);return[...Array((h&&h+1||y)-c).keys()].map(u=>i[u+c].toString(16).padStart(2,"0")).join("")}if(o==="utf8")return Array.from({length:(h||y)-c},(i,u)=>String.fromCharCode(this[u+c])).join("");if(o==="base64")return btoa(this)},x.exports=t})(w,"./array"),w(function(x){w("./base64");var t=w("./array");function o(...c){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),o.from(...c)}o.prototype=Object.create(Array.prototype),Object.assign(o,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const c=arguments[0];let h;if(typeof c=="string"){const y=arguments[1]||"utf8";if(y==="hex"){const i=c.match(/([\da-fA-F]{2})/g).map(u=>parseInt(u,16));if(!i||!i.length)throw new TypeError("Invalid first argument for type 'hex'.");h=t.from(i)}else if(y==="utf8"||y==="binary"){const i=c.length,u=new Uint16Array(i);Array.from({length:i},(s,d)=>u[d]=c.charCodeAt(d)),h=t.from(u)}else if(y==="base64"){const i=atob(c),u=i.length,s=new Uint8Array(u);Array.from({length:u},(d,m)=>s[m]=i.charCodeAt(m)),h=t.from(s)}else y==="binary"?h=t.from(c):console.info("SafeBuffer.from unknown encoding: "+y);return h}if(c.byteLength,c.byteLength?c.byteLength:c.length){let y;return c instanceof ArrayBuffer&&(y=new Uint8Array(c)),t.from(y||c)}},alloc(c,h=0){return t.from(new Uint8Array(Array.from({length:c},()=>h)))},allocUnsafe(c){return t.from(new Uint8Array(Array.from({length:c})))},concat(c){if(!Array.isArray(c))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return t.from(c.reduce((h,y)=>h.concat(Array.from(y)),[]))}}),o.prototype.from=o.from,o.prototype.toString=t.prototype.toString,x.exports=o})(w,"./buffer"),w(function(x){const t=w("./root"),o={Buffer:w("./buffer")};var c={},h;if(JSON.parseAsync=JSON.parseAsync||function(i,u,s){var d;try{u(d,JSON.parse(i,s))}catch(m){u(m)}},JSON.stringifyAsync=JSON.stringifyAsync||function(i,u,s,d){var m;try{u(m,JSON.stringify(i,s,d))}catch(e){u(e)}},o.parse=function(i,u){return new Promise(function(s,d){JSON.parseAsync(i,function(m,e){m?d(m):s(e)},u)})},o.stringify=function(i,u,s){return new Promise(function(d,m){JSON.stringifyAsync(i,function(e,p){e?m(e):d(p)},u,s)})},t.window&&(o.crypto=t.window.crypto||t.window.msCrypto,o.subtle=(o.crypto||c).subtle||(o.crypto||c).webkitSubtle,o.TextEncoder=t.window.TextEncoder,o.TextDecoder=t.window.TextDecoder,o.random=i=>o.Buffer.from(o.crypto.getRandomValues(new Uint8Array(o.Buffer.alloc(i))))),!o.TextDecoder){const{TextEncoder:i,TextDecoder:u}=w((h+""==typeof G?".":"")+"./lib/text-encoding",1);o.TextDecoder=u,o.TextEncoder=i}if(!o.crypto)try{var y=w("crypto",1);Object.assign(o,{crypto:y,random:u=>o.Buffer.from(y.randomBytes(u))});const{Crypto:i}=w("@peculiar/webcrypto",1);o.ossl=o.subtle=new i({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}x.exports=o})(w,"./shim"),w(function(x){var t=w("./root"),o=w("./shim"),c={};c.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},c.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},c.ecdh={name:"ECDH",namedCurve:"P-256"},c.jwk=function(h,y){h=h.split(".");var i=h[0],u=h[1],s={kty:"EC",crv:"P-256",x:i,y:u,ext:!0};return s.key_ops=y?["sign"]:["verify"],y&&(s.d=y),s},c.keyToJwk=function(h){return{kty:"oct",k:h.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},c.recall={validity:12*60*60,hook:function(h){return h}},c.check=function(h){return typeof h=="string"&&h.slice(0,4)==="SEA{"},c.parse=async function(h){try{var y=typeof h=="string";return y&&h.slice(0,4)==="SEA{"&&(h=h.slice(3)),y?await o.parse(h):h}catch{}return h},t.opt=c,x.exports=c})(w,"./settings"),w(function(x){var t=w("./shim");x.exports=async function(o,c){var h=typeof o=="string"?o:await t.stringify(o),y=await t.subtle.digest({name:c||"SHA-256"},new t.TextEncoder().encode(h));return t.Buffer.from(y)}})(w,"./sha256"),w(function(x){const t=w("./shim"),o=t.subtle,c=t.ossl?t.ossl:o,h=y=>c.digest({name:"SHA-1"},new ArrayBuffer(y));x.exports=h})(w,"./sha1"),w(function(x){var t=w("./root"),o=w("./shim"),c=w("./settings"),h=w("./sha256"),y;t.work=t.work||(async(i,u,s,d)=>{try{var m=(u||{}).epub||u;if(d=d||{},m instanceof Function&&(s=m,m=y),i=typeof i=="string"?i:await o.stringify(i),(d.name||"").toLowerCase().slice(0,3)==="sha"){var e=o.Buffer.from(await h(i,d.name),"binary").toString(d.encode||"base64");if(s)try{s(e)}catch(a){console.log(a)}return e}m=m||o.random(9);var p=await(o.ossl||o.subtle).importKey("raw",new o.TextEncoder().encode(i),{name:d.name||"PBKDF2"},!1,["deriveBits"]),b=await(o.ossl||o.subtle).deriveBits({name:d.name||"PBKDF2",iterations:d.iterations||c.pbkdf2.iter,salt:new o.TextEncoder().encode(d.salt||m),hash:d.hash||c.pbkdf2.hash},p,d.length||c.pbkdf2.ks*8);i=o.random(i.length);var k=o.Buffer.from(b,"binary").toString(d.encode||"base64");if(s)try{s(k)}catch(a){console.log(a)}return k}catch(a){if(console.log(a),t.err=a,t.throw)throw a;s&&s();return}}),x.exports=t.work})(w,"./work"),w(function(x){var t=w("./root"),o=w("./shim");w("./settings"),t.name=t.name||(async(c,h)=>{try{if(c)try{c()}catch(y){console.log(y)}return}catch(y){if(console.log(y),t.err=y,t.throw)throw y;c&&c();return}}),t.pair=t.pair||(async(c,h)=>{try{var y=o.ossl||o.subtle,i=await o.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async d=>{var m={};m.priv=(await o.subtle.exportKey("jwk",d.privateKey)).d;var e=await o.subtle.exportKey("jwk",d.publicKey);return m.pub=e.x+"."+e.y,m});try{var u=await y.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async d=>{var m={};m.epriv=(await y.exportKey("jwk",d.privateKey)).d;var e=await y.exportKey("jwk",d.publicKey);return m.epub=e.x+"."+e.y,m})}catch(d){if(t.window)throw d;if(d=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw d}u=u||{};var s={pub:i.pub,priv:i.priv,epub:u.epub,epriv:u.epriv};if(c)try{c(s)}catch(d){console.log(d)}return s}catch(d){if(console.log(d),t.err=d,t.throw)throw d;c&&c();return}}),x.exports=t.pair})(w,"./pair"),w(function(x){var t=w("./root"),o=w("./shim"),c=w("./settings"),h=w("./sha256"),y;t.sign=t.sign||(async(i,u,s,d)=>{try{if(d=d||{},!(u||d).priv){if(!t.I)throw"No signing key.";u=await t.I(null,{what:i,how:"sign",why:d.why})}if(y===i)throw"`undefined` not allowed.";var m=await c.parse(i),e=d.check=d.check||m;if(t.verify&&(t.opt.check(e)||e&&e.s&&e.m)&&y!==await t.verify(e,u)){var f=await c.parse(e);if(d.raw||(f="SEA"+await o.stringify(f)),s)try{s(f)}catch(S){console.log(S)}return f}var p=u.pub,b=u.priv,k=c.jwk(p,b),a=await h(m),n=await(o.ossl||o.subtle).importKey("jwk",k,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(l=>(o.ossl||o.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},l,new Uint8Array(a))),f={m,s:o.Buffer.from(n,"binary").toString(d.encode||"base64")};if(d.raw||(f="SEA"+await o.stringify(f)),s)try{s(f)}catch(l){console.log(l)}return f}catch(l){if(console.log(l),t.err=l,t.throw)throw l;s&&s();return}}),x.exports=t.sign})(w,"./sign"),w(function(x){var t=w("./root"),o=w("./shim"),c=w("./settings"),h=w("./sha256"),y;t.verify=t.verify||(async(s,d,m,e)=>{try{var p=await c.parse(s);if(d===!1){var b=await c.parse(p.m);if(m)try{m(b)}catch(j){console.log(j)}return b}e=e||{};var k=d.pub||d,a=t.opt.slow_leak?await t.opt.slow_leak(k):await(o.ossl||o.subtle).importKey("jwk",c.jwk(k),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),n=await h(p.m),f,l,S,g;try{if(f=o.Buffer.from(p.s,e.encode||"base64"),l=new Uint8Array(f),S=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},a,l,new Uint8Array(n)),!S)throw"Signature did not match."}catch{if(t.opt.fallback)return await t.opt.fall_verify(s,d,m,e)}var O=S?await c.parse(p.m):y;if(m)try{m(O)}catch(j){console.log(j)}return O}catch(j){if(console.log(j),t.err=j,t.throw)throw j;m&&m();return}}),x.exports=t.verify;var i={};t.opt.slow_leak=s=>{if(i[s])return i[s];var d=c.jwk(s);return i[s]=(o.ossl||o.subtle).importKey("jwk",d,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),i[s]};var u=t.opt;t.opt.fall_verify=async function(s,d,m,e,p){if(p===t.opt.fallback)throw"Signature did not match";p=p||1;var b=s||"";s=t.opt.unpack(s)||s;var k=await c.parse(s),a=d.pub||d,n=await t.opt.slow_leak(a),f=p<=t.opt.fallback?o.Buffer.from(await o.subtle.digest({name:"SHA-256"},new o.TextEncoder().encode(await c.parse(k.m)))):await h(k.m),l,S,g;try{if(l=o.Buffer.from(k.s,e.encode||"base64"),S=new Uint8Array(l),g=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},n,S,new Uint8Array(f)),!g)throw"Signature did not match."}catch{try{l=o.Buffer.from(k.s,"utf8"),S=new Uint8Array(l),g=await(o.ossl||o.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},n,S,new Uint8Array(f))}catch{if(!g)throw"Signature did not match."}}var O=g?await c.parse(k.m):y;if(u.fall_soul=b["#"],u.fall_key=b["."],u.fall_val=s,u.fall_state=b[">"],m)try{m(O)}catch(j){console.log(j)}return O},t.opt.fallback=2})(w,"./verify"),w(function(x){var t=w("./shim"),o=w("./settings"),c=w("./sha256");const h=async(y,i,u)=>{const s=y+(i||t.random(8)).toString("utf8"),d=t.Buffer.from(await c(s),"binary"),m=o.keyToJwk(d);return await t.subtle.importKey("jwk",m,{name:"AES-GCM"},!1,["encrypt","decrypt"])};x.exports=h})(w,"./aeskey"),w(function(x){var t=w("./root"),o=w("./shim");w("./settings");var c=w("./aeskey"),h;t.encrypt=t.encrypt||(async(y,i,u,s)=>{try{s=s||{};var d=(i||s).epriv||i;if(h===y)throw"`undefined` not allowed.";if(!d){if(!t.I)throw"No encryption key.";i=await t.I(null,{what:y,how:"encrypt",why:s.why}),d=i.epriv||i}var m=typeof y=="string"?y:await o.stringify(y),e={s:o.random(9),iv:o.random(15)},p=await c(d,e.s,s).then(k=>o.subtle.encrypt({name:s.name||"AES-GCM",iv:new Uint8Array(e.iv)},k,new o.TextEncoder().encode(m))),b={ct:o.Buffer.from(p,"binary").toString(s.encode||"base64"),iv:e.iv.toString(s.encode||"base64"),s:e.s.toString(s.encode||"base64")};if(s.raw||(b="SEA"+await o.stringify(b)),u)try{u(b)}catch(k){console.log(k)}return b}catch(k){if(console.log(k),t.err=k,t.throw)throw k;u&&u();return}}),x.exports=t.encrypt})(w,"./encrypt"),w(function(x){var t=w("./root"),o=w("./shim"),c=w("./settings"),h=w("./aeskey");t.decrypt=t.decrypt||(async(y,i,u,s)=>{try{s=s||{};var d=(i||s).epriv||i;if(!d){if(!t.I)throw"No decryption key.";i=await t.I(null,{what:y,how:"decrypt",why:s.why}),d=i.epriv||i}var m=await c.parse(y),e,p,b;try{e=o.Buffer.from(m.s,s.encode||"base64"),p=o.Buffer.from(m.iv,s.encode||"base64"),b=o.Buffer.from(m.ct,s.encode||"base64");var k=await h(d,e,s).then(n=>o.subtle.decrypt({name:s.name||"AES-GCM",iv:new Uint8Array(p),tagLength:128},n,new Uint8Array(b)))}catch{if(s.encode==="utf8")throw"Could not decrypt";if(t.opt.fallback)return s.encode="utf8",await t.decrypt(y,i,u,s)}var a=await c.parse(new o.TextDecoder("utf8").decode(k));if(u)try{u(a)}catch(n){console.log(n)}return a}catch(n){if(console.log(n),t.err=n,t.throw)throw n;u&&u();return}}),x.exports=t.decrypt})(w,"./decrypt"),w(function(x){var t=w("./root"),o=w("./shim");w("./settings"),t.secret=t.secret||(async(h,y,i,u)=>{try{if(u=u||{},!y||!y.epriv||!y.epub){if(!t.I)throw"No secret mix.";y=await t.I(null,{what:h,how:"secret",why:u.why})}var s=h.epub||h,d=y.epub,m=y.epriv,e=o.ossl||o.subtle,p=c(s),b=Object.assign({public:await e.importKey(...p,!0,[])},{name:"ECDH",namedCurve:"P-256"}),k=c(d,m),a=await e.importKey(...k,!1,["deriveBits"]).then(async f=>{var l=await e.deriveBits(b,f,256),S=new Uint8Array(l),g=await e.importKey("raw",S,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return e.exportKey("jwk",g).then(({k:O})=>O)}),n=a;if(i)try{i(n)}catch(f){console.log(f)}return n}catch(f){if(console.log(f),t.err=f,t.throw)throw f;i&&i();return}});var c=(h,y)=>{var[i,u]=h.split("."),s=y?{d:y}:{};return["jwk",Object.assign(s,{x:i,y:u,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};x.exports=t.secret})(w,"./secret"),w(function(x){var t=w("./root");t.certify=t.certify||(async(o,c={},h,y,i={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),o=(()=>{var a=[];if(o){if((typeof o=="string"||Array.isArray(o))&&o.indexOf("*")>-1)return"*";if(typeof o=="string")return o;if(Array.isArray(o)){if(o.length===1&&o[0])return typeof o[0]=="object"&&o[0].pub?o[0].pub:typeof o[0]=="string"?o[0]:null;o.map(n=>{typeof n=="string"?a.push(n):typeof n=="object"&&n.pub&&a.push(n.pub)})}return typeof o=="object"&&o.pub?o.pub:a.length>0?a:null}})(),!o)return console.log("No certificant found.");const s=i.expiry&&(typeof i.expiry=="number"||typeof i.expiry=="string")?parseFloat(i.expiry):null,d=(c||{}).read?c.read:null,m=(c||{}).write?c.write:typeof c=="string"||Array.isArray(c)||c["+"]||c["#"]||c["."]||c["="]||c["*"]||c[">"]||c["<"]?c:null,e=(i||{}).block||(i||{}).blacklist||(i||{}).ban||{},p=e.read&&(typeof e.read=="string"||(e.read||{})["#"])?e.read:null,b=typeof e=="string"?e:e.write&&(typeof e.write=="string"||e.write["#"])?e.write:null;if(!d&&!m)return console.log("No policy found.");const k=JSON.stringify({c:o,...s?{e:s}:{},...d?{r:d}:{},...m?{w:m}:{},...p?{rb:p}:{},...b?{wb:b}:{}});var u=await t.sign(k,h,null,{raw:1});if(i.raw||(u="SEA"+JSON.stringify(u)),y)try{y(u)}catch(a){console.log(a)}return u}catch(s){if(t.err=s,t.throw)throw s;y&&y();return}}),x.exports=t.certify})(w,"./certify"),w(function(x){var t=w("./shim"),o=w("./root");o.work=w("./work"),o.sign=w("./sign"),o.verify=w("./verify"),o.encrypt=w("./encrypt"),o.decrypt=w("./decrypt"),o.certify=w("./certify"),o.random=o.random||t.random,o.Buffer=o.Buffer||w("./buffer"),o.keyid=o.keyid||(async c=>{try{const h=t.Buffer.concat(c.replace(/-/g,"+").replace(/_/g,"/").split(".").map(s=>t.Buffer.from(s,"base64"))),y=t.Buffer.concat([t.Buffer.from([153,h.length/256,h.length%256]),h]),i=await sha1hash(y),u=t.Buffer.from(i,"binary");return u.toString("hex",u.length-8)}catch(h){throw console.log(h),h}}),((o.window||{}).GUN||{}).SEA=o,x.exports=o})(w,"./sea"),w(function(x){var t=w("./sea"),o,c;t.window?o=t.window.GUN||{chain:{}}:o=w((c+""==typeof G?".":"")+"./gun",1),t.GUN=o;function h(i){this._={$:this}}h.prototype=function(){function i(){}return i.prototype=o.chain,new i}(),h.prototype.constructor=h,o.chain.user=function(i){var u=this,d=u.back(-1),s;if(i)return i=t.opt.pub((i._||"")["#"])||i,d.get("~"+i);if(s=d.back("user"))return s;var d=d._,m=d,e=m.opt.uuid||y;return(m=(s=m.user=u.chain(new h))._).opt={},m.opt.uuid=function(p){var b=e(),k=d.user;return!k||!(k=k.is)||!(k=k.pub)||(b="~"+k+"/"+b,p&&p.call&&p(null,b)),b},s};function y(){return o.state().toString(36).replace(".","")}o.User=h,h.GUN=o,h.SEA=o.SEA=t,x.exports=h})(w,"./user"),w(function(x){var t,o=""+t!=typeof GUN?GUN||{chain:{}}:w((""+t==typeof G?".":"")+"./gun",1);o.chain.then=function(c,h){var y=this,i=new Promise(function(u,s){y.once(u,h)});return c?i.then(c):i}})(w,"./then"),w(function(x){var t=w("./user"),o=t.SEA,c=t.GUN,h=function(){};t.prototype.create=function(...y){var i=typeof y[0]=="object"&&(y[0].pub||y[0].epub)?y[0]:typeof y[1]=="object"&&(y[1].pub||y[1].epub)?y[1]:null,u=i&&(i.pub||i.epub)?i.pub:typeof y[0]=="string"?y[0]:null,s=i&&(i.pub||i.epub)?i:u&&typeof y[1]=="string"?y[1]:null,d=y.filter(n=>typeof n=="function")[0]||null,m=y&&y.length>1&&typeof y[y.length-1]=="object"?y[y.length-1]:{},e=this,p=e._,b=e.back(-1);if(d=d||h,m=m||{},m.check!==!1){var k;if(u||(k="No user."),(s||"").length<8&&(k="Password too short!"),k)return d({err:c.log(k)}),e}if(p.ing)return(d||h)({err:c.log("User is already being created or authenticated!"),wait:!0}),e;p.ing=!0;var a={};return a.a=function(n){if(a.pubs=n,n&&!m.already){var f={err:c.log("User already created!")};p.ing=!1,(d||h)(f),e.leave();return}a.salt=String.random(64),o.work(s,a.salt,a.b)},a.b=function(n){a.proof=n,i?a.c(i):o.pair(a.c)},a.c=function(n){var f;a.pair=n||{},(f=p.root.user)&&(f._.sea=n,f.is={pub:n.pub,epub:n.epub,alias:u}),a.data={pub:n.pub},a.d()},a.d=function(){a.data.alias=u,a.e()},a.e=function(){a.data.epub=a.pair.epub,o.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},a.proof,a.f,{raw:1})},a.f=function(n){a.data.auth=JSON.stringify({ek:n,s:a.salt}),a.g(a.data.auth)},a.g=function(n){var f;a.data.auth=a.data.auth||n,b.get(f="~"+a.pair.pub).put(a.data).on(a.h);var l={};l[f]={"#":f},b.get("~@"+u).put(l).get(f).on(a.i)},a.h=function(n,f,l,S){S.off(),a.h.ok=1,a.i()},a.i=function(n,f,l,S){S&&(a.i.ok=1,S.off()),!(!a.h.ok||!a.i.ok)&&(p.ing=!1,d({ok:0,pub:a.pair.pub}),h===d&&(i?e.auth(i):e.auth(u,s)))},b.get("~@"+u).once(a.a),e},t.prototype.leave=function(y,i){var u=this,s=u.back(-1)._.user;if(s&&(delete s.is,delete s._.is,delete s._.sea),o.window)try{var d={};d=o.window.sessionStorage,delete d.recall,delete d.pair}catch{}return u}})(w,"./create"),w(function(x){var t=w("./user"),o=t.SEA,c=t.GUN,h=function(){};t.prototype.auth=function(...i){var u=typeof i[0]=="object"&&(i[0].pub||i[0].epub)?i[0]:typeof i[1]=="object"&&(i[1].pub||i[1].epub)?i[1]:null,s=!u&&typeof i[0]=="string"?i[0]:null,d=(s||u&&!(u.priv&&u.epriv))&&typeof i[1]=="string"?i[1]:null,m=i.filter(l=>typeof l=="function")[0]||null,e=i&&i.length>1&&typeof i[i.length-1]=="object"?i[i.length-1]:{},p=this,b=p._,k=p.back(-1);if(b.ing)return(m||h)({err:c.log("User is already being created or authenticated!"),wait:!0}),p;b.ing=!0;var a={},n,f=9;return a.a=function(l){if(!l)return a.b();if(!l.pub){var S=[];return Object.keys(l).forEach(function(g){g!="_"&&S.push(l[g])}),a.b(S)}if(a.name)return a.f(l);a.c((a.data=l).auth)},a.b=function(l){var S=(a.list=(a.list||[]).concat(l||[])).shift();if(n===S){if(a.name)return a.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(s&&f--){k.get("~@"+s).once(a.a);return}return a.err("Wrong user or password.")}k.get(S).once(a.a)},a.c=function(l){if(n===l)return a.b();if(typeof l=="string")return a.c(y(l));o.work(d,(a.auth=l).s,a.d,a.enc)},a.d=function(l){o.decrypt(a.auth.ek,l,a.e,a.enc)},a.e=function(l){if(n===l)return a.enc?(a.enc=null,a.b()):(a.enc={encode:"utf8"},a.c(a.auth));a.half=l,a.f(a.data)},a.f=function(l){var S=a.half||{},g=a.data||{};a.g(a.lol={pub:l.pub||g.pub,epub:l.epub||g.epub,priv:l.priv||S.priv,epriv:l.epriv||S.epriv})},a.g=function(l){if(!l||!l.pub||!l.epub)return a.b();a.pair=l;var S=k._.user,g=S._;g.tag;var O=g.opt;g=S._=k.get("~"+l.pub)._,g.opt=O,S.is={pub:l.pub,epub:l.epub,alias:s||l.pub},g.sea=a.pair,b.ing=!1;try{d&&n==(y(b.root.graph["~"+l.pub].auth)||"")[":"]&&(e.shuffle=e.change=d)}catch{}if(e.change?a.z():(m||h)(g),o.window&&(p.back("user")._.opt||e).remember)try{var j={};j=o.window.sessionStorage,j.recall=!0,j.pair=JSON.stringify(l)}catch{}try{k._.tag.auth?k._.on("auth",g):setTimeout(function(){k._.on("auth",g)},1)}catch(U){c.log("Your 'auth' callback crashed with:",U)}},a.h=function(l){if(!l)return a.b();if(s=l.alias,s||(s=l.alias="~"+u.pub),!l.auth)return a.g(u);u=null,a.c((a.data=l).auth)},a.z=function(){a.salt=String.random(64),o.work(e.change,a.salt,a.y)},a.y=function(l){o.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},l,a.x,{raw:1})},a.x=function(l){a.w(JSON.stringify({ek:l,s:a.salt}))},a.w=function(l){if(e.shuffle){console.log("migrate core account from UTF8 & shuffle");var S={};Object.keys(a.data).forEach(function(g){S[g]=a.data[g]}),delete S._,S.auth=l,k.get("~"+a.pair.pub).put(S)}k.get("~"+a.pair.pub).get("auth").put(l,m||h)},a.err=function(l){var S={err:c.log(l||"User cannot be found!")};b.ing=!1,(m||h)(S)},a.plugin=function(l){if(!(a.name=l))return a.err();var S=[l];l[0]!=="~"&&(S[1]="~"+l,S[2]="~@"+l),a.b(S)},u?u.priv&&u.epriv?a.g(u):k.get("~"+u.pub).once(a.h):s?k.get("~@"+s).once(a.a):!s&&!d&&o.name(a.plugin),p};function y(i){if(typeof i!="string")return i;try{i=JSON.parse(i)}catch{i={}}return i}})(w,"./auth"),w(function(x){var t=w("./user"),o=t.SEA;t.GUN,t.prototype.recall=function(c,h){var y=this,i=y.back(-1);if(c=c||{},c&&c.sessionStorage){if(o.window)try{var u={};u=o.window.sessionStorage,u&&(i._.opt.remember=!0,(y.back("user")._.opt||c).remember=!0,(u.recall||u.pair)&&i.user().auth(JSON.parse(u.pair),h))}catch{}return y}return y}})(w,"./recall"),w(function(x){var t=w("./user"),o=t.SEA,c=t.GUN,h=function(){};t.prototype.pair=function(){var y=this,i;try{i=new Proxy({DANGER:"\u2620"},{get:function(u,s,d){if(!(!y.is||!(y._||"").sea))return y._.sea[s]}})}catch{}return i},t.prototype.delete=async function(y,i,u){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var s=this;s.back(-1);var d=s.back("user");try{d.auth(y,i,function(m){var e=(d.is||{}).pub;d.map().once(function(){this.put(null)}),d.leave(),(u||h)({ok:0})})}catch(m){c.log("User.delete failed! Error:",m)}return s},t.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const y=this.back(-1);try{return await authRecall(y),y._.user._}catch{const i="No session!";throw c.log(i),{err:i}}},t.prototype.trust=async function(y){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),c.is(y)&&y.get("pub").get((i,u)=>{console.log(i,u)}),y.get("trust").get(path).put(theirPubkey)},t.prototype.grant=function(y,i){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,s=u.back(-1).user(),d=s._.sea,m="";return u.back(function(e){e.is||(m+=e.get||"")}),async function(){var e,p=await s.get("grant").get(d.pub).get(m).then();p=await o.decrypt(p,d),p||(p=o.random(16).toString(),e=await o.encrypt(p,d),s.get("grant").get(d.pub).get(m).put(e));var b=y.get("pub").then(),k=y.get("epub").then();b=await b,k=await k;var a=await o.secret(k,d);e=await o.encrypt(p,a),s.get("grant").get(b).get(m).put(e,i)}(),u},t.prototype.secret=function(y,i){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var u=this,s=u.back(-1).user(),d=s.pair(),m="";return u.back(function(e){e.is||(m+=e.get||"")}),async function(){var e,p=await s.get("trust").get(d.pub).get(m).then();p=await o.decrypt(p,d),p||(p=o.random(16).toString(),e=await o.encrypt(p,d),s.get("trust").get(d.pub).get(m).put(e)),e=await o.encrypt(y,p),u.put(e,i)}(),u},x.exports=t})(w,"./share"),w(function(x){var t=w("./sea"),o=w("./settings"),c,h=(t.window||"").GUN||w((""+c==typeof G?".":"")+"./gun",1);h.on("opt",function(e){e.sea||(e.sea={own:{}},e.on("put",y,e)),this.to.next(e)});function y(e){var p=this,b=p.as,k=e.put,a=k["#"],n=k["."],f=k[":"],l=k[">"],S=e["#"],g;if(!(!a||!n)){if((e._||"").faith&&(b.opt||"").faith&&typeof e._=="function"){t.opt.pack(k,function(j){t.verify(j,!1,function(U){k["="]=t.opt.unpack(U),p.to.next(e)})});return}var O=function(j){b.on("in",{"@":S,err:e.err=j})};if((e._||"").DBG&&((e._||"").DBG.c=+new Date),0<=a.indexOf("<?")&&(g=parseFloat(a.split("<?")[1]||""),g&&l<h.state()-g*1e3)){(g=e._)&&g.stun&&g.stun--;return}if(a==="~@"){y.alias(p,e,f,n,a,b,O);return}if(a.slice(0,2)==="~@"){y.pubs(p,e,f,n,a,b,O);return}if(g=t.opt.pub(a)){y.pub(p,e,f,n,a,b,O,b.user||"",g);return}if(0<=a.indexOf("#")){y.hash(p,e,f,n,a,b,O);return}y.any(p,e,f,n,a,b,O,b.user||"")}}y.hash=function(e,p,b,k,a,n,f){t.work(b,null,function(l){function S(g){let O="";for(let j=0;j<g.length;j++)O+=j-1&1?"":String.fromCharCode(parseInt(g.substring(j-1,j+1),16));return btoa(O)}if(l&&l===k.split("#").slice(-1)[0]||l&&l===S(k.split("#").slice(-1)[0]))return e.to.next(p);f("Data hash not same as hash!")},{name:"SHA-256"})},y.alias=function(e,p,b,k,a,n,f){if(!b)return f("Data must exist!");if("~@"+k===u(b))return e.to.next(p);f("Alias not same!")},y.pubs=function(e,p,b,k,a,n,f){if(!b)return f("Alias must exist!");if(k===u(b))return e.to.next(p);f("Alias not same!")},y.pub=async function(e,p,b,k,a,n,f,l,S){var g;const O=await o.parse(b)||{},j=(U,C,B)=>{if(U.m&&U.s&&C&&S)return t.verify(U,S,r=>{if(c!==r&&c!==r.e&&p.put[">"]&&p.put[">"]>parseFloat(r.e))return f("Certificate expired.");if(c!==r&&r.c&&r.w&&(r.c===C||r.c.indexOf("*")>-1)){let _=a.indexOf("/")>-1?a.replace(a.substring(0,a.indexOf("/")+1),""):"";String.match=String.match||h.text.match;const A=Array.isArray(r.w)?r.w:typeof r.w=="object"||typeof r.w=="string"?[r.w]:[];for(const $ of A)if(String.match(_,$["#"])&&String.match(k,$["."])||!$["."]&&String.match(_,$["#"])||!$["#"]&&String.match(k,$["."])||String.match(_?_+"/"+k:k,$["#"]||$)){if($["+"]&&$["+"].indexOf("*")>-1&&_&&_.indexOf(C)==-1&&k.indexOf(C)==-1)return f(`Path "${_}" or key "${k}" must contain string "${C}".`);if(r.wb&&(typeof r.wb=="string"||(r.wb||{})["#"])){var v=e.as.root.$.back(-1);return typeof r.wb=="string"&&r.wb.slice(0,1)!=="~"&&(v=v.get("~"+S)),v.get(r.wb).get(C).once(D=>D&&(D===1||D===!0)?f(`Certificant ${C} blocked.`):B(r))}return B(r)}return f("Certificate verification fail.")}})};if(k==="pub"&&"~"+S===a)return b===S?e.to.next(p):f("Account not same!");if((g=l.is)&&g.pub&&!O["*"]&&!O["+"]&&(S===g.pub||S!==g.pub&&((p._.msg||{}).opt||{}).cert)){t.opt.pack(p.put,U=>{t.sign(U,l._.sea,async function(C){if(c===C)return f(t.err||"Signature fail.");if(p.put[":"]={":":g=t.opt.unpack(C.m),"~":C.s},p.put["="]=g,S===l.is.pub){(g=u(b))&&((n.sea.own[g]=n.sea.own[g]||{})[S]=1),JSON.stringifyAsync(p.put[":"],function(B,r){return B?f(B||"Stringify error."):(p.put[":"]=r,e.to.next(p))});return}if(S!==l.is.pub&&((p._.msg||{}).opt||{}).cert){const B=await o.parse(p._.msg.opt.cert);B&&B.m&&B.s&&j(B,l.is.pub,r=>{p.put[":"]["+"]=B,p.put[":"]["*"]=l.is.pub,JSON.stringifyAsync(p.put[":"],function(v,_){return v?f(v||"Stringify error."):(p.put[":"]=_,e.to.next(p))})})}},{raw:1})});return}t.opt.pack(p.put,U=>{t.verify(U,O["*"]||S,function(C){var B;if(C=t.opt.unpack(C),c===C)return f("Unverified data.");if((B=u(C))&&S===t.opt.pub(B)&&((n.sea.own[B]=n.sea.own[B]||{})[S]=1),O["+"]&&O["+"].m&&O["+"].s&&O["*"])j(O["+"],O["*"],r=>(p.put["="]=C,e.to.next(p)));else return p.put["="]=C,e.to.next(p)})})},y.any=function(e,p,b,k,a,n,f,l){if(n.opt.secure)return f("Soul missing public key at '"+k+"'.");n.on("secure",function(S){if(this.off(),!n.opt.secure)return e.to.next(S);f("Data cannot be changed.")}).on.on("secure",p)};var i=h.valid,u=function(e,p){return typeof(p=i(e))=="string"&&p};(h.state||"").ify;var s=/[^\w_-]/;t.opt.pub=function(e){if(e&&(e=e.split("~"),!(!e||!(e=e[1]))&&(e=e.split(s).slice(0,2),!(!e||e.length!=2)&&(e[0]||"")[0]!=="@")))return e=e.slice(0,2).join("."),e},t.opt.stringy=function(e){},t.opt.pack=function(e,p,b,k,a){var n,f;if(t.opt.check(e))return p(e);e&&e["#"]&&e["."]&&e[">"]&&(n=e[":"],f=1),JSON.parseAsync(f?n:e,function(l,S){var g=c!==(S||"")[":"]&&(S||"")["~"];if(!g){p(e);return}p({m:{"#":a||e["#"],".":b||e["."],":":(S||"")[":"],">":e[">"]||h.state.is(k,b)},s:g})})};var d=t.opt;t.opt.unpack=function(e,p,b){var k;if(c!==e){if(e&&c!==(k=e[":"]))return k;if(p=p||d.fall_key,!b&&d.fall_val&&(b={},b[p]=d.fall_val),!(!p||!b)){if(e===b[p]||!t.opt.check(b[p]))return e;var a=b&&b._&&b._["#"]||d.fall_soul,n=h.state.is(b,p)||d.fall_state;if(e&&e.length===4&&a===e[0]&&p===e[1]&&m(n)===m(e[3]))return e[2];if(n<t.opt.shuffle_attack)return e}}},t.opt.shuffle_attack=15463296e5;var m=Math.floor})(w,"./index")})()}(st),st.exports;var ae=typeof window<"u"?window.Gun:Vt;const qt="#",q="_";ae.chain.unset=function(P){return this&&P&&P[q]&&P[q].put&&P[q].put[q]&&P[q].put[q][qt]&&this.put({[P[q].put[q][qt]]:null}),this},V=ie(["http://localhost:3000/gun"]),V.clear=function(){localStorage.clear(),sessionStorage.clear(),indexedDB.databases().then(P=>{for(let w of P)indexedDB.deleteDatabase(w.name)}),console.log("Local data cleared")},V.lookup=async function(P,w){var o;const G=await V.get(P).get(w).then(),x=((o=G==null?void 0:G._)==null?void 0:o[">"])&&Object.keys(G._[">"])[0];if(!x)return null;const t=await V.get(x).then();return t?{id:w,...t}:null};const{ref:ue,inject:se,provide:ce,computed:ye,onMounted:fe,onUnmounted:le}=await F("vue");ee=function(P){const w=ue([]),G=async t=>{const o=crypto.randomUUID(),c=Object.fromEntries(t.entries());c.id=o,w.value.push(c);const h=V.get(`link-plugin/${o}`).put(c);return V.get("links").get(P).set(h),h},x=async t=>{const o=V.get(`link-plugin/${t}`);o.then(()=>{V.get("links").get(P).unset(o)})};fe(()=>{V.get("links").get(P).map().once(t=>{t&&(w.value.some(o=>o.href===t.href)||w.value.push(t))})}),le(()=>{V.get("links").get(P).map().off()}),ce("link",{links:w,createLink:G,removeLink:x})},ht=function(){const P=se("link");if(!P)throw new Error("Composable must have an link provider.");return P};let Lt,Y,Q,R,Wt,ct,Rt,zt,Yt,Qt,ft;({defineComponent:Lt}=await F("vue")),{createTextVNode:Y,withCtx:Q,createVNode:R,toDisplayString:Wt,openBlock:ct,createBlock:Rt,createCommentVNode:zt,withModifiers:Yt,createElementBlock:Qt}=await F("vue"),{ref:ft}=await F("vue"),te=Lt({__name:"LinkForm",setup(P){const{links:w,createLink:G}=ht(),x=ft(null),t=ft(""),o=async()=>{try{if(t.value.length)return;const c=new FormData(x.value??void 0),h=await G(c)}catch(c){console.error(c),t.value=c.response.data}};return(c,h)=>(ct(),Qt("form",{ref_key:"form",ref:x,onSubmit:Yt(o,["prevent"]),class:"space-y-2"},[R(lt,null,{default:Q(()=>h[0]||(h[0]=[Y(" Add a link ")])),_:1}),t.value?(ct(),Rt(Kt,{key:0,color:"red"},{default:Q(()=>[Y(Wt(t.value),1)]),_:1})):zt("",!0),R(nt,{name:"href",placeholder:"Write your link here ..."}),R(nt,{name:"title",placeholder:"Give it a title (optional)"}),R(pt,{className:"w-full mt-4"},{default:Q(()=>h[1]||(h[1]=[Y(" Submit ")])),_:1})],544))}})});export{lt as _,he as __tla,te as a,pt as b,V as g,ee as l,ht as u};
